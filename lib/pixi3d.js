!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("pixi.js")):"function"==typeof define&&define.amd?define("PIXI3D",["pixi.js"],e):"object"==typeof exports?exports.PIXI3D=e(require("pixi.js")):t.PIXI3D=e(t.PIXI)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=43)}([function(e,n){e.exports=t},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Container3D=void 0;var s=u(n(0)),c=n(29),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transform=new c.Transform3D,e}return o(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationQuaternion",{get:function(){return this.transform.rotationQuaternion},set:function(t){this.transform.rotationQuaternion.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.transform.position.z},set:function(t){this.transform.position.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),e}(s.Container);e.Container3D=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vec3=void 0;var r=n(14),o=function(){function t(){}return t.set=function(t,e,n,o){return void 0===o&&(o=new Float32Array(3)),r.vec3.set(o,t,e,n)},t.fromValues=function(t,e,n){return r.vec3.fromValues(t,e,n)},t.create=function(){return r.vec3.create()},t.add=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.add(n,t,e)},t.transformQuat=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.transformQuat(n,t,e)},t.subtract=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.subtract(n,t,e)},t.scale=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.scale(n,t,e)},t.dot=function(t,e){return r.vec3.dot(t,e)},t.normalize=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.vec3.normalize(e,t)},t.cross=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.cross(n,t,e)},t.transformMat4=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.transformMat4(n,t,e)},t.copy=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.vec3.copy(e,t)},t.magnitude=function(t){return r.vec3.length(t)},t.inverse=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.vec3.inverse(e,t)},t.negate=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.vec3.negate(e,t)},t.multiply=function(t,e,n){return void 0===n&&(n=new Float32Array(3)),r.vec3.multiply(n,t,e)},t.distance=function(t,e){return r.vec3.distance(t,e)},t.squaredDistance=function(t,e){return r.vec3.squaredDistance(t,e)},t}();e.Vec3=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quat=void 0;var r=n(14),o=function(){function t(){}return t.set=function(t,e,n,o,i){return void 0===i&&(i=new Float32Array(4)),r.quat.set(i,t,e,n,o)},t.fromValues=function(t,e,n,o){return r.quat.fromValues(t,e,n,o)},t.create=function(){return r.quat.create()},t.normalize=function(t,e){return void 0===e&&(e=new Float32Array(4)),r.quat.normalize(e,t)},t.slerp=function(t,e,n,o){return void 0===o&&(o=new Float32Array(4)),r.quat.slerp(o,t,e,n)},t.fromEuler=function(t,e,n,o){return void 0===o&&(o=new Float32Array(4)),r.quat.fromEuler(o,t,e,n)},t.conjugate=function(t,e){return void 0===e&&(e=new Float32Array(4)),r.quat.conjugate(e,t)},t.rotateX=function(t,e,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateX(n,t,e)},t.rotateY=function(t,e,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateY(n,t,e)},t.rotateZ=function(t,e,n){return void 0===n&&(n=new Float32Array(4)),r.quat.rotateZ(n,t,e)},t}();e.Quat=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mat4=void 0;var r=n(14),o=function(){function t(){}return t.getTranslation=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.mat4.getTranslation(e,t)},t.create=function(){return r.mat4.create()},t.getScaling=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.mat4.getScaling(e,t)},t.getRotation=function(t,e){return void 0===e&&(e=new Float32Array(4)),r.mat4.getRotation(e,t)},t.copy=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.copy(e,t)},t.fromQuat=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.fromQuat(e,t)},t.fromRotationTranslationScale=function(t,e,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.fromRotationTranslationScale(o,t,e,n)},t.fromRotation=function(t,e,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.fromRotation(n,t,e)},t.fromScaling=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.fromScaling(e,t)},t.fromTranslation=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.fromTranslation(e,t)},t.multiply=function(t,e,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.multiply(n,t,e)},t.lookAt=function(t,e,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.lookAt(o,t,e,n)},t.identity=function(t){return void 0===t&&(t=new Float32Array(16)),r.mat4.identity(t)},t.perspective=function(t,e,n,o,i){return void 0===i&&(i=new Float32Array(16)),r.mat4.perspective(i,t,e,n,o)},t.ortho=function(t,e,n,o,i,a,u){return void 0===u&&(u=new Float32Array(16)),r.mat4.ortho(u,t,e,n,o,i,a)},t.invert=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.invert(e,t)},t.transpose=function(t,e){return void 0===e&&(e=new Float32Array(16)),r.mat4.transpose(e,t)},t.targetTo=function(t,e,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.targetTo(o,t,e,n)},t.rotateX=function(t,e,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateX(n,t,e)},t.rotateY=function(t,e,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateY(n,t,e)},t.rotateZ=function(t,e,n){return void 0===n&&(n=new Float32Array(16)),r.mat4.rotateZ(n,t,e)},t.rotate=function(t,e,n,o){return void 0===o&&(o=new Float32Array(16)),r.mat4.rotate(o,t,e,n)},t}();e.Mat4=o},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var s=u(n(0)),c=n(1),f=n(4),l=n(32),d=n(2),h=n(30),p=n(31),_=n(18),m=new Float32Array(3),v=new Float32Array(16),y=new Float32Array(4),g=function(t){function e(n){var r=t.call(this)||this;return r.renderer=n,r._transformId=0,r._orthographic=!1,r._orthographicSize=10,r._fieldOfView=60,r._near=.1,r._far=1e3,r.renderer.on("prerender",(function(){r._aspect||r._transformId++,r.parent||r.transform.updateTransform()})),e.main||(e.main=r),r.transform.position.z=5,r.transform.rotationQuaternion.setEulerAngles(0,180,0),r}return o(e,t),Object.defineProperty(e.prototype,"transformId",{get:function(){return this.transform._worldID+this._transformId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"orthographicSize",{get:function(){return this._orthographicSize},set:function(t){this._orthographicSize!==t&&(this._orthographicSize=t,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"orthographic",{get:function(){return this._orthographic},set:function(t){this._orthographic!==t&&(this._orthographic=t,this._transformId++)},enumerable:!1,configurable:!0}),e.prototype.screenToRay=function(t,e,n){void 0===n&&(n=this.renderer);var r=this.screenToWorld(t,e,1,void 0,n);if(r)return new l.Ray(this.worldTransform.position,d.Vec3.subtract(r.array,this.worldTransform.position,m))},e.prototype.screenToWorld=function(t,e,n,r,o){var i;void 0===r&&(r=new _.ObservablePoint3D((function(){}),void 0)),void 0===o&&(o=this.renderer),this.transform.updateTransform(null===(i=this.parent)||void 0===i?void 0:i.transform);var a=this.far;this.far=n;var u=f.Mat4.invert(this.viewProjection,v);if(null!==u){var s=h.Vec4.set(t/o.width*2-1,-1*(e/o.height*2-1),1,1,y);this.far=a;var c=h.Vec4.transformMat4(s,u,y);c[3]=1/c[3];for(var l=0;l<3;l++)c[l]*=c[3];return r.set(c[0],c[1],c[2])}},e.prototype.worldToScreen=function(t,e,n,r,o){var i;void 0===r&&(r=new s.Point),void 0===o&&(o=this.renderer),this.transform.updateTransform(null===(i=this.parent)||void 0===i?void 0:i.transform);var a=h.Vec4.set(t,e,n,1,y),u=h.Vec4.transformMat4(h.Vec4.transformMat4(a,this.view,y),this.projection,y);if(0!==u[3])for(var c=0;c<3;c++)u[c]/=u[3];return r.set((u[0]+1)/2*o.width,o.height-(u[1]+1)/2*o.height)},Object.defineProperty(e.prototype,"aspect",{get:function(){return this._aspect},set:function(t){this._aspect!==t&&(this._aspect=t,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldOfView",{get:function(){return this._fieldOfView},set:function(t){this._fieldOfView!==t&&(this._fieldOfView=t,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(t){this._near!==t&&(this._near=t,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(t){this._far!==t&&(this._far=t,this._transformId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){var t=this;return this._projection||(this._projection=new p.MatrixComponent(this,16,(function(e){var n=t._aspect||t.renderer.width/t.renderer.height;t._orthographic?f.Mat4.ortho(-t._orthographicSize*n,t._orthographicSize*n,-t._orthographicSize,t._orthographicSize,t._near,t._far,e):f.Mat4.perspective(t._fieldOfView*s.DEG_TO_RAD,n,t._near,t._far,e)}))),this._projection.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){var t=this;return this._view||(this._view=new p.MatrixComponent(this,16,(function(e){var n=d.Vec3.add(t.worldTransform.position,t.worldTransform.forward,m);f.Mat4.lookAt(t.worldTransform.position,n,t.worldTransform.up,e)}))),this._view.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewProjection",{get:function(){var t=this;return this._viewProjection||(this._viewProjection=new p.MatrixComponent(this,16,(function(e){f.Mat4.multiply(t.projection,t.view,e)}))),this._viewProjection.array},enumerable:!1,configurable:!0}),e}(c.Container3D);e.Camera=g,s.Renderer.registerPlugin("camera",g)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh3D=void 0;var i=n(47),a=n(48),u=n(15),s=n(1),c=n(57),f=n(58),l=n(7),d=function(t){function e(e,n){var r=t.call(this)||this;if(r.geometry=e,r.material=n,r.pluginName="pipeline",r.enabledRenderPasses=["material"],r._instances=[],!e)throw new Error("PIXI3D: Geometry is required when creating a mesh.");return r}return o(e,t),e.isInstancingSupported=function(t){return l.Platform.isInstancingSupported(t)},Object.defineProperty(e.prototype,"instances",{get:function(){return this._instances},enumerable:!1,configurable:!0}),e.prototype.createInstance=function(){var t;if(this.material&&!this.material.isInstancingSupported)throw new Error("PIXI3D: Can't create instance of mesh, material does not supported instancing.");return this._instances[this._instances.push(new f.InstancedMesh3D(this,null===(t=this.material)||void 0===t?void 0:t.createInstance()))-1]},e.prototype.removeInstance=function(t){var e=this._instances.indexOf(t);e>=0&&this._instances.splice(e,1)},e.prototype.enableRenderPass=function(t){this.enabledRenderPasses.indexOf(t)<0&&this.enabledRenderPasses.push(t)},e.prototype.disableRenderPass=function(t){var e=this.enabledRenderPasses.indexOf(t);e>=0&&this.enabledRenderPasses.splice(e,1)},e.prototype.isRenderPassEnabled=function(t){return this.enabledRenderPasses.indexOf(t)>=0},e.prototype.destroy=function(){this.geometry.destroy(),this.material&&this.material.destroy(),t.prototype.destroy.call(this)},e.prototype._render=function(t){t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.createQuad=function(t){return void 0===t&&(t=new u.StandardMaterial),new e(c.QuadGeometry.create(),t)},e.createCube=function(t){return void 0===t&&(t=new u.StandardMaterial),new e(a.CubeGeometry.create(),t)},e.createPlane=function(t){return void 0===t&&(t=new u.StandardMaterial),new e(i.PlaneGeometry.create(),t)},e}(s.Container3D);e.Mesh3D=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Platform=void 0,function(t){var e,n,r,o,i,a;t.getMaxVertexUniformVectors=function(t){if(void 0!==e)return e;var n=t.gl;return e=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS)},t.isFloatTextureSupported=function(t){if(2===t.context.webGLVersion)return!0;if(void 0!==n)return n;var e=t.gl;if(e.getExtension("OES_texture_float"))return!0;var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,8,8,0,e.RGBA,e.FLOAT,null),n=e.getError()===e.NO_ERROR,e.deleteTexture(r),n},t.isHalfFloatFramebufferSupported=function(t){if(2===t.context.webGLVersion)return!0;if(void 0!==r)return r;var e=t.gl,n=e.getExtension("OES_texture_half_float");if(!n)return!1;var o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,8,8,0,e.RGBA,n.HALF_FLOAT_OES,null);var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i);var a=e.COLOR_ATTACHMENT0;return e.framebufferTexture2D(e.FRAMEBUFFER,a,e.TEXTURE_2D,o,0),r=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE},t.isFloatFramebufferSupported=function(t){if(2===t.context.webGLVersion)return!0;if(void 0!==o)return o;var e=t.gl;if(!e.getExtension("OES_texture_float"))return!1;var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,8,8,0,e.RGBA,e.FLOAT,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r);var i=e.COLOR_ATTACHMENT0;return e.framebufferTexture2D(e.FRAMEBUFFER,i,e.TEXTURE_2D,n,0),o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE},t.supportsFloatLinear=function(t){if(void 0!==i)return i;var e=t.gl;return i=null!==e.getExtension("OES_texture_float_linear")},t.isShaderTextureLodSupported=function(t){return 2===t.context.webGLVersion||null!==t.gl.getExtension("EXT_shader_texture_lod")},t.isInstancingSupported=function(t){if(void 0!==a)return a;var e=t.gl;return a=void 0!==e.getExtension("ANGLE_instanced_arrays")}}(e.Platform||(e.Platform={}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.MeshShader=void 0;var s=u(n(0)),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._state=Object.assign(new s.State,{culling:!0,clockwiseFrontFace:!1,depthTest:!0}),e}return o(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"mesh-shader"},enumerable:!1,configurable:!0}),e.prototype.createShaderGeometry=function(t,e){var n=new s.Geometry;return t.indices&&(1===t.indices.buffer.BYTES_PER_ELEMENT?n.addIndex(new s.Buffer(new Uint16Array(t.indices.buffer))):n.addIndex(new s.Buffer(t.indices.buffer))),t.positions&&n.addAttribute("a_Position",new s.Buffer(t.positions.buffer),3,!1,t.positions.componentType,t.positions.stride),t.uvs&&t.uvs[0]&&n.addAttribute("a_UV1",new s.Buffer(t.uvs[0].buffer),2,!1,t.uvs[0].componentType,t.uvs[0].stride),t.normals&&n.addAttribute("a_Normal",new s.Buffer(t.normals.buffer),3,!1,t.normals.componentType,t.normals.stride),t.tangents&&n.addAttribute("a_Tangent",new s.Buffer(t.tangents.buffer),4,!1,t.tangents.componentType,t.tangents.stride),n},e.prototype.render=function(t,e,n,r){void 0===n&&(n=this._state),void 0===r&&(r=s.DRAW_MODES.TRIANGLES);var o=t.instances.filter((function(t){return t.worldVisible&&t.renderable})).length,i=t.instances.length>0;t.geometry.hasShaderGeometry(this,i)||t.geometry.addShaderGeometry(this,i);var a=t.geometry.getShaderGeometry(this);e.shader.bind(this,!1),e.state.set(n),e.geometry.bind(a,this),e.geometry.draw(r,void 0,void 0,o)},e}(s.Shader);e.MeshShader=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeshGeometry3D=void 0;var r=function(){function t(){this._shaderGeometry={}}return t.prototype.getShaderGeometry=function(t){return this._shaderGeometry[t.name]},t.prototype.addShaderGeometry=function(t,e){this._shaderGeometry[t.name]=t.createShaderGeometry(this,e)},t.prototype.hasShaderGeometry=function(t,e){return!!this._shaderGeometry[t.name]&&(!e||e&&this._shaderGeometry[t.name].instanced)},t.prototype.destroy=function(){for(var t in this._shaderGeometry)this._shaderGeometry[t].destroy();this._shaderGeometry={}},t}();e.MeshGeometry3D=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LightType=void 0,function(t){t.spot="spot",t.directional="directional",t.point="point",t.ambient="ambient"}(e.LightType||(e.LightType={}))},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0;var i=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=1),this._array4=new Float32Array([t,e,n,r]),this._array3=this._array4.subarray(0,3)}return t.fromBytes=function(e,n,r,o){return void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=255),new t(e/255,n/255,r/255,o/255)},Object.defineProperty(t.prototype,"rgb",{get:function(){return this._array3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return this._array4},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"r",{get:function(){return this._array4[0]},set:function(t){this._array4[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this._array4[1]},set:function(t){this._array4[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._array4[2]},set:function(t){this._array4[2]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this._array4[3]},set:function(t){this._array4[3]=t},enumerable:!1,configurable:!0}),t.from=function(e){return new(t.bind.apply(t,o([void 0],r(e))))},t}();e.Color=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.glTFChannel=void 0;var r=function(){function t(t,e){this._position=0,this._frame=0,this._input=t,this._interpolation=e}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this.setPosition(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._input[this._input.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._input.length},enumerable:!1,configurable:!0}),t.prototype.setPosition=function(t){this._position=t,this._frame=this.calculateFrame(this._position),this.updateTarget(this._interpolation.interpolate(this._frame,this.calculateFramePosition(this._frame,this._position)))},t.prototype.update=function(t){this.position+=t},t.prototype.calculateFramePosition=function(t,e){return t===this._input.length-1?1:(e-this._input[t])/(this._input[t+1]-this._input[t])},t.prototype.calculateFrame=function(t){if(t<this._input[0])return 0;for(var e=0;e<this._input.length-1;e++)if(t>=this._input[e]&&t<this._input[e+1])return e;return this._input.length-1},t.from=function(t,e,n,r,f){if("translation"===r)return new c.glTFTranslation(f.transform,t,o.glTFInterpolation.from(n,t,e,3));if("scale"===r)return new a.glTFScale(f.transform,t,o.glTFInterpolation.from(n,t,e,3));if("rotation"===r)return"LINEAR"===n?new s.glTFRotation(f.transform,t,new i.glTFSphericalLinear(e)):new s.glTFRotation(f.transform,t,o.glTFInterpolation.from(n,t,e,4));if("weights"===r){var l=f.children[0].morphWeights;if(!l)return;return new u.glTFWeights(l,t,o.glTFInterpolation.from(n,t,e,l.length))}throw new Error('PIXI3D: Unknown channel path "'+r+'"')},t}();e.glTFChannel=r;var o=n(13),i=n(63),a=n(64),u=n(65),s=n(66),c=n(67)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.glTFInterpolation=void 0;var r=function(){function t(){}return t.from=function(t,e,n,r){switch(t){case"LINEAR":return new o.glTFLinear(n,r);case"CUBICSPLINE":return new i.glTFCubicSpline(e,n,r);case"STEP":return new a.glTFStep(n,r)}throw new Error('PIXI3D: Unknown interpolation type "'+t+'"')},t}();e.glTFInterpolation=r;var o=n(60),i=n(61),a=n(62)},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"EPSILON",(function(){return h})),n.d(r,"ARRAY_TYPE",(function(){return p})),n.d(r,"RANDOM",(function(){return _})),n.d(r,"setMatrixArrayType",(function(){return m})),n.d(r,"toRadian",(function(){return y})),n.d(r,"equals",(function(){return g}));var o={};n.r(o),n.d(o,"create",(function(){return b})),n.d(o,"clone",(function(){return M})),n.d(o,"copy",(function(){return T})),n.d(o,"identity",(function(){return S})),n.d(o,"fromValues",(function(){return O})),n.d(o,"set",(function(){return A})),n.d(o,"transpose",(function(){return x})),n.d(o,"invert",(function(){return w})),n.d(o,"adjoint",(function(){return P})),n.d(o,"determinant",(function(){return E})),n.d(o,"multiply",(function(){return j})),n.d(o,"rotate",(function(){return R})),n.d(o,"scale",(function(){return I})),n.d(o,"fromRotation",(function(){return C})),n.d(o,"fromScaling",(function(){return N})),n.d(o,"str",(function(){return L})),n.d(o,"frob",(function(){return F})),n.d(o,"LDU",(function(){return U})),n.d(o,"add",(function(){return B})),n.d(o,"subtract",(function(){return V})),n.d(o,"exactEquals",(function(){return G})),n.d(o,"equals",(function(){return D})),n.d(o,"multiplyScalar",(function(){return H})),n.d(o,"multiplyScalarAndAdd",(function(){return k})),n.d(o,"mul",(function(){return z})),n.d(o,"sub",(function(){return W}));var i={};n.r(i),n.d(i,"create",(function(){return X})),n.d(i,"clone",(function(){return q})),n.d(i,"copy",(function(){return Q})),n.d(i,"identity",(function(){return J})),n.d(i,"fromValues",(function(){return K})),n.d(i,"set",(function(){return Y})),n.d(i,"invert",(function(){return Z})),n.d(i,"determinant",(function(){return $})),n.d(i,"multiply",(function(){return tt})),n.d(i,"rotate",(function(){return et})),n.d(i,"scale",(function(){return nt})),n.d(i,"translate",(function(){return rt})),n.d(i,"fromRotation",(function(){return ot})),n.d(i,"fromScaling",(function(){return it})),n.d(i,"fromTranslation",(function(){return at})),n.d(i,"str",(function(){return ut})),n.d(i,"frob",(function(){return st})),n.d(i,"add",(function(){return ct})),n.d(i,"subtract",(function(){return ft})),n.d(i,"multiplyScalar",(function(){return lt})),n.d(i,"multiplyScalarAndAdd",(function(){return dt})),n.d(i,"exactEquals",(function(){return ht})),n.d(i,"equals",(function(){return pt})),n.d(i,"mul",(function(){return _t})),n.d(i,"sub",(function(){return mt}));var a={};n.r(a),n.d(a,"create",(function(){return vt})),n.d(a,"fromMat4",(function(){return yt})),n.d(a,"clone",(function(){return gt})),n.d(a,"copy",(function(){return bt})),n.d(a,"fromValues",(function(){return Mt})),n.d(a,"set",(function(){return Tt})),n.d(a,"identity",(function(){return St})),n.d(a,"transpose",(function(){return Ot})),n.d(a,"invert",(function(){return At})),n.d(a,"adjoint",(function(){return xt})),n.d(a,"determinant",(function(){return wt})),n.d(a,"multiply",(function(){return Pt})),n.d(a,"translate",(function(){return Et})),n.d(a,"rotate",(function(){return jt})),n.d(a,"scale",(function(){return Rt})),n.d(a,"fromTranslation",(function(){return It})),n.d(a,"fromRotation",(function(){return Ct})),n.d(a,"fromScaling",(function(){return Nt})),n.d(a,"fromMat2d",(function(){return Lt})),n.d(a,"fromQuat",(function(){return Ft})),n.d(a,"normalFromMat4",(function(){return Ut})),n.d(a,"projection",(function(){return Bt})),n.d(a,"str",(function(){return Vt})),n.d(a,"frob",(function(){return Gt})),n.d(a,"add",(function(){return Dt})),n.d(a,"subtract",(function(){return Ht})),n.d(a,"multiplyScalar",(function(){return kt})),n.d(a,"multiplyScalarAndAdd",(function(){return zt})),n.d(a,"exactEquals",(function(){return Wt})),n.d(a,"equals",(function(){return Xt})),n.d(a,"mul",(function(){return qt})),n.d(a,"sub",(function(){return Qt}));var u={};n.r(u),n.d(u,"create",(function(){return Jt})),n.d(u,"clone",(function(){return Kt})),n.d(u,"copy",(function(){return Yt})),n.d(u,"fromValues",(function(){return Zt})),n.d(u,"set",(function(){return $t})),n.d(u,"identity",(function(){return te})),n.d(u,"transpose",(function(){return ee})),n.d(u,"invert",(function(){return ne})),n.d(u,"adjoint",(function(){return re})),n.d(u,"determinant",(function(){return oe})),n.d(u,"multiply",(function(){return ie})),n.d(u,"translate",(function(){return ae})),n.d(u,"scale",(function(){return ue})),n.d(u,"rotate",(function(){return se})),n.d(u,"rotateX",(function(){return ce})),n.d(u,"rotateY",(function(){return fe})),n.d(u,"rotateZ",(function(){return le})),n.d(u,"fromTranslation",(function(){return de})),n.d(u,"fromScaling",(function(){return he})),n.d(u,"fromRotation",(function(){return pe})),n.d(u,"fromXRotation",(function(){return _e})),n.d(u,"fromYRotation",(function(){return me})),n.d(u,"fromZRotation",(function(){return ve})),n.d(u,"fromRotationTranslation",(function(){return ye})),n.d(u,"fromQuat2",(function(){return ge})),n.d(u,"getTranslation",(function(){return be})),n.d(u,"getScaling",(function(){return Me})),n.d(u,"getRotation",(function(){return Te})),n.d(u,"fromRotationTranslationScale",(function(){return Se})),n.d(u,"fromRotationTranslationScaleOrigin",(function(){return Oe})),n.d(u,"fromQuat",(function(){return Ae})),n.d(u,"frustum",(function(){return xe})),n.d(u,"perspective",(function(){return we})),n.d(u,"perspectiveFromFieldOfView",(function(){return Pe})),n.d(u,"ortho",(function(){return Ee})),n.d(u,"lookAt",(function(){return je})),n.d(u,"targetTo",(function(){return Re})),n.d(u,"str",(function(){return Ie})),n.d(u,"frob",(function(){return Ce})),n.d(u,"add",(function(){return Ne})),n.d(u,"subtract",(function(){return Le})),n.d(u,"multiplyScalar",(function(){return Fe})),n.d(u,"multiplyScalarAndAdd",(function(){return Ue})),n.d(u,"exactEquals",(function(){return Be})),n.d(u,"equals",(function(){return Ve})),n.d(u,"mul",(function(){return Ge})),n.d(u,"sub",(function(){return De}));var s={};n.r(s),n.d(s,"create",(function(){return He})),n.d(s,"clone",(function(){return ke})),n.d(s,"length",(function(){return ze})),n.d(s,"fromValues",(function(){return We})),n.d(s,"copy",(function(){return Xe})),n.d(s,"set",(function(){return qe})),n.d(s,"add",(function(){return Qe})),n.d(s,"subtract",(function(){return Je})),n.d(s,"multiply",(function(){return Ke})),n.d(s,"divide",(function(){return Ye})),n.d(s,"ceil",(function(){return Ze})),n.d(s,"floor",(function(){return $e})),n.d(s,"min",(function(){return tn})),n.d(s,"max",(function(){return en})),n.d(s,"round",(function(){return nn})),n.d(s,"scale",(function(){return rn})),n.d(s,"scaleAndAdd",(function(){return on})),n.d(s,"distance",(function(){return an})),n.d(s,"squaredDistance",(function(){return un})),n.d(s,"squaredLength",(function(){return sn})),n.d(s,"negate",(function(){return cn})),n.d(s,"inverse",(function(){return fn})),n.d(s,"normalize",(function(){return ln})),n.d(s,"dot",(function(){return dn})),n.d(s,"cross",(function(){return hn})),n.d(s,"lerp",(function(){return pn})),n.d(s,"hermite",(function(){return _n})),n.d(s,"bezier",(function(){return mn})),n.d(s,"random",(function(){return vn})),n.d(s,"transformMat4",(function(){return yn})),n.d(s,"transformMat3",(function(){return gn})),n.d(s,"transformQuat",(function(){return bn})),n.d(s,"rotateX",(function(){return Mn})),n.d(s,"rotateY",(function(){return Tn})),n.d(s,"rotateZ",(function(){return Sn})),n.d(s,"angle",(function(){return On})),n.d(s,"zero",(function(){return An})),n.d(s,"str",(function(){return xn})),n.d(s,"exactEquals",(function(){return wn})),n.d(s,"equals",(function(){return Pn})),n.d(s,"sub",(function(){return jn})),n.d(s,"mul",(function(){return Rn})),n.d(s,"div",(function(){return In})),n.d(s,"dist",(function(){return Cn})),n.d(s,"sqrDist",(function(){return Nn})),n.d(s,"len",(function(){return Ln})),n.d(s,"sqrLen",(function(){return Fn})),n.d(s,"forEach",(function(){return Un}));var c={};n.r(c),n.d(c,"create",(function(){return Bn})),n.d(c,"clone",(function(){return Vn})),n.d(c,"fromValues",(function(){return Gn})),n.d(c,"copy",(function(){return Dn})),n.d(c,"set",(function(){return Hn})),n.d(c,"add",(function(){return kn})),n.d(c,"subtract",(function(){return zn})),n.d(c,"multiply",(function(){return Wn})),n.d(c,"divide",(function(){return Xn})),n.d(c,"ceil",(function(){return qn})),n.d(c,"floor",(function(){return Qn})),n.d(c,"min",(function(){return Jn})),n.d(c,"max",(function(){return Kn})),n.d(c,"round",(function(){return Yn})),n.d(c,"scale",(function(){return Zn})),n.d(c,"scaleAndAdd",(function(){return $n})),n.d(c,"distance",(function(){return tr})),n.d(c,"squaredDistance",(function(){return er})),n.d(c,"length",(function(){return nr})),n.d(c,"squaredLength",(function(){return rr})),n.d(c,"negate",(function(){return or})),n.d(c,"inverse",(function(){return ir})),n.d(c,"normalize",(function(){return ar})),n.d(c,"dot",(function(){return ur})),n.d(c,"cross",(function(){return sr})),n.d(c,"lerp",(function(){return cr})),n.d(c,"random",(function(){return fr})),n.d(c,"transformMat4",(function(){return lr})),n.d(c,"transformQuat",(function(){return dr})),n.d(c,"zero",(function(){return hr})),n.d(c,"str",(function(){return pr})),n.d(c,"exactEquals",(function(){return _r})),n.d(c,"equals",(function(){return mr})),n.d(c,"sub",(function(){return vr})),n.d(c,"mul",(function(){return yr})),n.d(c,"div",(function(){return gr})),n.d(c,"dist",(function(){return br})),n.d(c,"sqrDist",(function(){return Mr})),n.d(c,"len",(function(){return Tr})),n.d(c,"sqrLen",(function(){return Sr})),n.d(c,"forEach",(function(){return Or}));var f={};n.r(f),n.d(f,"create",(function(){return Ar})),n.d(f,"identity",(function(){return xr})),n.d(f,"setAxisAngle",(function(){return wr})),n.d(f,"getAxisAngle",(function(){return Pr})),n.d(f,"getAngle",(function(){return Er})),n.d(f,"multiply",(function(){return jr})),n.d(f,"rotateX",(function(){return Rr})),n.d(f,"rotateY",(function(){return Ir})),n.d(f,"rotateZ",(function(){return Cr})),n.d(f,"calculateW",(function(){return Nr})),n.d(f,"exp",(function(){return Lr})),n.d(f,"ln",(function(){return Fr})),n.d(f,"pow",(function(){return Ur})),n.d(f,"slerp",(function(){return Br})),n.d(f,"random",(function(){return Vr})),n.d(f,"invert",(function(){return Gr})),n.d(f,"conjugate",(function(){return Dr})),n.d(f,"fromMat3",(function(){return Hr})),n.d(f,"fromEuler",(function(){return kr})),n.d(f,"str",(function(){return zr})),n.d(f,"clone",(function(){return Yr})),n.d(f,"fromValues",(function(){return Zr})),n.d(f,"copy",(function(){return $r})),n.d(f,"set",(function(){return to})),n.d(f,"add",(function(){return eo})),n.d(f,"mul",(function(){return no})),n.d(f,"scale",(function(){return ro})),n.d(f,"dot",(function(){return oo})),n.d(f,"lerp",(function(){return io})),n.d(f,"length",(function(){return ao})),n.d(f,"len",(function(){return uo})),n.d(f,"squaredLength",(function(){return so})),n.d(f,"sqrLen",(function(){return co})),n.d(f,"normalize",(function(){return fo})),n.d(f,"exactEquals",(function(){return lo})),n.d(f,"equals",(function(){return ho})),n.d(f,"rotationTo",(function(){return po})),n.d(f,"sqlerp",(function(){return _o})),n.d(f,"setAxes",(function(){return mo}));var l={};n.r(l),n.d(l,"create",(function(){return vo})),n.d(l,"clone",(function(){return yo})),n.d(l,"fromValues",(function(){return go})),n.d(l,"fromRotationTranslationValues",(function(){return bo})),n.d(l,"fromRotationTranslation",(function(){return Mo})),n.d(l,"fromTranslation",(function(){return To})),n.d(l,"fromRotation",(function(){return So})),n.d(l,"fromMat4",(function(){return Oo})),n.d(l,"copy",(function(){return Ao})),n.d(l,"identity",(function(){return xo})),n.d(l,"set",(function(){return wo})),n.d(l,"getReal",(function(){return Po})),n.d(l,"getDual",(function(){return Eo})),n.d(l,"setReal",(function(){return jo})),n.d(l,"setDual",(function(){return Ro})),n.d(l,"getTranslation",(function(){return Io})),n.d(l,"translate",(function(){return Co})),n.d(l,"rotateX",(function(){return No})),n.d(l,"rotateY",(function(){return Lo})),n.d(l,"rotateZ",(function(){return Fo})),n.d(l,"rotateByQuatAppend",(function(){return Uo})),n.d(l,"rotateByQuatPrepend",(function(){return Bo})),n.d(l,"rotateAroundAxis",(function(){return Vo})),n.d(l,"add",(function(){return Go})),n.d(l,"multiply",(function(){return Do})),n.d(l,"mul",(function(){return Ho})),n.d(l,"scale",(function(){return ko})),n.d(l,"dot",(function(){return zo})),n.d(l,"lerp",(function(){return Wo})),n.d(l,"invert",(function(){return Xo})),n.d(l,"conjugate",(function(){return qo})),n.d(l,"length",(function(){return Qo})),n.d(l,"len",(function(){return Jo})),n.d(l,"squaredLength",(function(){return Ko})),n.d(l,"sqrLen",(function(){return Yo})),n.d(l,"normalize",(function(){return Zo})),n.d(l,"str",(function(){return $o})),n.d(l,"exactEquals",(function(){return ti})),n.d(l,"equals",(function(){return ei}));var d={};n.r(d),n.d(d,"create",(function(){return ni})),n.d(d,"clone",(function(){return ri})),n.d(d,"fromValues",(function(){return oi})),n.d(d,"copy",(function(){return ii})),n.d(d,"set",(function(){return ai})),n.d(d,"add",(function(){return ui})),n.d(d,"subtract",(function(){return si})),n.d(d,"multiply",(function(){return ci})),n.d(d,"divide",(function(){return fi})),n.d(d,"ceil",(function(){return li})),n.d(d,"floor",(function(){return di})),n.d(d,"min",(function(){return hi})),n.d(d,"max",(function(){return pi})),n.d(d,"round",(function(){return _i})),n.d(d,"scale",(function(){return mi})),n.d(d,"scaleAndAdd",(function(){return vi})),n.d(d,"distance",(function(){return yi})),n.d(d,"squaredDistance",(function(){return gi})),n.d(d,"length",(function(){return bi})),n.d(d,"squaredLength",(function(){return Mi})),n.d(d,"negate",(function(){return Ti})),n.d(d,"inverse",(function(){return Si})),n.d(d,"normalize",(function(){return Oi})),n.d(d,"dot",(function(){return Ai})),n.d(d,"cross",(function(){return xi})),n.d(d,"lerp",(function(){return wi})),n.d(d,"random",(function(){return Pi})),n.d(d,"transformMat2",(function(){return Ei})),n.d(d,"transformMat2d",(function(){return ji})),n.d(d,"transformMat3",(function(){return Ri})),n.d(d,"transformMat4",(function(){return Ii})),n.d(d,"rotate",(function(){return Ci})),n.d(d,"angle",(function(){return Ni})),n.d(d,"zero",(function(){return Li})),n.d(d,"str",(function(){return Fi})),n.d(d,"exactEquals",(function(){return Ui})),n.d(d,"equals",(function(){return Bi})),n.d(d,"len",(function(){return Vi})),n.d(d,"sub",(function(){return Gi})),n.d(d,"mul",(function(){return Di})),n.d(d,"div",(function(){return Hi})),n.d(d,"dist",(function(){return ki})),n.d(d,"sqrDist",(function(){return zi})),n.d(d,"sqrLen",(function(){return Wi})),n.d(d,"forEach",(function(){return Xi}));var h=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array,_=Math.random;function m(t){p=t}var v=Math.PI/180;function y(t){return t*v}function g(t,e){return Math.abs(t-e)<=h*Math.max(1,Math.abs(t),Math.abs(e))}function b(){var t=new p(4);return p!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function M(t){var e=new p(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function T(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function S(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function O(t,e,n,r){var o=new p(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o}function A(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t}function x(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function w(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*i-o*r;return a?(a=1/a,t[0]=i*a,t[1]=-r*a,t[2]=-o*a,t[3]=n*a,t):null}function P(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function E(t){return t[0]*t[3]-t[2]*t[1]}function j(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=r*u+i*s,t[1]=o*u+a*s,t[2]=r*c+i*f,t[3]=o*c+a*f,t}function R(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+i*u,t[1]=o*s+a*u,t[2]=r*-u+i*s,t[3]=o*-u+a*s,t}function I(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1];return t[0]=r*u,t[1]=o*u,t[2]=i*s,t[3]=a*s,t}function C(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function N(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function L(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function F(t){return Math.hypot(t[0],t[1],t[2],t[3])}function U(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function B(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function V(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function G(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function D(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-s)<=h*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=h*Math.max(1,Math.abs(i),Math.abs(c))}function H(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function k(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var z=j,W=V;function X(){var t=new p(6);return p!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function q(t){var e=new p(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Q(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function J(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function K(t,e,n,r,o,i){var a=new p(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=o,a[5]=i,a}function Y(t,e,n,r,o,i,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t}function Z(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=n*i-r*o;return s?(s=1/s,t[0]=i*s,t[1]=-r*s,t[2]=-o*s,t[3]=n*s,t[4]=(o*u-i*a)*s,t[5]=(r*a-n*u)*s,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=n[0],f=n[1],l=n[2],d=n[3],h=n[4],p=n[5];return t[0]=r*c+i*f,t[1]=o*c+a*f,t[2]=r*l+i*d,t[3]=o*l+a*d,t[4]=r*h+i*p+u,t[5]=o*h+a*p+s,t}function et(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=Math.sin(n),f=Math.cos(n);return t[0]=r*f+i*c,t[1]=o*f+a*c,t[2]=r*-c+i*f,t[3]=o*-c+a*f,t[4]=u,t[5]=s,t}function nt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=n[0],f=n[1];return t[0]=r*c,t[1]=o*c,t[2]=i*f,t[3]=a*f,t[4]=u,t[5]=s,t}function rt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=n[0],f=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=r*c+i*f+u,t[5]=o*c+a*f+s,t}function ot(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function it(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ut(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function st(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function ft(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function lt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function dt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function ht(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function pt(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=e[0],c=e[1],f=e[2],l=e[3],d=e[4],p=e[5];return Math.abs(n-s)<=h*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=h*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=h*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-l)<=h*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-d)<=h*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-p)<=h*Math.max(1,Math.abs(u),Math.abs(p))}var _t=tt,mt=ft;function vt(){var t=new p(9);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function gt(t){var e=new p(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Mt(t,e,n,r,o,i,a,u,s){var c=new p(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=a,c[7]=u,c[8]=s,c}function Tt(t,e,n,r,o,i,a,u,s,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t}function St(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ot(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function At(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=f*a-u*c,d=-f*i+u*s,h=c*i-a*s,p=n*l+r*d+o*h;return p?(p=1/p,t[0]=l*p,t[1]=(-f*r+o*c)*p,t[2]=(u*r-o*a)*p,t[3]=d*p,t[4]=(f*n-o*s)*p,t[5]=(-u*n+o*i)*p,t[6]=h*p,t[7]=(-c*n+r*s)*p,t[8]=(a*n-r*i)*p,t):null}function xt(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8];return t[0]=a*f-u*c,t[1]=o*c-r*f,t[2]=r*u-o*a,t[3]=u*s-i*f,t[4]=n*f-o*s,t[5]=o*i-n*u,t[6]=i*c-a*s,t[7]=r*s-n*c,t[8]=n*a-r*i,t}function wt(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return e*(c*i-a*s)+n*(-c*o+a*u)+r*(s*o-i*u)}function Pt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],d=n[0],h=n[1],p=n[2],_=n[3],m=n[4],v=n[5],y=n[6],g=n[7],b=n[8];return t[0]=d*r+h*a+p*c,t[1]=d*o+h*u+p*f,t[2]=d*i+h*s+p*l,t[3]=_*r+m*a+v*c,t[4]=_*o+m*u+v*f,t[5]=_*i+m*s+v*l,t[6]=y*r+g*a+b*c,t[7]=y*o+g*u+b*f,t[8]=y*i+g*s+b*l,t}function Et(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],d=n[0],h=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=u,t[5]=s,t[6]=d*r+h*a+c,t[7]=d*o+h*u+f,t[8]=d*i+h*s+l,t}function jt(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],d=Math.sin(n),h=Math.cos(n);return t[0]=h*r+d*a,t[1]=h*o+d*u,t[2]=h*i+d*s,t[3]=h*a-d*r,t[4]=h*u-d*o,t[5]=h*s-d*i,t[6]=c,t[7]=f,t[8]=l,t}function Rt(t,e,n){var r=n[0],o=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function It(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ct(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Nt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ft(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,l=r*u,d=o*a,h=o*u,p=o*s,_=i*a,m=i*u,v=i*s;return t[0]=1-l-p,t[3]=f-v,t[6]=d+m,t[1]=f+v,t[4]=1-c-p,t[7]=h-_,t[2]=d-m,t[5]=h+_,t[8]=1-c-l,t}function Ut(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],d=e[10],h=e[11],p=e[12],_=e[13],m=e[14],v=e[15],y=n*u-r*a,g=n*s-o*a,b=n*c-i*a,M=r*s-o*u,T=r*c-i*u,S=o*c-i*s,O=f*_-l*p,A=f*m-d*p,x=f*v-h*p,w=l*m-d*_,P=l*v-h*_,E=d*v-h*m,j=y*E-g*P+b*w+M*x-T*A+S*O;return j?(j=1/j,t[0]=(u*E-s*P+c*w)*j,t[1]=(s*x-a*E-c*A)*j,t[2]=(a*P-u*x+c*O)*j,t[3]=(o*P-r*E-i*w)*j,t[4]=(n*E-o*x+i*A)*j,t[5]=(r*x-n*P-i*O)*j,t[6]=(_*S-m*T+v*M)*j,t[7]=(m*b-p*S-v*g)*j,t[8]=(p*T-_*b+v*y)*j,t):null}function Bt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Vt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Gt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Dt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function kt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function zt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Xt(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=e[0],d=e[1],p=e[2],_=e[3],m=e[4],v=e[5],y=e[6],g=e[7],b=e[8];return Math.abs(n-l)<=h*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-d)<=h*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=h*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(i-_)<=h*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-m)<=h*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(u-v)<=h*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(s-y)<=h*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(c-g)<=h*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-b)<=h*Math.max(1,Math.abs(f),Math.abs(b))}var qt=Pt,Qt=Ht;function Jt(){var t=new p(16);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Kt(t){var e=new p(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Yt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Zt(t,e,n,r,o,i,a,u,s,c,f,l,d,h,_,m){var v=new p(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=o,v[5]=i,v[6]=a,v[7]=u,v[8]=s,v[9]=c,v[10]=f,v[11]=l,v[12]=d,v[13]=h,v[14]=_,v[15]=m,v}function $t(t,e,n,r,o,i,a,u,s,c,f,l,d,h,p,_,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=d,t[12]=h,t[13]=p,t[14]=_,t[15]=m,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],i=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],d=e[10],h=e[11],p=e[12],_=e[13],m=e[14],v=e[15],y=n*u-r*a,g=n*s-o*a,b=n*c-i*a,M=r*s-o*u,T=r*c-i*u,S=o*c-i*s,O=f*_-l*p,A=f*m-d*p,x=f*v-h*p,w=l*m-d*_,P=l*v-h*_,E=d*v-h*m,j=y*E-g*P+b*w+M*x-T*A+S*O;return j?(j=1/j,t[0]=(u*E-s*P+c*w)*j,t[1]=(o*P-r*E-i*w)*j,t[2]=(_*S-m*T+v*M)*j,t[3]=(d*T-l*S-h*M)*j,t[4]=(s*x-a*E-c*A)*j,t[5]=(n*E-o*x+i*A)*j,t[6]=(m*b-p*S-v*g)*j,t[7]=(f*S-d*b+h*g)*j,t[8]=(a*P-u*x+c*O)*j,t[9]=(r*x-n*P-i*O)*j,t[10]=(p*T-_*b+v*y)*j,t[11]=(l*b-f*T-h*y)*j,t[12]=(u*A-a*w-s*O)*j,t[13]=(n*w-r*A+o*O)*j,t[14]=(_*g-p*M-m*y)*j,t[15]=(f*M-l*g+d*y)*j,t):null}function re(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],d=e[10],h=e[11],p=e[12],_=e[13],m=e[14],v=e[15];return t[0]=u*(d*v-h*m)-l*(s*v-c*m)+_*(s*h-c*d),t[1]=-(r*(d*v-h*m)-l*(o*v-i*m)+_*(o*h-i*d)),t[2]=r*(s*v-c*m)-u*(o*v-i*m)+_*(o*c-i*s),t[3]=-(r*(s*h-c*d)-u*(o*h-i*d)+l*(o*c-i*s)),t[4]=-(a*(d*v-h*m)-f*(s*v-c*m)+p*(s*h-c*d)),t[5]=n*(d*v-h*m)-f*(o*v-i*m)+p*(o*h-i*d),t[6]=-(n*(s*v-c*m)-a*(o*v-i*m)+p*(o*c-i*s)),t[7]=n*(s*h-c*d)-a*(o*h-i*d)+f*(o*c-i*s),t[8]=a*(l*v-h*_)-f*(u*v-c*_)+p*(u*h-c*l),t[9]=-(n*(l*v-h*_)-f*(r*v-i*_)+p*(r*h-i*l)),t[10]=n*(u*v-c*_)-a*(r*v-i*_)+p*(r*c-i*u),t[11]=-(n*(u*h-c*l)-a*(r*h-i*l)+f*(r*c-i*u)),t[12]=-(a*(l*m-d*_)-f*(u*m-s*_)+p*(u*d-s*l)),t[13]=n*(l*m-d*_)-f*(r*m-o*_)+p*(r*d-o*l),t[14]=-(n*(u*m-s*_)-a*(r*m-o*_)+p*(r*s-o*u)),t[15]=n*(u*d-s*l)-a*(r*d-o*l)+f*(r*s-o*u),t}function oe(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],d=t[11],h=t[12],p=t[13],_=t[14],m=t[15];return(e*a-n*i)*(l*m-d*_)-(e*u-r*i)*(f*m-d*p)+(e*s-o*i)*(f*_-l*p)+(n*u-r*a)*(c*m-d*h)-(n*s-o*a)*(c*_-l*h)+(r*s-o*u)*(c*p-f*h)}function ie(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],d=e[9],h=e[10],p=e[11],_=e[12],m=e[13],v=e[14],y=e[15],g=n[0],b=n[1],M=n[2],T=n[3];return t[0]=g*r+b*u+M*l+T*_,t[1]=g*o+b*s+M*d+T*m,t[2]=g*i+b*c+M*h+T*v,t[3]=g*a+b*f+M*p+T*y,g=n[4],b=n[5],M=n[6],T=n[7],t[4]=g*r+b*u+M*l+T*_,t[5]=g*o+b*s+M*d+T*m,t[6]=g*i+b*c+M*h+T*v,t[7]=g*a+b*f+M*p+T*y,g=n[8],b=n[9],M=n[10],T=n[11],t[8]=g*r+b*u+M*l+T*_,t[9]=g*o+b*s+M*d+T*m,t[10]=g*i+b*c+M*h+T*v,t[11]=g*a+b*f+M*p+T*y,g=n[12],b=n[13],M=n[14],T=n[15],t[12]=g*r+b*u+M*l+T*_,t[13]=g*o+b*s+M*d+T*m,t[14]=g*i+b*c+M*h+T*v,t[15]=g*a+b*f+M*p+T*y,t}function ae(t,e,n){var r,o,i,a,u,s,c,f,l,d,h,p,_=n[0],m=n[1],v=n[2];return e===t?(t[12]=e[0]*_+e[4]*m+e[8]*v+e[12],t[13]=e[1]*_+e[5]*m+e[9]*v+e[13],t[14]=e[2]*_+e[6]*m+e[10]*v+e[14],t[15]=e[3]*_+e[7]*m+e[11]*v+e[15]):(r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],d=e[9],h=e[10],p=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=l,t[9]=d,t[10]=h,t[11]=p,t[12]=r*_+u*m+l*v+e[12],t[13]=o*_+s*m+d*v+e[13],t[14]=i*_+c*m+h*v+e[14],t[15]=a*_+f*m+p*v+e[15]),t}function ue(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function se(t,e,n,r){var o,i,a,u,s,c,f,l,d,p,_,m,v,y,g,b,M,T,S,O,A,x,w,P,E=r[0],j=r[1],R=r[2],I=Math.hypot(E,j,R);return I<h?null:(E*=I=1/I,j*=I,R*=I,o=Math.sin(n),a=1-(i=Math.cos(n)),u=e[0],s=e[1],c=e[2],f=e[3],l=e[4],d=e[5],p=e[6],_=e[7],m=e[8],v=e[9],y=e[10],g=e[11],b=E*E*a+i,M=j*E*a+R*o,T=R*E*a-j*o,S=E*j*a-R*o,O=j*j*a+i,A=R*j*a+E*o,x=E*R*a+j*o,w=j*R*a-E*o,P=R*R*a+i,t[0]=u*b+l*M+m*T,t[1]=s*b+d*M+v*T,t[2]=c*b+p*M+y*T,t[3]=f*b+_*M+g*T,t[4]=u*S+l*O+m*A,t[5]=s*S+d*O+v*A,t[6]=c*S+p*O+y*A,t[7]=f*S+_*O+g*A,t[8]=u*x+l*w+m*P,t[9]=s*x+d*w+v*P,t[10]=c*x+p*w+y*P,t[11]=f*x+_*w+g*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],a=e[5],u=e[6],s=e[7],c=e[8],f=e[9],l=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+c*r,t[5]=a*o+f*r,t[6]=u*o+l*r,t[7]=s*o+d*r,t[8]=c*o-i*r,t[9]=f*o-a*r,t[10]=l*o-u*r,t[11]=d*o-s*r,t}function fe(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],u=e[2],s=e[3],c=e[8],f=e[9],l=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-c*r,t[1]=a*o-f*r,t[2]=u*o-l*r,t[3]=s*o-d*r,t[8]=i*r+c*o,t[9]=a*r+f*o,t[10]=u*r+l*o,t[11]=s*r+d*o,t}function le(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],u=e[2],s=e[3],c=e[4],f=e[5],l=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+c*r,t[1]=a*o+f*r,t[2]=u*o+l*r,t[3]=s*o+d*r,t[4]=c*o-i*r,t[5]=f*o-a*r,t[6]=l*o-u*r,t[7]=d*o-s*r,t}function de(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function he(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pe(t,e,n){var r,o,i,a=n[0],u=n[1],s=n[2],c=Math.hypot(a,u,s);return c<h?null:(a*=c=1/c,u*=c,s*=c,r=Math.sin(e),i=1-(o=Math.cos(e)),t[0]=a*a*i+o,t[1]=u*a*i+s*r,t[2]=s*a*i-u*r,t[3]=0,t[4]=a*u*i-s*r,t[5]=u*u*i+o,t[6]=s*u*i+a*r,t[7]=0,t[8]=a*s*i+u*r,t[9]=u*s*i-a*r,t[10]=s*s*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function _e(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ye(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=r+r,s=o+o,c=i+i,f=r*u,l=r*s,d=r*c,h=o*s,p=o*c,_=i*c,m=a*u,v=a*s,y=a*c;return t[0]=1-(h+_),t[1]=l+y,t[2]=d-v,t[3]=0,t[4]=l-y,t[5]=1-(f+_),t[6]=p+m,t[7]=0,t[8]=d+v,t[9]=p-m,t[10]=1-(f+h),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ge(t,e){var n=new p(3),r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=r*r+o*o+i*i+a*a;return l>0?(n[0]=2*(u*a+f*r+s*i-c*o)/l,n[1]=2*(s*a+f*o+c*r-u*i)/l,n[2]=2*(c*a+f*i+u*o-s*r)/l):(n[0]=2*(u*a+f*r+s*i-c*o),n[1]=2*(s*a+f*o+c*r-u*i),n[2]=2*(c*a+f*i+u*o-s*r)),ye(t,e,n),t}function be(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Me(t,e){var n=e[0],r=e[1],o=e[2],i=e[4],a=e[5],u=e[6],s=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,o),t[1]=Math.hypot(i,a,u),t[2]=Math.hypot(s,c,f),t}function Te(t,e){var n=new p(3);Me(n,e);var r=1/n[0],o=1/n[1],i=1/n[2],a=e[0]*r,u=e[1]*o,s=e[2]*i,c=e[4]*r,f=e[5]*o,l=e[6]*i,d=e[8]*r,h=e[9]*o,_=e[10]*i,m=a+f+_,v=0;return m>0?(v=2*Math.sqrt(m+1),t[3]=.25*v,t[0]=(l-h)/v,t[1]=(d-s)/v,t[2]=(u-c)/v):a>f&&a>_?(v=2*Math.sqrt(1+a-f-_),t[3]=(l-h)/v,t[0]=.25*v,t[1]=(u+c)/v,t[2]=(d+s)/v):f>_?(v=2*Math.sqrt(1+f-a-_),t[3]=(d-s)/v,t[0]=(u+c)/v,t[1]=.25*v,t[2]=(l+h)/v):(v=2*Math.sqrt(1+_-a-f),t[3]=(u-c)/v,t[0]=(d+s)/v,t[1]=(l+h)/v,t[2]=.25*v),t}function Se(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=e[3],s=o+o,c=i+i,f=a+a,l=o*s,d=o*c,h=o*f,p=i*c,_=i*f,m=a*f,v=u*s,y=u*c,g=u*f,b=r[0],M=r[1],T=r[2];return t[0]=(1-(p+m))*b,t[1]=(d+g)*b,t[2]=(h-y)*b,t[3]=0,t[4]=(d-g)*M,t[5]=(1-(l+m))*M,t[6]=(_+v)*M,t[7]=0,t[8]=(h+y)*T,t[9]=(_-v)*T,t[10]=(1-(l+p))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Oe(t,e,n,r,o){var i=e[0],a=e[1],u=e[2],s=e[3],c=i+i,f=a+a,l=u+u,d=i*c,h=i*f,p=i*l,_=a*f,m=a*l,v=u*l,y=s*c,g=s*f,b=s*l,M=r[0],T=r[1],S=r[2],O=o[0],A=o[1],x=o[2],w=(1-(_+v))*M,P=(h+b)*M,E=(p-g)*M,j=(h-b)*T,R=(1-(d+v))*T,I=(m+y)*T,C=(p+g)*S,N=(m-y)*S,L=(1-(d+_))*S;return t[0]=w,t[1]=P,t[2]=E,t[3]=0,t[4]=j,t[5]=R,t[6]=I,t[7]=0,t[8]=C,t[9]=N,t[10]=L,t[11]=0,t[12]=n[0]+O-(w*O+j*A+C*x),t[13]=n[1]+A-(P*O+R*A+N*x),t[14]=n[2]+x-(E*O+I*A+L*x),t[15]=1,t}function Ae(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,l=r*u,d=o*a,h=o*u,p=o*s,_=i*a,m=i*u,v=i*s;return t[0]=1-l-p,t[1]=f+v,t[2]=d-m,t[3]=0,t[4]=f-v,t[5]=1-c-p,t[6]=h+_,t[7]=0,t[8]=d+m,t[9]=h-_,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xe(t,e,n,r,o,i,a){var u=1/(n-e),s=1/(o-r),c=1/(i-a);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(o+r)*s,t[10]=(a+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*c,t[15]=0,t}function we(t,e,n,r,o){var i,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(i=1/(r-o),t[10]=(o+r)*i,t[14]=2*o*r*i):(t[10]=-1,t[14]=-2*r),t}function Pe(t,e,n,r){var o=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(o+i);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(o-i)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Ee(t,e,n,r,o,i,a){var u=1/(e-n),s=1/(r-o),c=1/(i-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(o+r)*s,t[14]=(a+i)*c,t[15]=1,t}function je(t,e,n,r){var o,i,a,u,s,c,f,l,d,p,_=e[0],m=e[1],v=e[2],y=r[0],g=r[1],b=r[2],M=n[0],T=n[1],S=n[2];return Math.abs(_-M)<h&&Math.abs(m-T)<h&&Math.abs(v-S)<h?te(t):(f=_-M,l=m-T,d=v-S,o=g*(d*=p=1/Math.hypot(f,l,d))-b*(l*=p),i=b*(f*=p)-y*d,a=y*l-g*f,(p=Math.hypot(o,i,a))?(o*=p=1/p,i*=p,a*=p):(o=0,i=0,a=0),u=l*a-d*i,s=d*o-f*a,c=f*i-l*o,(p=Math.hypot(u,s,c))?(u*=p=1/p,s*=p,c*=p):(u=0,s=0,c=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=i,t[5]=s,t[6]=l,t[7]=0,t[8]=a,t[9]=c,t[10]=d,t[11]=0,t[12]=-(o*_+i*m+a*v),t[13]=-(u*_+s*m+c*v),t[14]=-(f*_+l*m+d*v),t[15]=1,t)}function Re(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=r[0],s=r[1],c=r[2],f=o-n[0],l=i-n[1],d=a-n[2],h=f*f+l*l+d*d;h>0&&(f*=h=1/Math.sqrt(h),l*=h,d*=h);var p=s*d-c*l,_=c*f-u*d,m=u*l-s*f;return(h=p*p+_*_+m*m)>0&&(p*=h=1/Math.sqrt(h),_*=h,m*=h),t[0]=p,t[1]=_,t[2]=m,t[3]=0,t[4]=l*m-d*_,t[5]=d*p-f*m,t[6]=f*_-l*p,t[7]=0,t[8]=f,t[9]=l,t[10]=d,t[11]=0,t[12]=o,t[13]=i,t[14]=a,t[15]=1,t}function Ie(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ce(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ne(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Le(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Fe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Ue(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Be(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ve(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],p=t[11],_=t[12],m=t[13],v=t[14],y=t[15],g=e[0],b=e[1],M=e[2],T=e[3],S=e[4],O=e[5],A=e[6],x=e[7],w=e[8],P=e[9],E=e[10],j=e[11],R=e[12],I=e[13],C=e[14],N=e[15];return Math.abs(n-g)<=h*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-b)<=h*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(o-M)<=h*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(i-T)<=h*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(a-S)<=h*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-O)<=h*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(s-A)<=h*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(c-x)<=h*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(f-w)<=h*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(l-P)<=h*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(d-E)<=h*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(p-j)<=h*Math.max(1,Math.abs(p),Math.abs(j))&&Math.abs(_-R)<=h*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(m-I)<=h*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-C)<=h*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(y-N)<=h*Math.max(1,Math.abs(y),Math.abs(N))}var Ge=ie,De=Le;function He(){var t=new p(3);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ke(t){var e=new p(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ze(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function We(t,e,n){var r=new p(3);return r[0]=t,r[1]=e,r[2]=n,r}function Xe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function qe(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Qe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Je(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ke(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ye(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ze(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function on(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.hypot(n,r,o)}function un(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o}function sn(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function fn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ln(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function dn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hn(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2];return t[0]=o*s-i*u,t[1]=i*a-r*s,t[2]=r*u-o*a,t}function pn(t,e,n,r){var o=e[0],i=e[1],a=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t}function _n(t,e,n,r,o,i){var a=i*i,u=a*(2*i-3)+1,s=a*(i-2)+i,c=a*(i-1),f=a*(3-2*i);return t[0]=e[0]*u+n[0]*s+r[0]*c+o[0]*f,t[1]=e[1]*u+n[1]*s+r[1]*c+o[1]*f,t[2]=e[2]*u+n[2]*s+r[2]*c+o[2]*f,t}function mn(t,e,n,r,o,i){var a=1-i,u=a*a,s=i*i,c=u*a,f=3*i*u,l=3*s*a,d=s*i;return t[0]=e[0]*c+n[0]*f+r[0]*l+o[0]*d,t[1]=e[1]*c+n[1]*f+r[1]*l+o[1]*d,t[2]=e[2]*c+n[2]*f+r[2]*l+o[2]*d,t}function vn(t,e){e=e||1;var n=2*_()*Math.PI,r=2*_()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t}function yn(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,t}function gn(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t}function bn(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=o*c-i*s,l=i*u-r*c,d=r*s-o*u,h=o*d-i*l,p=i*f-r*d,_=r*l-o*f,m=2*a;return f*=m,l*=m,d*=m,h*=2,p*=2,_*=2,t[0]=u+f+h,t[1]=s+l+p,t[2]=c+d+_,t}function Mn(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Tn(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Sn(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function On(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],a=e[1],u=e[2],s=Math.sqrt(n*n+r*r+o*o)*Math.sqrt(i*i+a*a+u*u),c=s&&dn(t,e)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function An(t){return t[0]=0,t[1]=0,t[2]=0,t}function xn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function wn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Pn(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],a=e[1],u=e[2];return Math.abs(n-i)<=h*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(o-u)<=h*Math.max(1,Math.abs(o),Math.abs(u))}var En,jn=Je,Rn=Ke,In=Ye,Cn=an,Nn=un,Ln=ze,Fn=sn,Un=(En=He(),function(t,e,n,r,o,i){var a,u;for(e||(e=3),n||(n=0),u=r?Math.min(r*e+n,t.length):t.length,a=n;a<u;a+=e)En[0]=t[a],En[1]=t[a+1],En[2]=t[a+2],o(En,En,i),t[a]=En[0],t[a+1]=En[1],t[a+2]=En[2];return t});function Bn(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Vn(t){var e=new p(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Gn(t,e,n,r){var o=new p(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o}function Dn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Hn(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t}function kn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function zn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Wn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Xn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function qn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Qn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Jn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Kn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Yn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Zn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $n(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return Math.hypot(n,r,o,i)}function er(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+o*o+i*i}function nr(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.hypot(e,n,r,o)}function rr(t){var e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o}function or(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function ir(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ar(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=o*a,t[3]=i*a,t}function ur(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function sr(t,e,n,r){var o=n[0]*r[1]-n[1]*r[0],i=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],s=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],f=e[0],l=e[1],d=e[2],h=e[3];return t[0]=l*c-d*s+h*u,t[1]=-f*c+d*a-h*i,t[2]=f*s-l*a+h*o,t[3]=-f*u+l*i-d*o,t}function cr(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t}function fr(t,e){var n,r,o,i,a,u;e=e||1;do{a=(n=2*_()-1)*n+(r=2*_()-1)*r}while(a>=1);do{u=(o=2*_()-1)*o+(i=2*_()-1)*i}while(u>=1);var s=Math.sqrt((1-a)/u);return t[0]=e*n,t[1]=e*r,t[2]=e*o*s,t[3]=e*i*s,t}function lr(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*a,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*a,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*a,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*a,t}function dr(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2],c=n[3],f=c*r+u*i-s*o,l=c*o+s*r-a*i,d=c*i+a*o-u*r,h=-a*r-u*o-s*i;return t[0]=f*c+h*-a+l*-s-d*-u,t[1]=l*c+h*-u+d*-a-f*-s,t[2]=d*c+h*-s+f*-u-l*-a,t[3]=e[3],t}function hr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function pr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function _r(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function mr(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-s)<=h*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=h*Math.max(1,Math.abs(i),Math.abs(c))}var vr=zn,yr=Wn,gr=Xn,br=tr,Mr=er,Tr=nr,Sr=rr,Or=function(){var t=Bn();return function(e,n,r,o,i,a){var u,s;for(n||(n=4),r||(r=0),s=o?Math.min(o*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],i(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}();function Ar(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function xr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function wr(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Pr(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>h?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Er(t,e){var n=oo(t,e);return Math.acos(2*n*n-1)}function jr(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=r*f+a*u+o*c-i*s,t[1]=o*f+a*s+i*u-r*c,t[2]=i*f+a*c+r*s-o*u,t[3]=a*f-r*u-o*s-i*c,t}function Rr(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+a*u,t[1]=o*s+i*u,t[2]=i*s-o*u,t[3]=a*s-r*u,t}function Ir(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s-i*u,t[1]=o*s+a*u,t[2]=i*s+r*u,t[3]=a*s-o*u,t}function Cr(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+o*u,t[1]=o*s-r*u,t[2]=i*s+a*u,t[3]=a*s-i*u,t}function Nr(t,e){var n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t}function Lr(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=Math.sqrt(n*n+r*r+o*o),u=Math.exp(i),s=a>0?u*Math.sin(a)/a:0;return t[0]=n*s,t[1]=r*s,t[2]=o*s,t[3]=u*Math.cos(a),t}function Fr(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=Math.sqrt(n*n+r*r+o*o),u=a>0?Math.atan2(a,i)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=o*u,t[3]=.5*Math.log(n*n+r*r+o*o+i*i),t}function Ur(t,e,n){return Fr(t,e),ro(t,t,n),Lr(t,t),t}function Br(t,e,n,r){var o,i,a,u,s,c=e[0],f=e[1],l=e[2],d=e[3],p=n[0],_=n[1],m=n[2],v=n[3];return(i=c*p+f*_+l*m+d*v)<0&&(i=-i,p=-p,_=-_,m=-m,v=-v),1-i>h?(o=Math.acos(i),a=Math.sin(o),u=Math.sin((1-r)*o)/a,s=Math.sin(r*o)/a):(u=1-r,s=r),t[0]=u*c+s*p,t[1]=u*f+s*_,t[2]=u*l+s*m,t[3]=u*d+s*v,t}function Vr(t){var e=_(),n=_(),r=_(),o=Math.sqrt(1-e),i=Math.sqrt(e);return t[0]=o*Math.sin(2*Math.PI*n),t[1]=o*Math.cos(2*Math.PI*n),t[2]=i*Math.sin(2*Math.PI*r),t[3]=i*Math.cos(2*Math.PI*r),t}function Gr(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,u=a?1/a:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-o*u,t[3]=i*u,t}function Dr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Hr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var o=0;e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2);var i=(o+1)%3,a=(o+2)%3;n=Math.sqrt(e[3*o+o]-e[3*i+i]-e[3*a+a]+1),t[o]=.5*n,n=.5/n,t[3]=(e[3*i+a]-e[3*a+i])*n,t[i]=(e[3*i+o]+e[3*o+i])*n,t[a]=(e[3*a+o]+e[3*o+a])*n}return t}function kr(t,e,n,r){var o=.5*Math.PI/180;e*=o,n*=o,r*=o;var i=Math.sin(e),a=Math.cos(e),u=Math.sin(n),s=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return t[0]=i*s*f-a*u*c,t[1]=a*u*f+i*s*c,t[2]=a*s*c-i*u*f,t[3]=a*s*f+i*u*c,t}function zr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Wr,Xr,qr,Qr,Jr,Kr,Yr=Vn,Zr=Gn,$r=Dn,to=Hn,eo=kn,no=jr,ro=Zn,oo=ur,io=cr,ao=nr,uo=ao,so=rr,co=so,fo=ar,lo=_r,ho=mr,po=(Wr=He(),Xr=We(1,0,0),qr=We(0,1,0),function(t,e,n){var r=dn(e,n);return r<-.999999?(hn(Wr,Xr,e),Ln(Wr)<1e-6&&hn(Wr,qr,e),ln(Wr,Wr),wr(t,Wr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(hn(Wr,e,n),t[0]=Wr[0],t[1]=Wr[1],t[2]=Wr[2],t[3]=1+r,fo(t,t))}),_o=(Qr=Ar(),Jr=Ar(),function(t,e,n,r,o,i){return Br(Qr,e,o,i),Br(Jr,n,r,i),Br(t,Qr,Jr,2*i*(1-i)),t}),mo=(Kr=vt(),function(t,e,n,r){return Kr[0]=n[0],Kr[3]=n[1],Kr[6]=n[2],Kr[1]=r[0],Kr[4]=r[1],Kr[7]=r[2],Kr[2]=-e[0],Kr[5]=-e[1],Kr[8]=-e[2],fo(t,Hr(t,Kr))});function vo(){var t=new p(8);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function yo(t){var e=new p(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function go(t,e,n,r,o,i,a,u){var s=new p(8);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s[4]=o,s[5]=i,s[6]=a,s[7]=u,s}function bo(t,e,n,r,o,i,a){var u=new p(8);u[0]=t,u[1]=e,u[2]=n,u[3]=r;var s=.5*o,c=.5*i,f=.5*a;return u[4]=s*r+c*n-f*e,u[5]=c*r+f*t-s*n,u[6]=f*r+s*e-c*t,u[7]=-s*t-c*e-f*n,u}function Mo(t,e,n){var r=.5*n[0],o=.5*n[1],i=.5*n[2],a=e[0],u=e[1],s=e[2],c=e[3];return t[0]=a,t[1]=u,t[2]=s,t[3]=c,t[4]=r*c+o*s-i*u,t[5]=o*c+i*a-r*s,t[6]=i*c+r*u-o*a,t[7]=-r*a-o*u-i*s,t}function To(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function So(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Oo(t,e){var n=Ar();Te(n,e);var r=new p(3);return be(r,e),Mo(t,n,r),t}function Ao(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function xo(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function wo(t,e,n,r,o,i,a,u,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t}var Po=$r;function Eo(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var jo=$r;function Ro(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Io(t,e){var n=e[4],r=e[5],o=e[6],i=e[7],a=-e[0],u=-e[1],s=-e[2],c=e[3];return t[0]=2*(n*c+i*a+r*s-o*u),t[1]=2*(r*c+i*u+o*a-n*s),t[2]=2*(o*c+i*s+n*u-r*a),t}function Co(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=.5*n[0],s=.5*n[1],c=.5*n[2],f=e[4],l=e[5],d=e[6],h=e[7];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=a*u+o*c-i*s+f,t[5]=a*s+i*u-r*c+l,t[6]=a*c+r*s-o*u+d,t[7]=-r*u-o*s-i*c+h,t}function No(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Rr(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+p*r+d*i-h*o,t[5]=d*a+p*o+h*r-l*i,t[6]=h*a+p*i+l*o-d*r,t[7]=p*a-l*r-d*o-h*i,t}function Lo(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Ir(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+p*r+d*i-h*o,t[5]=d*a+p*o+h*r-l*i,t[6]=h*a+p*i+l*o-d*r,t[7]=p*a-l*r-d*o-h*i,t}function Fo(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,d=s*a+f*o+c*r-u*i,h=c*a+f*i+u*o-s*r,p=f*a-u*r-s*o-c*i;return Cr(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+p*r+d*i-h*o,t[5]=d*a+p*o+h*r-l*i,t[6]=h*a+p*i+l*o-d*r,t[7]=p*a-l*r-d*o-h*i,t}function Uo(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=e[3];return t[0]=u*a+f*r+s*i-c*o,t[1]=s*a+f*o+c*r-u*i,t[2]=c*a+f*i+u*o-s*r,t[3]=f*a-u*r-s*o-c*i,u=e[4],s=e[5],c=e[6],f=e[7],t[4]=u*a+f*r+s*i-c*o,t[5]=s*a+f*o+c*r-u*i,t[6]=c*a+f*i+u*o-s*r,t[7]=f*a-u*r-s*o-c*i,t}function Bo(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=r*f+a*u+o*c-i*s,t[1]=o*f+a*s+i*u-r*c,t[2]=i*f+a*c+r*s-o*u,t[3]=a*f-r*u-o*s-i*c,u=n[4],s=n[5],c=n[6],f=n[7],t[4]=r*f+a*u+o*c-i*s,t[5]=o*f+a*s+i*u-r*c,t[6]=i*f+a*c+r*s-o*u,t[7]=a*f-r*u-o*s-i*c,t}function Vo(t,e,n,r){if(Math.abs(r)<h)return Ao(t,e);var o=Math.hypot(n[0],n[1],n[2]);r*=.5;var i=Math.sin(r),a=i*n[0]/o,u=i*n[1]/o,s=i*n[2]/o,c=Math.cos(r),f=e[0],l=e[1],d=e[2],p=e[3];t[0]=f*c+p*a+l*s-d*u,t[1]=l*c+p*u+d*a-f*s,t[2]=d*c+p*s+f*u-l*a,t[3]=p*c-f*a-l*u-d*s;var _=e[4],m=e[5],v=e[6],y=e[7];return t[4]=_*c+y*a+m*s-v*u,t[5]=m*c+y*u+v*a-_*s,t[6]=v*c+y*s+_*u-m*a,t[7]=y*c-_*a-m*u-v*s,t}function Go(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Do(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[4],s=n[5],c=n[6],f=n[7],l=e[4],d=e[5],h=e[6],p=e[7],_=n[0],m=n[1],v=n[2],y=n[3];return t[0]=r*y+a*_+o*v-i*m,t[1]=o*y+a*m+i*_-r*v,t[2]=i*y+a*v+r*m-o*_,t[3]=a*y-r*_-o*m-i*v,t[4]=r*f+a*u+o*c-i*s+l*y+p*_+d*v-h*m,t[5]=o*f+a*s+i*u-r*c+d*y+p*m+h*_-l*v,t[6]=i*f+a*c+r*s-o*u+h*y+p*v+l*m-d*_,t[7]=a*f-r*u-o*s-i*c+p*y-l*_-d*m-h*v,t}var Ho=Do;function ko(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var zo=oo;function Wo(t,e,n,r){var o=1-r;return zo(e,n)<0&&(r=-r),t[0]=e[0]*o+n[0]*r,t[1]=e[1]*o+n[1]*r,t[2]=e[2]*o+n[2]*r,t[3]=e[3]*o+n[3]*r,t[4]=e[4]*o+n[4]*r,t[5]=e[5]*o+n[5]*r,t[6]=e[6]*o+n[6]*r,t[7]=e[7]*o+n[7]*r,t}function Xo(t,e){var n=Ko(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function qo(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Qo=ao,Jo=Qo,Ko=so,Yo=Ko;function Zo(t,e){var n=Ko(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,o=e[1]/n,i=e[2]/n,a=e[3]/n,u=e[4],s=e[5],c=e[6],f=e[7],l=r*u+o*s+i*c+a*f;t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=(u-r*l)/n,t[5]=(s-o*l)/n,t[6]=(c-i*l)/n,t[7]=(f-a*l)/n}return t}function $o(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function ti(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ei(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=e[0],l=e[1],d=e[2],p=e[3],_=e[4],m=e[5],v=e[6],y=e[7];return Math.abs(n-f)<=h*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=h*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-d)<=h*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-p)<=h*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-_)<=h*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-m)<=h*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(s-v)<=h*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-y)<=h*Math.max(1,Math.abs(c),Math.abs(y))}function ni(){var t=new p(2);return p!=Float32Array&&(t[0]=0,t[1]=0),t}function ri(t){var e=new p(2);return e[0]=t[0],e[1]=t[1],e}function oi(t,e){var n=new p(2);return n[0]=t,n[1]=e,n}function ii(t,e){return t[0]=e[0],t[1]=e[1],t}function ai(t,e,n){return t[0]=e,t[1]=n,t}function ui(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function si(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function ci(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function fi(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function li(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function di(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function hi(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function pi(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function _i(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function mi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function vi(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function yi(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function gi(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function bi(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Mi(t){var e=t[0],n=t[1];return e*e+n*n}function Ti(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Si(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Oi(t,e){var n=e[0],r=e[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Ai(t,e){return t[0]*e[0]+t[1]*e[1]}function xi(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function wi(t,e,n,r){var o=e[0],i=e[1];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t}function Pi(t,e){e=e||1;var n=2*_()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Ei(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t}function ji(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o+n[4],t[1]=n[1]*r+n[3]*o+n[5],t}function Ri(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t}function Ii(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t}function Ci(t,e,n,r){var o=e[0]-n[0],i=e[1]-n[1],a=Math.sin(r),u=Math.cos(r);return t[0]=o*u-i*a+n[0],t[1]=o*a+i*u+n[1],t}function Ni(t,e){var n=t[0],r=t[1],o=e[0],i=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(o*o+i*i),u=a&&(n*o+r*i)/a;return Math.acos(Math.min(Math.max(u,-1),1))}function Li(t){return t[0]=0,t[1]=0,t}function Fi(t){return"vec2("+t[0]+", "+t[1]+")"}function Ui(t,e){return t[0]===e[0]&&t[1]===e[1]}function Bi(t,e){var n=t[0],r=t[1],o=e[0],i=e[1];return Math.abs(n-o)<=h*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=h*Math.max(1,Math.abs(r),Math.abs(i))}var Vi=bi,Gi=si,Di=ci,Hi=fi,ki=yi,zi=gi,Wi=Mi,Xi=function(){var t=ni();return function(e,n,r,o,i,a){var u,s;for(n||(n=2),r||(r=0),s=o?Math.min(o*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],i(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}();n.d(e,"glMatrix",(function(){return r})),n.d(e,"mat2",(function(){return o})),n.d(e,"mat2d",(function(){return i})),n.d(e,"mat3",(function(){return a})),n.d(e,"mat4",(function(){return u})),n.d(e,"quat",(function(){return f})),n.d(e,"quat2",(function(){return l})),n.d(e,"vec2",(function(){return d})),n.d(e,"vec3",(function(){return s})),n.d(e,"vec4",(function(){return c}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterial=void 0;var c=u(n(0)),f=n(10),l=n(49),d=n(51),h=n(23),p=n(5),_=n(35),m=n(36),v=n(20),y=n(55),g=n(16),b=n(11),M=n(56),T={},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._unlit=!1,e._alphaMode=v.StandardMaterialAlphaMode.opaque,e._baseColor=new Float32Array(4),e._instancingEnabled=!1,e._skinUniforms=new y.StandardMaterialSkinUniforms,e.roughness=1,e.metallic=1,e.baseColor=new b.Color(1,1,1,1),e.alphaCutoff=.5,e.emissive=new b.Color(0,0,0,0),e.exposure=3,e}return o(e,t),Object.defineProperty(e.prototype,"baseColorTexture",{get:function(){return this._baseColorTexture},set:function(t){t!==this._baseColorTexture&&(this.invalidateShader(),this._baseColorTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metallicRoughnessTexture",{get:function(){return this._metallicRoughnessTexture},set:function(t){t!==this._metallicRoughnessTexture&&(this.invalidateShader(),this._metallicRoughnessTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalTexture",{get:function(){return this._normalTexture},set:function(t){t!==this._normalTexture&&(this.invalidateShader(),this._normalTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"occlusionTexture",{get:function(){return this._occlusionTexture},set:function(t){t!==this._occlusionTexture&&(this.invalidateShader(),this._occlusionTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emissiveTexture",{get:function(){return this._emissiveTexture},set:function(t){t!==this._emissiveTexture&&(this.invalidateShader(),this._emissiveTexture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaMode",{get:function(){return this._alphaMode},set:function(t){if(this._alphaMode!==t){switch(this._alphaMode=t,this._alphaMode){case v.StandardMaterialAlphaMode.opaque:case v.StandardMaterialAlphaMode.mask:this.renderSortType=g.MaterialRenderSortType.opaque,this.state.depthMask=!0;break;case v.StandardMaterialAlphaMode.blend:this.renderSortType=g.MaterialRenderSortType.transparent,this.state.depthMask=!1}this.invalidateShader()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadowCastingLight",{get:function(){return this._shadowCastingLight},set:function(t){t!==this._shadowCastingLight&&(this.invalidateShader(),this._shadowCastingLight=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return this._debugMode},set:function(t){this._debugMode!==t&&(this.invalidateShader(),this._debugMode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightingEnvironment",{get:function(){return this._lightingEnvironment},set:function(t){t!==this._lightingEnvironment&&(this.invalidateShader(),this._lightingEnvironment=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unlit",{get:function(){return this._unlit},set:function(t){this._unlit!==t&&(this._unlit=t,this.invalidateShader())},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){var t,e,n,r,o;null===(t=this._baseColorTexture)||void 0===t||t.destroy(),null===(e=this._normalTexture)||void 0===e||e.destroy(),null===(n=this._emissiveTexture)||void 0===n||n.destroy(),null===(r=this._occlusionTexture)||void 0===r||r.destroy(),null===(o=this._metallicRoughnessTexture)||void 0===o||o.destroy(),this._skinUniforms.destroy()},e.prototype.invalidateShader=function(){this._shader=void 0},e.factory=function(t){return void 0===t&&(t={}),{create:function(n){return Object.assign(e.create(n),t)}}},e.create=function(t){var n,r,o,i,a,u=new e;if(t instanceof _.glTFMaterial){switch(u.baseColor=b.Color.from(t.baseColor),u.baseColorTexture=null===(n=t.baseColorTexture)||void 0===n?void 0:n.clone(),u.metallic=t.metallic,u.roughness=t.roughness,u.metallicRoughnessTexture=null===(r=t.metallicRoughnessTexture)||void 0===r?void 0:r.clone(),t.alphaMode){case"BLEND":u.alphaMode=v.StandardMaterialAlphaMode.blend;break;case"MASK":u.alphaMode=v.StandardMaterialAlphaMode.mask;break;case"OPAQUE":u.alphaMode=v.StandardMaterialAlphaMode.opaque}u.unlit=t.unlit,u.emissiveTexture=null===(o=t.emissiveTexture)||void 0===o?void 0:o.clone(),u.emissive=b.Color.from(t.emissive),u.normalTexture=null===(i=t.normalTexture)||void 0===i?void 0:i.clone(),u.occlusionTexture=null===(a=t.occlusionTexture)||void 0===a?void 0:a.clone(),u.doubleSided=t.doubleSided,u.alphaCutoff=t.alphaCutoff,t.baseColorTexture&&t.baseColorTexture.uvTransform&&(u.baseColorTexture.uvTransform=t.baseColorTexture.uvTransform),t.normalTexture&&t.normalTexture.uvTransform&&(u.normalTexture.uvTransform=t.normalTexture.uvTransform),t.emissiveTexture&&t.emissiveTexture.uvTransform&&(u.emissiveTexture.uvTransform=t.emissiveTexture.uvTransform),t.occlusionTexture&&t.occlusionTexture.uvTransform&&(u.occlusionTexture.uvTransform=t.occlusionTexture.uvTransform),t.metallicRoughnessTexture&&t.metallicRoughnessTexture.uvTransform&&(u.metallicRoughnessTexture.uvTransform=t.metallicRoughnessTexture.uvTransform)}return u},e.prototype.render=function(e,n){!this._instancingEnabled&&e.instances.length>0&&(this.invalidateShader(),this._instancingEnabled=e.instances.length>0);var r=this.lightingEnvironment||m.LightingEnvironment.main;r.lights.length!==this._lightsCount&&(this.invalidateShader(),this._lightsCount=r.lights.length),t.prototype.render.call(this,e,n)},Object.defineProperty(e.prototype,"isInstancingSupported",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.createInstance=function(){return new M.InstancedStandardMaterial(this)},e.prototype.createShader=function(t,e){var n,r;if(1===e.context.webGLVersion){try{for(var o=s(["EXT_shader_texture_lod","OES_standard_derivatives"]),i=o.next();!i.done;i=o.next()){var a=i.value;e.gl.getExtension(a)||console.warn('PIXI3D: Extension "'+a+'" is not supported by current platform, the material may not be displayed correctly.')}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var u=this.lightingEnvironment||m.LightingEnvironment.main,c=l.StandardMaterialFeatureSet.build(e,t,t.geometry,this,u);if(c){t.skin&&l.StandardMaterialFeatureSet.hasSkinningTextureFeature(c)&&this._skinUniforms.enableJointMatrixTextures(t.skin.joints.length);var f=c.join(",");return T[f]||(T[f]=d.StandardShader.build(e,c)),T[f]}},e.prototype.updateUniforms=function(t,e){var n,r,o,i,a;this._baseColor.set(this.baseColor.rgb),this._baseColor[3]=this.baseColor.a*t.worldAlpha;var u=this.camera||p.Camera.main;t.skin&&this._skinUniforms.update(t,e),e.uniforms.u_Camera=u.worldTransform.position,e.uniforms.u_ViewProjectionMatrix=u.viewProjection,e.uniforms.u_Exposure=this.exposure,e.uniforms.u_MetallicFactor=this.metallic,e.uniforms.u_RoughnessFactor=this.roughness,e.uniforms.u_BaseColorFactor=this._baseColor,e.uniforms.u_EmissiveFactor=this.emissive.rgb,e.uniforms.u_ModelMatrix=t.worldTransform.toArray(),e.uniforms.u_NormalMatrix=t.transform.normalTransform.toArray(),this._shadowCastingLight&&(e.uniforms.u_ShadowSampler=this._shadowCastingLight.shadowTexture,e.uniforms.u_LightViewProjectionMatrix=this._shadowCastingLight.lightViewProjection),this._alphaMode===v.StandardMaterialAlphaMode.mask&&(e.uniforms.u_AlphaCutoff=this.alphaCutoff),t.morphWeights&&(e.uniforms.u_morphWeights=t.morphWeights),(null===(n=this.baseColorTexture)||void 0===n?void 0:n.valid)&&(e.uniforms.u_BaseColorSampler=this.baseColorTexture,e.uniforms.u_BaseColorUVSet=0,this.baseColorTexture.uvTransform&&(e.uniforms.u_BaseColorUVTransform=this.baseColorTexture.uvTransform));for(var s=this.lightingEnvironment||m.LightingEnvironment.main,l=0;l<s.lights.length;l++){var d=s.lights[l],h=0;switch(d.type){case f.LightType.point:h=1;break;case f.LightType.directional:h=0;break;case f.LightType.spot:h=2;break;case f.LightType.ambient:h=3}e.uniforms["u_Lights["+l+"].type"]=h,e.uniforms["u_Lights["+l+"].position"]=d.worldTransform.position,e.uniforms["u_Lights["+l+"].direction"]=d.worldTransform.forward,e.uniforms["u_Lights["+l+"].range"]=d.range,e.uniforms["u_Lights["+l+"].color"]=d.color.rgb,e.uniforms["u_Lights["+l+"].intensity"]=d.intensity,e.uniforms["u_Lights["+l+"].innerConeCos"]=Math.cos(d.innerConeAngle*c.DEG_TO_RAD),e.uniforms["u_Lights["+l+"].outerConeCos"]=Math.cos(d.outerConeAngle*c.DEG_TO_RAD)}var _=s.imageBasedLighting;(null==_?void 0:_.valid)&&(e.uniforms.u_DiffuseEnvSampler=_.diffuse,e.uniforms.u_SpecularEnvSampler=_.specular,e.uniforms.u_brdfLUT=_.brdf,e.uniforms.u_MipCount=_.specular.levels-1),(null===(r=this.emissiveTexture)||void 0===r?void 0:r.valid)&&(e.uniforms.u_EmissiveSampler=this.emissiveTexture,e.uniforms.u_EmissiveUVSet=0,e.uniforms.u_EmissiveFactor=[1,1,1],this.emissiveTexture.uvTransform&&(e.uniforms.u_EmissiveUVTransform=this.emissiveTexture.uvTransform)),(null===(o=this.normalTexture)||void 0===o?void 0:o.valid)&&(e.uniforms.u_NormalSampler=this.normalTexture,e.uniforms.u_NormalScale=1,e.uniforms.u_NormalUVSet=0,this.normalTexture.uvTransform&&(e.uniforms.u_NormalUVTransform=this.normalTexture.uvTransform)),(null===(i=this.metallicRoughnessTexture)||void 0===i?void 0:i.valid)&&(e.uniforms.u_MetallicRoughnessSampler=this.metallicRoughnessTexture,e.uniforms.u_MetallicRoughnessUVSet=0,this.metallicRoughnessTexture.uvTransform&&(e.uniforms.u_MetallicRoughnessUVTransform=this.metallicRoughnessTexture.uvTransform)),(null===(a=this.occlusionTexture)||void 0===a?void 0:a.valid)&&(e.uniforms.u_OcclusionSampler=this.occlusionTexture,e.uniforms.u_OcclusionStrength=1,e.uniforms.u_OcclusionUVSet=0,this.occlusionTexture.uvTransform&&(e.uniforms.u_OcclusionUVTransform=this.occlusionTexture.uvTransform))},e}(h.Material);e.StandardMaterial=S},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MaterialRenderSortType=void 0,function(t){t.opaque="opaque",t.transparent="transparent"}(e.MaterialRenderSortType||(e.MaterialRenderSortType={}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.glTFAsset=void 0;var a=i(n(0)),u=function(){function t(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=[]),this.descriptor=t,this.buffers=e,this.images=n}return t.load=function(e,n){for(var r=new t(e),o=function(o){var i=e.buffers[o];if(t.isEmbeddedResource(i.uri))r.buffers[o]=t.getEmbeddedBuffer(i.uri);else{if(!n)throw new Error("PIXI3D: A resource loader is required when buffer is not embedded.");n.load(i.uri,(function(t){r.buffers[o]=t.data}))}},i=0;i<e.buffers.length;i++)o(i);if(!e.images)return r;var u=function(o){var i=e.images[o];if(t.isEmbeddedResource(i.uri))r.images[o]=a.Texture.from(i.uri,{wrapMode:a.WRAP_MODES.REPEAT});else{if(!n)throw new Error("PIXI3D: A resource loader is required when image is not embedded.");n.load(i.uri,(function(t){t.texture&&(t.texture.baseTexture.wrapMode=a.WRAP_MODES.REPEAT,r.images[o]=t.texture)}))}};for(i=0;i<e.images.length;i++)u(i);return r},t.isValid=function(t){var e=new Uint32Array(t,0,3);return 1179937895===e[0]&&2===e[1]},t.fromBuffer=function(e,n){for(var r=[],o=12;o<e.byteLength;){var i=new Uint32Array(e,o,3);r.push({length:i[0],type:i[1],offset:o+8}),o+=i[0]+8}for(var u=new Uint8Array(e,r[0].offset,r[0].length),s=JSON.parse(new TextDecoder("utf-8").decode(u)),c=[],f=1;f<r.length;f++)c.push(e.slice(r[f].offset,r[f].offset+r[f].length));s.images&&0!==s.images.length||n(new t(s,c));var l=[],d=function(e){var r=s.images[e];if(void 0===r.bufferView)return"continue";var o=s.bufferViews[r.bufferView],i=c[o.buffer],u=new Uint8Array(i,o.byteOffset,o.byteLength),f=new Blob([u],{type:r.mimeType}),d=new FileReader;d.onload=function(){l[e]=a.Texture.from(d.result),l[e].baseTexture.wrapMode=a.WRAP_MODES.REPEAT,l.length===s.images.length&&n(new t(s,c,l))},d.readAsDataURL(f)};for(f=0;s.images&&f<s.images.length;f++)d(f)},t.isEmbeddedResource=function(t){return t.startsWith("data:")},t.getEmbeddedBuffer=function(t){return Uint8Array.from(atob(t.split(",")[1]),(function(t){return t.charCodeAt(0)})).buffer},t}();e.glTFAsset=u},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ObservablePoint3D=void 0;var s=function(t){function e(e,n,r,o,i){void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0);var a=t.call(this,e,n)||this;return a._array=new Float32Array(3),a._array.set([r,o,i]),a}return o(e,t),Object.defineProperty(e.prototype,"array",{get:function(){return this._array},set:function(t){this.setFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]!==t&&(this._array[0]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]!==t&&(this._array[1]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]!==t&&(this._array[2]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),e.prototype.clone=function(t,n){return void 0===t&&(t=this.cb),void 0===n&&(n=this.scope),new e(t,n,this.x,this.y,this.z)},e.prototype.copyFrom=function(t){return this._array[0]===t.x&&this._array[1]===t.y&&this._array[2]===t.z||(this._array[0]=t.x,this._array[1]=t.y,this._array[2]=t.z,this.cb.call(this.scope)),this},e.prototype.copyTo=function(t){return t instanceof e&&t.set(this.x,this.y,this.z),t},e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},e.prototype.set=function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=t),this._array[0]===t&&this._array[1]===e&&this._array[2]===n||(this._array[0]=t,this._array[1]=e,this._array[2]=n,this.cb.call(this.scope)),this},e.prototype.setFrom=function(t){return this.set(t[0],t[1],t[2]),this},e}(u(n(0)).ObservablePoint);e.ObservablePoint3D=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.TransformMatrix=void 0;var c=u(n(0)),f=n(4),l=n(2),d=n(30),h=n(31),p=n(3),_=function(t){function e(e){var n=t.call(this)||this;return n._transformId=0,n._array=e?new Float32Array(e):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n}return o(e,t),Object.defineProperty(e.prototype,"transformId",{get:function(){return this._transformId},enumerable:!1,configurable:!0}),e.prototype.toArray=function(){return this._array},Object.defineProperty(e.prototype,"position",{get:function(){var t=this;return this._position||(this._position=new h.MatrixComponent(this,3,(function(e){f.Mat4.getTranslation(t._array,e)}))),this._position.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){var t=this;return this._scaling||(this._scaling=new h.MatrixComponent(this,3,(function(e){f.Mat4.getScaling(t._array,e)}))),this._scaling.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){var t=this;if(!this._rotation){var e=new Float32Array(16);this._rotation=new h.MatrixComponent(this,4,(function(n){var r,o;try{for(var i=s([0,1,2]),a=i.next();!a.done;a=i.next()){var u=a.value;e[u+0]=t._array[u+0]/t.scaling[0],e[u+4]=t._array[u+4]/t.scaling[1],e[u+8]=t._array[u+8]/t.scaling[2]}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}p.Quat.normalize(f.Mat4.getRotation(e,n),n)}))}return this._rotation.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){var t=this;return this._up||(this._up=new h.MatrixComponent(this,3,(function(e){l.Vec3.normalize(l.Vec3.set(t._array[4],t._array[5],t._array[6],e),e)}))),this._up.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"down",{get:function(){var t=this;return this._down||(this._down=new h.MatrixComponent(this,3,(function(e){l.Vec3.negate(t.up,e)}))),this._down.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){var t=this;return this._right||(this._right=new h.MatrixComponent(this,3,(function(e){l.Vec3.negate(t.left,e)}))),this._right.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){var t=this;return this._left||(this._left=new h.MatrixComponent(this,3,(function(e){l.Vec3.normalize(l.Vec3.cross(t.up,t.forward,e),e)}))),this._left.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forward",{get:function(){var t=this;return this._forward||(this._forward=new h.MatrixComponent(this,3,(function(e){l.Vec3.normalize(l.Vec3.set(t._array[8],t._array[9],t._array[10],e),e)}))),this._forward.array},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backward",{get:function(){var t=this;return this._backward||(this._backward=new h.MatrixComponent(this,3,(function(e){l.Vec3.negate(t.forward,e)}))),this._backward.array},enumerable:!1,configurable:!0}),e.prototype.copyFrom=function(t){return t instanceof e&&(f.Mat4.copy(t._array,this._array),this._transformId++),this},e.prototype.setFromRotationPositionScale=function(t,e,n){d.Vec4.set(t.x,t.y,t.z,t.w,this.rotation),l.Vec3.set(n.x,n.y,n.z,this.scaling),l.Vec3.set(e.x,e.y,e.z,this.position),f.Mat4.fromRotationTranslationScale(this.rotation,this.position,this.scaling,this._array),this._transformId++},e.prototype.setFromMultiply=function(t,e){f.Mat4.multiply(t._array,e._array,this._array),this._transformId++},e}(c.Matrix);e.TransformMatrix=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterialAlphaMode=void 0,function(t){t.opaque="opaque",t.mask="mask",t.blend="blend"}(e.StandardMaterialAlphaMode||(e.StandardMaterialAlphaMode={}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterialMatrixTexture=void 0;var s=u(n(0)),c=n(22),f=n(7),l=function(t){function e(e){var n=this,r=new Float32Array(16*e),o=new c.BufferResource(r,{width:4,height:e});return(n=t.call(this,new s.BaseTexture(o,{mipmap:s.MIPMAP_MODES.OFF,wrapMode:s.WRAP_MODES.CLAMP,scaleMode:s.SCALE_MODES.NEAREST,format:s.FORMATS.RGBA,type:s.TYPES.FLOAT,alphaMode:s.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA}))||this)._buffer=r,n}return o(e,t),e.isSupported=function(t){return f.Platform.isFloatTextureSupported(t)},e.prototype.updateBuffer=function(t){for(var e=0;e<t.length;e++)this._buffer[e]=(t[e]+1)/2;this.baseTexture.resource.update()},e}(s.Texture);e.StandardMaterialMatrixTexture=l},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferResource=void 0;var a=i(n(0));e.BufferResource=a.BufferResource||a.resources.BufferResource},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;var a=i(n(0)),u=n(16),s=function(){function t(){this.state=Object.assign(new a.State,{culling:!0,clockwiseFrontFace:!1,depthTest:!0}),this.drawMode=a.DRAW_MODES.TRIANGLES,this.renderSortType=u.MaterialRenderSortType.opaque}return Object.defineProperty(t.prototype,"doubleSided",{get:function(){return!this.state.culling},set:function(t){this.state.culling=!t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){},Object.defineProperty(t.prototype,"isInstancingSupported",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.createInstance=function(){},t.prototype.render=function(t,e){(this._shader||(this._shader=this.createShader(t,e),this._shader))&&(this.updateUniforms&&this.updateUniforms(t,this._shader),this._shader.render(t,e,this.state,this.drawMode))},t}();e.Material=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var i=n(59),a=n(1),u=n(72),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animations=[],e.meshes=[],e}return o(e,t),e.from=function(t,e){return i.glTFParser.createModel(t,e)},e.prototype.createInstance=function(){return u.InstancedModel.from(this)},e}(a.Container3D);e.Model=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowShader=void 0;var s=u(n(0)),c=n(8),f=n(34),l=function(t){function e(e,r){void 0===r&&(r=[]);var o=n(81),i=n(82);return t.call(this,s.Program.from(f.StandardShaderSource.build(o,r,e),f.StandardShaderSource.build(i,r,e)))||this}return o(e,t),e.prototype.createShaderGeometry=function(t){var e=new s.Geometry;return t.indices&&(1===t.indices.buffer.BYTES_PER_ELEMENT?e.addIndex(new s.Buffer(new Uint16Array(t.indices.buffer))):e.addIndex(new s.Buffer(t.indices.buffer))),t.positions&&e.addAttribute("a_Position",new s.Buffer(t.positions.buffer),3,!1,t.positions.componentType,t.positions.stride),e},Object.defineProperty(e.prototype,"name",{get:function(){return"shadow-shader"},enumerable:!1,configurable:!0}),e.prototype.updateUniforms=function(t,e){this.uniforms.u_ModelMatrix=t.worldTransform.toArray(),this.uniforms.u_ViewProjectionMatrix=e.lightViewProjection},e}(c.MeshShader);e.ShadowShader=l},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Cubemap=void 0;var s=u(n(0)),c=n(86),f=n(89),l=n(22),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e,"faces",{get:function(){return["posx","negx","posy","negy","posz","negz"]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){return this.resource.levels},enumerable:!1,configurable:!0}),e.fromFaces=function(t){var n=Array.isArray(t)?t:[t],r=e.faces.map((function(t,e){return new c.MipmapResource(n.map((function(e){return e[t]})),s.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+e)}));return new e(new f.CubemapResource(r,n.length))},e.fromColors=function(t,n,r,o,i,a){void 0===n&&(n=t),void 0===r&&(r=t),void 0===o&&(o=t),void 0===i&&(i=t),void 0===a&&(a=t);for(var u=[],d=[t,n,r,o,i,a],h=0;h<d.length;h++){var p=new l.BufferResource(new Uint8Array(d[h].rgba.map((function(t){return 255*t}))),{width:1,height:1}),_=new s.Texture(new s.BaseTexture(p,{type:s.TYPES.UNSIGNED_BYTE,format:s.FORMATS.RGB,alphaMode:s.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA}));u.push(new c.MipmapResource([_],s.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+h))}return new e(new f.CubemapResource(u,1))},e}(s.BaseTexture);e.Cubemap=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowQuality=void 0,function(t){t.low="low",t.medium="medium",t.high="high"}(e.ShadowQuality||(e.ShadowQuality={}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ObservableQuaternion=void 0;var s=u(n(0)),c=n(3),f=function(t){function e(e,n,r,o,i,a){void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=1);var u=t.call(this,e,n)||this;return u._array=new Float32Array(4),u._array.set([r,o,i,a]),u}return o(e,t),Object.defineProperty(e.prototype,"array",{get:function(){return this._array},set:function(t){this.setFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._array[0]},set:function(t){this._array[0]!==t&&(this._array[0]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._array[1]},set:function(t){this._array[1]!==t&&(this._array[1]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._array[2]},set:function(t){this._array[2]!==t&&(this._array[2]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._array[3]},set:function(t){this._array[3]!==t&&(this._array[3]=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),e.prototype.setEulerAngles=function(t,e,n){c.Quat.fromEuler(t,e,n,this._array),this.cb.call(this.scope)},e.prototype.clone=function(t,n){return void 0===t&&(t=this.cb),void 0===n&&(n=this.scope),new e(t,n,this.x,this.y,this.z,this.w)},e.prototype.copyFrom=function(t){return this._array[0]===t.x&&this._array[1]===t.y&&this._array[2]===t.z&&this._array[3]===t.w||(this._array[0]=t.x,this._array[1]=t.y,this._array[2]=t.z,this._array[3]=t.w,this.cb.call(this.scope)),this},e.prototype.copyTo=function(t){return t instanceof e&&t.set(this.x,this.y,this.z,this.w),t},e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},e.prototype.set=function(t,e,n,r){return void 0===e&&(e=t),void 0===n&&(n=t),void 0===r&&(r=t),this._array[0]===t&&this._array[1]===e&&this._array[2]===n&&this._array[3]===r||(this._array[0]=t,this._array[1]=e,this._array[2]=n,this._array[3]=r,this.cb.call(this.scope)),this},e.prototype.setFrom=function(t){return this.set(t[0],t[1],t[2],t[3]),this},e}(s.ObservablePoint);e.ObservableQuaternion=f},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Transform3D=void 0;var s=u(n(0)),c=n(19),f=n(18),l=n(28),d=n(4),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.position=new f.ObservablePoint3D(e.onChange,e,0,0,0),e.scale=new f.ObservablePoint3D(e.onChange,e,1,1,1),e.rotationQuaternion=new l.ObservableQuaternion(e.onChange,e,0,0,0,1),e.worldTransform=new c.TransformMatrix,e.localTransform=new c.TransformMatrix,e.inverseWorldTransform=new c.TransformMatrix,e.normalTransform=new c.TransformMatrix,e}return o(e,t),e.prototype.updateLocalTransform=function(){this._localID!==this._currentLocalID&&(this.localTransform.setFromRotationPositionScale(this.rotationQuaternion,this.position,this.scale),this._parentID=-1,this._currentLocalID=this._localID)},e.prototype.setFromMatrix=function(t){this.localTransform.copyFrom(t),this.position.set(this.localTransform.position[0],this.localTransform.position[1],this.localTransform.position[2]),this.scale.set(this.localTransform.scaling[0],this.localTransform.scaling[1],this.localTransform.scaling[2]),this.rotationQuaternion.set(this.localTransform.rotation[0],this.localTransform.rotation[1],this.localTransform.rotation[2],this.localTransform.rotation[3])},e.prototype.updateTransform=function(t){this.updateLocalTransform(),t&&this._parentID===t._worldID||(t instanceof e?this.worldTransform.setFromMultiply(t.worldTransform,this.localTransform):this.worldTransform.copyFrom(this.localTransform),d.Mat4.invert(this.worldTransform.toArray(),this.inverseWorldTransform.toArray()),d.Mat4.transpose(this.inverseWorldTransform.toArray(),this.normalTransform.toArray()),this._worldID++,t&&(this._parentID=t._worldID))},e}(s.Transform);e.Transform3D=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vec4=void 0;var r=n(14),o=function(){function t(){}return t.set=function(t,e,n,o,i){return r.vec4.set(i,t,e,n,o)},t.transformMat4=function(t,e,n){return r.vec4.transformMat4(n,t,e)},t}();e.Vec4=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MatrixComponent=void 0;var r=function(){function t(t,e,n){this._parent=t,this._update=n,this._array=new Float32Array(e)}return Object.defineProperty(t.prototype,"array",{get:function(){return this._id!==this._parent.transformId&&(this._update(this._array),this._id=this._parent.transformId),this._array},enumerable:!1,configurable:!0}),t}();e.MatrixComponent=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ray=void 0;var r=n(2),o=function(){function t(t,e){this._direction=new Float32Array(3),this._origin=new Float32Array(3),r.Vec3.copy(t,this._origin),r.Vec3.normalize(e,this._direction)}return Object.defineProperty(t.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},enumerable:!1,configurable:!0}),t.prototype.getPoint=function(t,e){return void 0===e&&(e=new Float32Array(3)),r.Vec3.add(this._origin,r.Vec3.scale(this._direction,t,e),e)},t}();e.Ray=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterialDebugMode=void 0,function(t){t.alpha="alpha",t.emissive="emissive",t.f0="f0",t.metallic="metallic",t.normal="normal",t.occlusion="occlusion",t.roughness="roughness"}(e.StandardMaterialDebugMode||(e.StandardMaterialDebugMode={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardShaderSource=void 0,function(t){t.build=function(t,e,n){return 1===n.context.webGLVersion&&(t=t.replace(/VERSION/,"100").replace(/VERT_IN/g,"attribute").replace(/VERT_OUT/g,"varying").replace(/FRAG_COLOR/g,"gl_FragColor").replace(/FRAG_IN/g,"varying")),2===n.context.webGLVersion&&(t=t.replace(/VERSION/,"300 es").replace(/VERT_IN/g,"in").replace(/VERT_OUT/g,"out").replace(/FRAG_COLOR/g,"g_finalColor").replace(/FRAG_IN/g,"in")),t.replace(/#define FEATURES/,e.map((function(t){return"#define "+t})).join("\n"))}}(e.StandardShaderSource||(e.StandardShaderSource={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.glTFMaterial=void 0;var r=function(){this.alphaCutoff=.5,this.alphaMode="OPAQUE",this.doubleSided=!1,this.roughness=1,this.metallic=1,this.emissive=[0,0,0],this.baseColor=[1,1,1,1],this.unlit=!1};e.glTFMaterial=r},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.LightingEnvironment=void 0;var u=i(n(0)),s=function(){function t(e,n){var r=this;this.renderer=e,this.lights=[],this.renderer.on("prerender",(function(){var t,e;try{for(var n=a(r.lights),o=n.next();!o.done;o=n.next()){var i=o.value;i.parent||i.transform.updateTransform()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}})),t.main||(t.main=this),this._imageBasedLighting=n}return Object.defineProperty(t.prototype,"imageBasedLighting",{get:function(){return this._imageBasedLighting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return!this._imageBasedLighting||this._imageBasedLighting.valid},enumerable:!1,configurable:!0}),t}();e.LightingEnvironment=s,u.Renderer.registerPlugin("lighting",s)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=void 0;var s=u(n(0)),c=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n.speed=1,n.loop=!1,n}return o(e,t),e.prototype.play=function(t){var e=this;void 0===t&&(t=s.Ticker.shared),this.position=0,this._ticker||(this._update=function(){e.update(t.deltaMS/1e3*e.speed)},this._ticker=t.add(this._update))},e.prototype.stop=function(){this._ticker&&this._update&&(this._ticker.remove(this._update),this._ticker=this._update=void 0)},e.prototype.update=function(t){this.position+=t,this.position<this.duration||(this.loop?this.position>this.duration&&(this.position=this.position%this.duration):(this.position=this.duration,this.stop()),this.emit("complete"))},e}(s.utils.EventEmitter);e.Animation=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Skin=void 0;var r=n(4),o=function(){function t(t,e){this.parent=t,this.joints=e,this._arrayVertexMatrices=[],this._arrayNormalMatrices=[],this._jointVertexMatrices=new Float32Array(16*e.length),this._jointNormalMatrices=new Float32Array(16*e.length);for(var n=0;n<e.length;n++)this._arrayVertexMatrices.push(new Float32Array(this._jointVertexMatrices.buffer,64*n,16)),this._arrayNormalMatrices.push(new Float32Array(this._jointNormalMatrices.buffer,64*n,16))}return t.prototype.calculateJointMatrices=function(){for(var t=0;t<this.joints.length;t++)r.Mat4.multiply(this.joints[t].node.worldTransform.toArray(),this.joints[t].inverseBindMatrix,this._arrayVertexMatrices[t]),r.Mat4.multiply(this.parent.transform.inverseWorldTransform.toArray(),this._arrayVertexMatrices[t],this._arrayVertexMatrices[t]),r.Mat4.invert(this._arrayVertexMatrices[t],this._arrayNormalMatrices[t]),r.Mat4.transpose(this._arrayNormalMatrices[t],this._arrayNormalMatrices[t]);return{jointVertexMatrices:this._jointVertexMatrices,jointNormalMatrices:this._jointNormalMatrices}},t}();e.Skin=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Joint=void 0;var r=function(t,e){this.node=t,this.inverseBindMatrix=e};e.Joint=r},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.MaterialRenderPass=void 0;var o=n(11),i=function(){function t(t,e){this.renderer=t,this.name=e,this.clearColor=new o.Color(0,0,0,0)}return Object.defineProperty(t.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){this._renderTexture=t},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this._renderTexture&&this.clearColor&&(this.renderer.renderTexture.bind(this._renderTexture),this.renderer.renderTexture.clear(Array.from(this.clearColor.rgba)),this.renderer.renderTexture.bind(void 0))},t.prototype.render=function(t){var e,n;this._renderTexture&&this.renderer.renderTexture.bind(this._renderTexture);try{for(var o=r(t),i=o.next();!i.done;i=o.next()){var a=i.value;a.material&&a.material.render(a,this.renderer)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}this._renderTexture&&this.renderer.renderTexture.bind(void 0)},t}();e.MaterialRenderPass=i},function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowRenderPass=void 0;var o=n(77),i=n(80),a=function(){function t(t,e){void 0===e&&(e="shadow"),this.renderer=t,this.name=e,this._lights=[],this._filter=new o.ShadowFilter(t),this._shadow=new i.ShadowRenderer(t)}return t.prototype.addShadowCastingLight=function(t){this._lights.indexOf(t)<0&&this._lights.push(t)},t.prototype.removeShadowCastingLight=function(t){var e=this._lights.indexOf(t);e>=0&&this._lights.splice(e,1)},t.prototype.clear=function(){var t,e;try{for(var n=r(this._lights),o=n.next();!o.done;o=n.next()){o.value.clear()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.render=function(t){var e,n,o,i;try{for(var a=r(this._lights),u=a.next();!u.done;u=a.next()){var s=u.value;this.renderer.renderTexture.bind(s.shadowTexture),s.updateLightViewProjection();try{for(var c=(o=void 0,r(t)),f=c.next();!f.done;f=c.next()){var l=f.value;this._shadow.render(l,s)}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}this.renderer.renderTexture.bind(void 0),s.softness>0&&this._filter.applyGaussianBlur(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}},t}();e.ShadowRenderPass=a},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.PostProcessingSprite=void 0;var s=u(n(0)),c=function(t){function e(e,n){var r=t.call(this)||this;r._fxaa=new s.filters.FXAAFilter;var o=n||{},i=o.width,a=void 0===i?512:i,u=o.height,c=void 0===u?512:u;return r._renderTexture=s.RenderTexture.create({width:a,height:c}),r._renderTexture.rotate=8,r._renderTexture.baseTexture.framebuffer.addDepthTexture(),r._fxaa.enabled=!1,r.texture=r._renderTexture,r.filters=[r._fxaa],n&&n.width&&n.height||e.on("prerender",(function(){r._renderTexture.resize(e.width,e.height)})),r}return o(e,t),Object.defineProperty(e.prototype,"renderTexture",{get:function(){return this._renderTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTexture",{get:function(){if(this._renderTexture)return this._renderTexture.baseTexture.framebuffer.depthTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fxaa",{get:function(){return this._fxaa},enumerable:!1,configurable:!0}),e}(s.Sprite);e.PostProcessingSprite=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Color=e.Quat=e.Mat4=e.Vec3=e.Plane=e.Ray=e.PostProcessingSprite=e.ShadowQuality=e.ShadowCastingLight=e.ShadowRenderPass=e.Joint=e.Skin=e.PickingManager=e.PickingHitArea=e.StandardMaterialDebugMode=e.StandardMaterialAlphaMode=e.StandardMaterial=e.Skybox=e.ShaderSourceLoader=e.Cubemap=e.CubemapLoader=e.MaterialRenderSortType=e.Material=e.MaterialRenderPass=e.StandardPipeline=e.ImageBasedLighting=e.LightingEnvironment=e.Light=e.LightType=e.Animation=e.Model=e.MeshShader=e.MeshGeometry3D=e.Mesh3D=e.CameraOrbitControl=e.Camera=e.Container3D=e.TransformMatrix=e.Transform3D=e.ObservableQuaternion=e.ObservablePoint3D=e.glTFAsset=e.glTFBinaryLoader=e.glTFLoader=void 0;var r=n(44);Object.defineProperty(e,"glTFLoader",{enumerable:!0,get:function(){return r.glTFLoader}});var o=n(45);Object.defineProperty(e,"glTFBinaryLoader",{enumerable:!0,get:function(){return o.glTFBinaryLoader}});var i=n(17);Object.defineProperty(e,"glTFAsset",{enumerable:!0,get:function(){return i.glTFAsset}});var a=n(18);Object.defineProperty(e,"ObservablePoint3D",{enumerable:!0,get:function(){return a.ObservablePoint3D}});var u=n(28);Object.defineProperty(e,"ObservableQuaternion",{enumerable:!0,get:function(){return u.ObservableQuaternion}});var s=n(29);Object.defineProperty(e,"Transform3D",{enumerable:!0,get:function(){return s.Transform3D}});var c=n(19);Object.defineProperty(e,"TransformMatrix",{enumerable:!0,get:function(){return c.TransformMatrix}});var f=n(1);Object.defineProperty(e,"Container3D",{enumerable:!0,get:function(){return f.Container3D}});var l=n(5);Object.defineProperty(e,"Camera",{enumerable:!0,get:function(){return l.Camera}});var d=n(46);Object.defineProperty(e,"CameraOrbitControl",{enumerable:!0,get:function(){return d.CameraOrbitControl}});var h=n(6);Object.defineProperty(e,"Mesh3D",{enumerable:!0,get:function(){return h.Mesh3D}});var p=n(9);Object.defineProperty(e,"MeshGeometry3D",{enumerable:!0,get:function(){return p.MeshGeometry3D}});var _=n(8);Object.defineProperty(e,"MeshShader",{enumerable:!0,get:function(){return _.MeshShader}});var m=n(24);Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return m.Model}});var v=n(37);Object.defineProperty(e,"Animation",{enumerable:!0,get:function(){return v.Animation}});var y=n(10);Object.defineProperty(e,"LightType",{enumerable:!0,get:function(){return y.LightType}});var g=n(73);Object.defineProperty(e,"Light",{enumerable:!0,get:function(){return g.Light}});var b=n(36);Object.defineProperty(e,"LightingEnvironment",{enumerable:!0,get:function(){return b.LightingEnvironment}});var M=n(74);Object.defineProperty(e,"ImageBasedLighting",{enumerable:!0,get:function(){return M.ImageBasedLighting}});var T=n(76);Object.defineProperty(e,"StandardPipeline",{enumerable:!0,get:function(){return T.StandardPipeline}});var S=n(40);Object.defineProperty(e,"MaterialRenderPass",{enumerable:!0,get:function(){return S.MaterialRenderPass}});var O=n(23);Object.defineProperty(e,"Material",{enumerable:!0,get:function(){return O.Material}});var A=n(16);Object.defineProperty(e,"MaterialRenderSortType",{enumerable:!0,get:function(){return A.MaterialRenderSortType}});var x=n(85);Object.defineProperty(e,"CubemapLoader",{enumerable:!0,get:function(){return x.CubemapLoader}});var w=n(26);Object.defineProperty(e,"Cubemap",{enumerable:!0,get:function(){return w.Cubemap}});var P=n(91);Object.defineProperty(e,"ShaderSourceLoader",{enumerable:!0,get:function(){return P.ShaderSourceLoader}});var E=n(92);Object.defineProperty(e,"Skybox",{enumerable:!0,get:function(){return E.Skybox}});var j=n(15);Object.defineProperty(e,"StandardMaterial",{enumerable:!0,get:function(){return j.StandardMaterial}});var R=n(20);Object.defineProperty(e,"StandardMaterialAlphaMode",{enumerable:!0,get:function(){return R.StandardMaterialAlphaMode}});var I=n(33);Object.defineProperty(e,"StandardMaterialDebugMode",{enumerable:!0,get:function(){return I.StandardMaterialDebugMode}});var C=n(96);Object.defineProperty(e,"PickingHitArea",{enumerable:!0,get:function(){return C.PickingHitArea}});var N=n(98);Object.defineProperty(e,"PickingManager",{enumerable:!0,get:function(){return N.PickingManager}});var L=n(38);Object.defineProperty(e,"Skin",{enumerable:!0,get:function(){return L.Skin}});var F=n(39);Object.defineProperty(e,"Joint",{enumerable:!0,get:function(){return F.Joint}});var U=n(41);Object.defineProperty(e,"ShadowRenderPass",{enumerable:!0,get:function(){return U.ShadowRenderPass}});var B=n(102);Object.defineProperty(e,"ShadowCastingLight",{enumerable:!0,get:function(){return B.ShadowCastingLight}});var V=n(27);Object.defineProperty(e,"ShadowQuality",{enumerable:!0,get:function(){return V.ShadowQuality}});var G=n(42);Object.defineProperty(e,"PostProcessingSprite",{enumerable:!0,get:function(){return G.PostProcessingSprite}});var D=n(32);Object.defineProperty(e,"Ray",{enumerable:!0,get:function(){return D.Ray}});var H=n(105);Object.defineProperty(e,"Plane",{enumerable:!0,get:function(){return H.Plane}});var k=n(2);Object.defineProperty(e,"Vec3",{enumerable:!0,get:function(){return k.Vec3}});var z=n(4);Object.defineProperty(e,"Mat4",{enumerable:!0,get:function(){return z.Mat4}});var W=n(3);Object.defineProperty(e,"Quat",{enumerable:!0,get:function(){return W.Quat}});var X=n(11);Object.defineProperty(e,"Color",{enumerable:!0,get:function(){return X.Color}})},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.glTFLoader=void 0;var a=i(n(0)),u=n(17);e.glTFLoader={use:function(t,e){if("gltf"!==t.extension)return e();Object.assign(t,{gltf:u.glTFAsset.load(t.data,new s(this,t))}),e()},add:function(){a.LoaderResource.setExtensionXhrType("bin",a.LoaderResource.XHR_RESPONSE_TYPE.BUFFER),a.LoaderResource.setExtensionXhrType("gltf",a.LoaderResource.XHR_RESPONSE_TYPE.JSON)}},a.Loader.registerPlugin(e.glTFLoader);var s=function(){function t(t,e){this._loader=t,this._resource=e}return t.prototype.load=function(t,e){var n=this._resource.url.substring(0,this._resource.url.lastIndexOf("/")+1)+t;if(this._loader.resources[n])if(this._loader.resources[n].data)e(this._loader.resources[n]);else var r=this._loader.onProgress.add((function(t,o){o.url===n&&(e(o),r.detach())}));else this._loader.add({parentResource:this._resource,url:n,onComplete:e})},t}()},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.glTFBinaryLoader=void 0;var a=i(n(0)),u=n(17);e.glTFBinaryLoader={use:function(t,e){if("glb"!==t.extension)return e();u.glTFAsset.isValid(t.data)&&u.glTFAsset.fromBuffer(t.data,(function(e){Object.assign(t,{gltf:e})})),e()},add:function(){a.LoaderResource.setExtensionXhrType("glb",a.LoaderResource.XHR_RESPONSE_TYPE.BUFFER)}},a.Loader.registerPlugin(e.glTFBinaryLoader)},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CameraOrbitControl=void 0;var a=i(n(0)),u=n(5),s=n(3),c=n(2),f=function(){function t(t,e){var n=this;void 0===e&&(e=u.Camera.main),this.camera=e,this._distance=5,this._grabbed=!1,this._angles=new a.ObservablePoint((function(){n._angles.x=Math.min(Math.max(-85,n._angles.x),85)}),void 0,0,180),this.target={x:0,y:0,z:0},this.allowControl=!0,this.camera.renderer.on("prerender",(function(){n.updateCamera()})),this.camera.renderer.plugins.interaction.on("mousedown",(function(t){t.stopped||(n._grabbed=!0)})),t.addEventListener("mouseup",(function(){n._grabbed=!1})),t.addEventListener("mousemove",(function(t){n.allowControl&&1===t.buttons&&n._grabbed&&(n._angles.x+=.5*t.movementY,n._angles.y-=.5*t.movementX)})),t.addEventListener("mousewheel",(function(t){n.allowControl&&(n.distance+=.01*t.deltaY,t.preventDefault())}))}return Object.defineProperty(t.prototype,"angles",{get:function(){return this._angles},enumerable:!1,configurable:!0}),t.prototype.updateCamera=function(){var t=s.Quat.fromEuler(this._angles.x,this._angles.y,0,new Float32Array(4)),e=c.Vec3.transformQuat(c.Vec3.set(0,0,1,new Float32Array(3)),t,new Float32Array(3)),n=c.Vec3.subtract(c.Vec3.set(this.target.x,this.target.y,this.target.z,new Float32Array(3)),c.Vec3.scale(e,this.distance,new Float32Array(3)),new Float32Array(3));this.camera.position.set(n[0],n[1],n[2]),this.camera.rotationQuaternion.set(t[0],t[1],t[2],t[3])},Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=Math.min(Math.max(t,.01),Number.MAX_SAFE_INTEGER)},enumerable:!1,configurable:!0}),t}();e.CameraOrbitControl=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlaneGeometry=void 0;var r=n(9);!function(t){t.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,0,1,1,0,-1,-1,0,-1,1,0,1])},indices:{buffer:new Uint8Array([0,1,2,0,3,1])},normals:{buffer:new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0])},uvs:[{buffer:new Float32Array([0,1,1,0,0,0,1,1])}]})}}(e.PlaneGeometry||(e.PlaneGeometry={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubeGeometry=void 0;var r=n(9);!function(t){t.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,1,1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,1,-1,1,1,-1,-1,1,1,1,1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,-1,-1,1,-1,1,1,1])},indices:{buffer:new Uint8Array([0,1,2,0,3,1,4,5,6,4,7,5,8,9,10,8,11,9,12,13,14,12,15,13,16,17,18,16,19,17,20,21,22,20,23,21])},normals:{buffer:new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0])},uvs:[{buffer:new Float32Array([.625,1,.375,.75,.375,1,.625,.75,.625,.75,.375,.5,.375,.75,.625,.5,.625,.5,.375,.25,.375,.5,.625,.25,.625,.25,.375,0,.375,.25,.625,0,.375,.25,.125,.5,.375,.5,.125,.25,.875,.25,.625,.5,.875,.5,.625,.25])}],tangents:{buffer:new Float32Array([0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,-1,0,0,1,-1,0,0,1,-1,0,0,1,-1,0,0,1])}})}}(e.CubeGeometry||(e.CubeGeometry={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterialFeatureSet=void 0;var r=n(20),o=n(33),i=n(7),a=n(21),u=n(50);!function(t){t.build=function(t,e,n,s,c){var f=[];if(e.instances.length>0&&f.push("USE_INSTANCING 1"),1===t.context.webGLVersion&&f.push("WEBGL1 1"),2===t.context.webGLVersion&&f.push("WEBGL2 1"),n.normals&&f.push("HAS_NORMALS 1"),n.uvs&&f.push("HAS_UV_SET1 1"),n.tangents&&f.push("HAS_TANGENTS 1"),n.targets){for(var l=0;l<n.targets.length;l++)n.targets[l].positions&&f.push("HAS_TARGET_POSITION"+l),n.targets[l].normals&&f.push("HAS_TARGET_NORMAL"+l),n.targets[l].tangents&&f.push("HAS_TARGET_TANGENT"+l);e.morphWeights&&(f.push("WEIGHT_COUNT "+e.morphWeights.length),f.push("USE_MORPHING 1"))}if(n.joints&&f.push("HAS_JOINT_SET1 1"),n.weights&&f.push("HAS_WEIGHT_SET1 1"),e.skin&&(!function(t,e){var n=i.Platform.getMaxVertexUniformVectors(e)-25;return t>Math.floor(n/8)}(e.skin.joints.length,t)?f.push("USE_SKINNING 1"):a.StandardMaterialMatrixTexture.isSupported(t)?(f.push("USE_SKINNING 1"),f.push("USE_SKINNING_TEXTURE 1")):u.Console.error("PIXI3D: Mesh contains "+e.skin.joints.length+" joints, which is more than supported on this device. Skinning will be disabled and result may not be as expected."),f.push("JOINT_COUNT "+e.skin.joints.length)),s.unlit&&f.push("MATERIAL_UNLIT 1"),f.push("MATERIAL_METALLICROUGHNESS 1"),c.lights.length>0&&(f.push("LIGHT_COUNT "+c.lights.length),f.push("USE_PUNCTUAL 1")),c.imageBasedLighting){if(!c.imageBasedLighting.valid)return;i.Platform.isShaderTextureLodSupported(t)&&f.push("USE_TEX_LOD 1"),f.push("USE_IBL 1")}if(s.shadowCastingLight&&f.push("USE_SHADOW_MAPPING 1"),s.baseColorTexture){if(!s.baseColorTexture.valid)return;s.baseColorTexture.uvTransform&&f.push("HAS_BASECOLOR_UV_TRANSFORM 1"),f.push("HAS_BASE_COLOR_MAP 1")}if(s.emissiveTexture){if(!s.emissiveTexture.valid)return;s.emissiveTexture.uvTransform&&f.push("HAS_EMISSIVE_UV_TRANSFORM 1"),f.push("HAS_EMISSIVE_MAP 1")}if(s.normalTexture){if(!s.normalTexture.valid)return;s.normalTexture.uvTransform&&f.push("HAS_NORMAL_UV_TRANSFORM 1"),f.push("HAS_NORMAL_MAP 1")}if(s.metallicRoughnessTexture){if(!s.metallicRoughnessTexture.valid)return;s.metallicRoughnessTexture.uvTransform&&f.push("HAS_METALLICROUGHNESS_UV_TRANSFORM 1"),f.push("HAS_METALLIC_ROUGHNESS_MAP 1")}if(s.occlusionTexture){if(!s.occlusionTexture.valid)return;s.occlusionTexture.uvTransform&&f.push("HAS_OCCLUSION_UV_TRANSFORM 1"),f.push("HAS_OCCLUSION_MAP 1")}switch(s.alphaMode){case r.StandardMaterialAlphaMode.opaque:f.push("ALPHAMODE_OPAQUE 1");break;case r.StandardMaterialAlphaMode.mask:f.push("ALPHAMODE_MASK 1")}switch(s.debugMode&&f.push("DEBUG_OUTPUT 1"),s.debugMode){case o.StandardMaterialDebugMode.alpha:f.push("DEBUG_ALPHA 1");break;case o.StandardMaterialDebugMode.emissive:f.push("DEBUG_EMISSIVE 1");break;case o.StandardMaterialDebugMode.f0:f.push("DEBUG_F0 1");break;case o.StandardMaterialDebugMode.metallic:f.push("DEBUG_METALLIC 1");break;case o.StandardMaterialDebugMode.normal:f.push("DEBUG_NORMAL 1");break;case o.StandardMaterialDebugMode.occlusion:f.push("DEBUG_OCCLUSION 1");break;case o.StandardMaterialDebugMode.roughness:f.push("DEBUG_ROUGHNESS 1")}return f},t.hasSkinningTextureFeature=function(t){return t.includes("USE_SKINNING_TEXTURE 1")}}(e.StandardMaterialFeatureSet||(e.StandardMaterialFeatureSet={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0,function(t){var e=[];t.error=function(t){e.includes(t)||(e.push(t),console.error(t))}}(e.Console||(e.Console={}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardShader=void 0;var s=u(n(0)),c=n(8),f=n(52),l=n(34),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._instancing=new f.StandardShaderInstancing,e}return o(e,t),e.build=function(t,r){var o=n(53),i=n(54);return new e(s.Program.from(l.StandardShaderSource.build(o,r,t),l.StandardShaderSource.build(i,r,t)))},Object.defineProperty(e.prototype,"name",{get:function(){return"standard-shader"},enumerable:!1,configurable:!0}),e.prototype.createShaderGeometry=function(e,n){var r=t.prototype.createShaderGeometry.call(this,e,n);if(n&&this._instancing.addGeometryAttributes(r),e.targets)for(var o=0;o<e.targets.length;o++){var i=e.targets[o].positions;i&&r.addAttribute("a_Target_Position"+o,new s.Buffer(i.buffer),3,!1,i.componentType,i.stride);var a=e.targets[o].normals;a&&r.addAttribute("a_Target_Normal"+o,new s.Buffer(a.buffer),3,!1,a.componentType,a.stride);var u=e.targets[o].tangents;u&&r.addAttribute("a_Target_Tangent"+o,new s.Buffer(u.buffer),3,!1,u.componentType,u.stride)}return e.joints&&r.addAttribute("a_Joint1",new s.Buffer(e.joints.buffer),4,!1,e.joints.componentType,e.joints.stride),e.weights&&r.addAttribute("a_Weight1",new s.Buffer(e.weights.buffer),4,!1,e.weights.componentType,e.weights.stride),r},e.prototype.render=function(e,n,r,o){e.instances.length>0&&this._instancing.updateBuffers(e.instances),t.prototype.render.call(this,e,n,r,o)},e}(c.MeshShader);e.StandardShader=d},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardShaderInstancing=void 0;var a=i(n(0)),u=function(){function t(){this._maxInstances=200,this._modelMatrix=[new a.Buffer,new a.Buffer,new a.Buffer,new a.Buffer],this._normalMatrix=[new a.Buffer,new a.Buffer,new a.Buffer,new a.Buffer],this._baseColor=new a.Buffer,this.expandBuffers(this._maxInstances)}return t.prototype.expandBuffers=function(t){for(;t>this._maxInstances;)this._maxInstances+=Math.floor(.5*this._maxInstances);for(var e=0;e<4;e++)this._modelMatrix[e].update(new Float32Array(4*this._maxInstances)),this._normalMatrix[e].update(new Float32Array(4*this._maxInstances));this._baseColor.update(new Float32Array(4*this._maxInstances))},t.prototype.updateBuffers=function(t){t.length>this._maxInstances&&this.expandBuffers(t.length);for(var e=0,n=0;n<t.length;n++)if(t[n].worldVisible&&t[n].renderable){for(var r=t[n].transform.normalTransform.toArray(),o=0;o<4;o++)this._normalMatrix[o].data.set(r.slice(4*o,4*o+4),4*e);var i=t[n].worldTransform.toArray();for(o=0;o<4;o++)this._modelMatrix[o].data.set(i.slice(4*o,4*o+4),4*e);var a=t[n].material;this._baseColor.data.set(a.baseColor.rgba,4*e),e++}for(n=0;n<4;n++)this._modelMatrix[n].update(),this._normalMatrix[n].update();this._baseColor.update()},t.prototype.addGeometryAttributes=function(t){for(var e=0;e<4;e++)t.addAttribute("a_ModelMatrix"+e,this._modelMatrix[e],4,!1,void 0,0,void 0,!0);for(e=0;e<4;e++)t.addAttribute("a_NormalMatrix"+e,this._normalMatrix[e],4,!1,void 0,0,void 0,!0);t.addAttribute("a_BaseColorFactor",this._baseColor,4,!1,void 0,0,void 0,!0)},t}();e.StandardShaderInstancing=u},function(t,e){t.exports="#version VERSION\n\n#define FEATURES\n\nvec4 _texture(sampler2D sampler, vec2 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return texture2D(sampler, coord);\n#endif\n}\n\nvec4 _texture(samplerCube sampler, vec3 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return textureCube(sampler, coord);\n#endif\n}\n#ifdef HAS_TARGET_POSITION0\nVERT_IN vec3 a_Target_Position0;\n#endif\n\n#ifdef HAS_TARGET_POSITION1\nVERT_IN vec3 a_Target_Position1;\n#endif\n\n#ifdef HAS_TARGET_POSITION2\nVERT_IN vec3 a_Target_Position2;\n#endif\n\n#ifdef HAS_TARGET_POSITION3\nVERT_IN vec3 a_Target_Position3;\n#endif\n\n#ifdef HAS_TARGET_POSITION4\nVERT_IN vec3 a_Target_Position4;\n#endif\n\n#ifdef HAS_TARGET_POSITION5\nVERT_IN vec3 a_Target_Position5;\n#endif\n\n#ifdef HAS_TARGET_POSITION6\nVERT_IN vec3 a_Target_Position6;\n#endif\n\n#ifdef HAS_TARGET_POSITION7\nVERT_IN vec3 a_Target_Position7;\n#endif\n\n#ifdef HAS_TARGET_NORMAL0\nVERT_IN vec3 a_Target_Normal0;\n#endif\n\n#ifdef HAS_TARGET_NORMAL1\nVERT_IN vec3 a_Target_Normal1;\n#endif\n\n#ifdef HAS_TARGET_NORMAL2\nVERT_IN vec3 a_Target_Normal2;\n#endif\n\n#ifdef HAS_TARGET_NORMAL3\nVERT_IN vec3 a_Target_Normal3;\n#endif\n\n#ifdef HAS_TARGET_TANGENT0\nVERT_IN vec3 a_Target_Tangent0;\n#endif\n\n#ifdef HAS_TARGET_TANGENT1\nVERT_IN vec3 a_Target_Tangent1;\n#endif\n\n#ifdef HAS_TARGET_TANGENT2\nVERT_IN vec3 a_Target_Tangent2;\n#endif\n\n#ifdef HAS_TARGET_TANGENT3\nVERT_IN vec3 a_Target_Tangent3;\n#endif\n\n#ifdef USE_MORPHING\nuniform float u_morphWeights[WEIGHT_COUNT];\n#endif\n\n#ifdef HAS_JOINT_SET1\nVERT_IN vec4 a_Joint1;\n#endif\n\n#ifdef HAS_JOINT_SET2\nVERT_IN vec4 a_Joint2;\n#endif\n\n#ifdef HAS_WEIGHT_SET1\nVERT_IN vec4 a_Weight1;\n#endif\n\n#ifdef HAS_WEIGHT_SET2\nVERT_IN vec4 a_Weight2;\n#endif\n\n#ifdef USE_SKINNING\n#ifdef USE_SKINNING_TEXTURE\nuniform sampler2D u_jointMatrixSampler;\nuniform sampler2D u_jointNormalMatrixSampler;\n#else\nuniform mat4 u_jointMatrix[JOINT_COUNT];\nuniform mat4 u_jointNormalMatrix[JOINT_COUNT];\n#endif\n#endif\n\n// these offsets assume the texture is 4 pixels across\n#define ROW0_U ((0.5 + 0.0) / 4.0)\n#define ROW1_U ((0.5 + 1.0) / 4.0)\n#define ROW2_U ((0.5 + 2.0) / 4.0)\n#define ROW3_U ((0.5 + 3.0) / 4.0)\n\n#ifdef USE_SKINNING\nmat4 getJointMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\n    return mat4(\n        _texture(u_jointMatrixSampler, vec2(ROW0_U, v)) * 2.0 - 1.0,\n        _texture(u_jointMatrixSampler, vec2(ROW1_U, v)) * 2.0 - 1.0,\n        _texture(u_jointMatrixSampler, vec2(ROW2_U, v)) * 2.0 - 1.0,\n        _texture(u_jointMatrixSampler, vec2(ROW3_U, v)) * 2.0 - 1.0\n    );\n    #else\n    return u_jointMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getJointNormalMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(JOINT_COUNT);\n    return mat4(\n        _texture(u_jointNormalMatrixSampler, vec2(ROW0_U, v)) * 2.0 - 1.0,\n        _texture(u_jointNormalMatrixSampler, vec2(ROW1_U, v)) * 2.0 - 1.0,\n        _texture(u_jointNormalMatrixSampler, vec2(ROW2_U, v)) * 2.0 - 1.0,\n        _texture(u_jointNormalMatrixSampler, vec2(ROW3_U, v)) * 2.0 - 1.0\n    );\n    #else\n    return u_jointNormalMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getSkinningMatrix()\n{\n    mat4 skin = mat4(0);\n\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\n    skin +=\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\n    #endif\n\n    return skin;\n}\n\nmat4 getSkinningNormalMatrix()\n{\n    mat4 skin = mat4(0);\n\n    #if defined(HAS_WEIGHT_SET1) && defined(HAS_JOINT_SET1)\n    skin +=\n        a_Weight1.x * getJointNormalMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointNormalMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointNormalMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointNormalMatrix(a_Joint1.w);\n    #endif\n\n    return skin;\n}\n#endif // !USE_SKINNING\n\n#ifdef USE_MORPHING\nvec4 getTargetPosition()\n{\n    vec4 pos = vec4(0);\n\n#ifdef HAS_TARGET_POSITION0\n    pos.xyz += u_morphWeights[0] * a_Target_Position0;\n#endif\n\n#ifdef HAS_TARGET_POSITION1\n    pos.xyz += u_morphWeights[1] * a_Target_Position1;\n#endif\n\n#ifdef HAS_TARGET_POSITION2\n    pos.xyz += u_morphWeights[2] * a_Target_Position2;\n#endif\n\n#ifdef HAS_TARGET_POSITION3\n    pos.xyz += u_morphWeights[3] * a_Target_Position3;\n#endif\n\n#ifdef HAS_TARGET_POSITION4\n    pos.xyz += u_morphWeights[4] * a_Target_Position4;\n#endif\n\n    return pos;\n}\n\nvec4 getTargetNormal()\n{\n    vec4 normal = vec4(0);\n\n#ifdef HAS_TARGET_NORMAL0\n    normal.xyz += u_morphWeights[0] * a_Target_Normal0;\n#endif\n\n#ifdef HAS_TARGET_NORMAL1\n    normal.xyz += u_morphWeights[1] * a_Target_Normal1;\n#endif\n\n#ifdef HAS_TARGET_NORMAL2\n    normal.xyz += u_morphWeights[2] * a_Target_Normal2;\n#endif\n\n#ifdef HAS_TARGET_NORMAL3\n    normal.xyz += u_morphWeights[3] * a_Target_Normal3;\n#endif\n\n#ifdef HAS_TARGET_NORMAL4\n    normal.xyz += u_morphWeights[4] * a_Target_Normal4;\n#endif\n\n    return normal;\n}\n\nvec4 getTargetTangent()\n{\n    vec4 tangent = vec4(0);\n\n#ifdef HAS_TARGET_TANGENT0\n    tangent.xyz += u_morphWeights[0] * a_Target_Tangent0;\n#endif\n\n#ifdef HAS_TARGET_TANGENT1\n    tangent.xyz += u_morphWeights[1] * a_Target_Tangent1;\n#endif\n\n#ifdef HAS_TARGET_TANGENT2\n    tangent.xyz += u_morphWeights[2] * a_Target_Tangent2;\n#endif\n\n#ifdef HAS_TARGET_TANGENT3\n    tangent.xyz += u_morphWeights[3] * a_Target_Tangent3;\n#endif\n\n#ifdef HAS_TARGET_TANGENT4\n    tangent.xyz += u_morphWeights[4] * a_Target_Tangent4;\n#endif\n\n    return tangent;\n}\n\n#endif // !USE_MORPHING\n\n\nVERT_IN vec4 a_Position;\nVERT_OUT vec3 v_Position;\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_ModelMatrix0;\nVERT_IN vec4 a_ModelMatrix1;\nVERT_IN vec4 a_ModelMatrix2;\nVERT_IN vec4 a_ModelMatrix3;\n#endif\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_BaseColorFactor;\nVERT_OUT vec4 v_BaseColorFactor;\n#endif\n\n#ifdef USE_INSTANCING\nVERT_IN vec4 a_NormalMatrix0;\nVERT_IN vec4 a_NormalMatrix1;\nVERT_IN vec4 a_NormalMatrix2;\nVERT_IN vec4 a_NormalMatrix3;\n#endif\n\n#ifdef HAS_NORMALS\nVERT_IN vec4 a_Normal;\n#endif\n\n#ifdef HAS_TANGENTS\nVERT_IN vec4 a_Tangent;\n#endif\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nVERT_OUT mat3 v_TBN;\n#else\nVERT_OUT vec3 v_Normal;\n#endif\n#endif\n\n#ifdef HAS_UV_SET1\nVERT_IN vec2 a_UV1;\n#endif\n\n#ifdef HAS_UV_SET2\nVERT_IN vec2 a_UV2;\n#endif\n\nVERT_OUT vec2 v_UVCoord1;\nVERT_OUT vec2 v_UVCoord2;\n\n#ifdef HAS_VERTEX_COLOR_VEC3\nVERT_IN vec3 a_Color;\nVERT_OUT vec3 v_Color;\n#endif\n\n#ifdef HAS_VERTEX_COLOR_VEC4\nVERT_IN vec4 a_Color;\nVERT_OUT vec4 v_Color;\n#endif\n\nuniform mat4 u_ViewProjectionMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\n#ifdef USE_SHADOW_MAPPING\nuniform mat4 u_LightViewProjectionMatrix;\nVERT_OUT vec4 v_PositionLightSpace;\n#endif\n\nvec4 getPosition()\n{\n    vec4 pos = a_Position;\n\n#ifdef USE_MORPHING\n    pos += getTargetPosition();\n#endif\n\n#ifdef USE_SKINNING\n    pos = getSkinningMatrix() * pos;\n#endif\n\n    return pos;\n}\n\n#ifdef HAS_NORMALS\nvec4 getNormal()\n{\n    vec4 normal = a_Normal;\n\n#ifdef USE_MORPHING\n    normal += getTargetNormal();\n#endif\n\n#ifdef USE_SKINNING\n    normal = getSkinningNormalMatrix() * normal;\n#endif\n\n    return normalize(normal);\n}\n#endif\n\n#ifdef HAS_TANGENTS\nvec4 getTangent()\n{\n    vec4 tangent = a_Tangent;\n\n#ifdef USE_MORPHING\n    tangent += getTargetTangent();\n#endif\n\n#ifdef USE_SKINNING\n    tangent = getSkinningMatrix() * tangent;\n#endif\n\n    return normalize(tangent);\n}\n#endif\n\nvoid main()\n{\n    mat4 modelMatrix = u_ModelMatrix;\n    #ifdef USE_INSTANCING\n        modelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\n    #endif\n    vec4 pos = modelMatrix * getPosition();\n    v_Position = vec3(pos.xyz) / pos.w;\n\n    mat4 normalMatrix = u_NormalMatrix;\n    #ifdef USE_INSTANCING\n        normalMatrix = mat4(a_NormalMatrix0, a_NormalMatrix1, a_NormalMatrix2, a_NormalMatrix3);\n    #endif\n\n    #ifdef HAS_NORMALS\n    #ifdef HAS_TANGENTS\n    vec4 tangent = getTangent();\n    vec3 normalW = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\n    vec3 tangentW = normalize(vec3(modelMatrix * vec4(tangent.xyz, 0.0)));\n    vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n    v_TBN = mat3(tangentW, bitangentW, normalW);\n    #else // !HAS_TANGENTS\n    v_Normal = normalize(vec3(normalMatrix * vec4(getNormal().xyz, 0.0)));\n    #endif\n    #endif // !HAS_NORMALS\n\n    v_UVCoord1 = vec2(0.0, 0.0);\n    v_UVCoord2 = vec2(0.0, 0.0);\n\n    #ifdef HAS_UV_SET1\n    v_UVCoord1 = a_UV1;\n    #endif\n\n    #ifdef HAS_UV_SET2\n    v_UVCoord2 = a_UV2;\n    #endif\n\n    #if defined(HAS_VERTEX_COLOR_VEC3) || defined(HAS_VERTEX_COLOR_VEC4)\n    v_Color = a_Color;\n    #endif\n\n    #ifdef USE_SHADOW_MAPPING\n    v_PositionLightSpace = u_LightViewProjectionMatrix * pos;\n    #endif\n\n    #ifdef USE_INSTANCING\n    v_BaseColorFactor = a_BaseColorFactor;\n    #endif\n\n    gl_Position = u_ViewProjectionMatrix * pos;\n}\n"},function(t,e){t.exports="#version VERSION\n\n//\n// This fragment shader defines a reference implementation for Physically Based Shading of\n// a microfacet surface material defined by a glTF model.\n//\n// References:\n// [1] Real Shading in Unreal Engine 4\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n// [2] Physically Based Shading at Disney\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\n// [3] README.md - Environment Maps\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\n// [4] \"An Inexpensive BRDF Model for Physically based Rendering\" by Christophe Schlick\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\n\n#define FEATURES\n\n#if defined(WEBGL1) //&& defined(USE_TEX_LOD)\n#extension GL_EXT_shader_texture_lod : enable\n#endif\n\n#if defined(WEBGL1)\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#if defined(WEBGL1) && defined(USE_HDR)\n#extension GL_OES_texture_float : enable\n#extension GL_OES_texture_float_linear : enable\n#endif\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvec4 _texture(sampler2D sampler, vec2 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return texture2D(sampler, coord);\n#endif\n}\n\nvec4 _texture(samplerCube sampler, vec3 coord)\n{\n#ifdef WEBGL2\n    return texture(sampler, coord);\n#else\n    return textureCube(sampler, coord);\n#endif\n}\nvec4 _textureLod(sampler2D sampler, vec2 coord, float lod)\n{\n#ifdef WEBGL2\n    return textureLod(sampler, coord, lod);\n#endif\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \n    return texture2DLodEXT(sampler, coord, lod);\n#endif\n    return vec4(0.0);\n}\n\nvec4 _textureLod(samplerCube sampler, vec3 coord, float lod)\n{\n#ifdef WEBGL2\n    return textureLod(sampler, coord, lod);\n#endif\n#if defined(WEBGL1) && defined(GL_EXT_shader_texture_lod) \n    return textureCubeLodEXT(sampler, coord, lod);\n#endif\n    return vec4(0.0);\n}\nvec3 _dFdx(vec3 coord)\n{\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\n    return dFdx(coord);\n#endif\n    return vec3(0.0);\n}\n\nvec3 _dFdy(vec3 coord)\n{\n#if defined(WEBGL2) || defined(GL_OES_standard_derivatives)\n    return dFdy(coord);\n#endif\n    return vec3(0.0);\n}\nFRAG_IN vec2 v_UVCoord1;\nFRAG_IN vec2 v_UVCoord2;\n\n// General Material\n#ifdef HAS_NORMAL_MAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\nuniform int u_NormalUVSet;\nuniform mat3 u_NormalUVTransform;\n#endif\n\n#ifdef HAS_EMISSIVE_MAP\nuniform sampler2D u_EmissiveSampler;\nuniform int u_EmissiveUVSet;\nuniform vec3 u_EmissiveFactor;\nuniform mat3 u_EmissiveUVTransform;\n#endif\n\n#ifdef HAS_OCCLUSION_MAP\nuniform sampler2D u_OcclusionSampler;\nuniform int u_OcclusionUVSet;\nuniform float u_OcclusionStrength;\nuniform mat3 u_OcclusionUVTransform;\n#endif\n\n// Metallic Roughness Material\n#ifdef HAS_BASE_COLOR_MAP\nuniform sampler2D u_BaseColorSampler;\nuniform int u_BaseColorUVSet;\nuniform mat3 u_BaseColorUVTransform;\n#endif\n\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\nuniform sampler2D u_MetallicRoughnessSampler;\nuniform int u_MetallicRoughnessUVSet;\nuniform mat3 u_MetallicRoughnessUVTransform;\n#endif\n\n// Specular Glossiness Material\n#ifdef HAS_DIFFUSE_MAP\nuniform sampler2D u_DiffuseSampler;\nuniform int u_DiffuseUVSet;\nuniform mat3 u_DiffuseUVTransform;\n#endif\n\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\nuniform sampler2D u_SpecularGlossinessSampler;\nuniform int u_SpecularGlossinessUVSet;\nuniform mat3 u_SpecularGlossinessUVTransform;\n#endif\n\n// IBL\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\n#endif\n\n#ifdef USE_SHADOW_MAPPING\nuniform sampler2D u_ShadowSampler;\n#endif\n\nvec2 getNormalUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_NORMAL_MAP\n    uv.xy = u_NormalUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_NORMAL_UV_TRANSFORM\n    uv *= u_NormalUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getEmissiveUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_EMISSIVE_MAP\n    uv.xy = u_EmissiveUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_EMISSIVE_UV_TRANSFORM\n    uv *= u_EmissiveUVTransform;\n    #endif\n#endif\n\n    return uv.xy;\n}\n\nvec2 getOcclusionUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_OCCLUSION_MAP\n    uv.xy = u_OcclusionUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_OCCLUSION_UV_TRANSFORM\n    uv *= u_OcclusionUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getBaseColorUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_BASE_COLOR_MAP\n    uv.xy = u_BaseColorUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_BASECOLOR_UV_TRANSFORM\n    uv *= u_BaseColorUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getMetallicRoughnessUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\n    uv.xy = u_MetallicRoughnessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_METALLICROUGHNESS_UV_TRANSFORM\n    uv *= u_MetallicRoughnessUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getSpecularGlossinessUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\n    uv.xy = u_SpecularGlossinessUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_SPECULARGLOSSINESS_UV_TRANSFORM\n    uv *= u_SpecularGlossinessUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\nvec2 getDiffuseUV()\n{\n    vec3 uv = vec3(v_UVCoord1, 1.0);\n#ifdef HAS_DIFFUSE_MAP\n    uv.xy = u_DiffuseUVSet < 1 ? v_UVCoord1 : v_UVCoord2;\n    #ifdef HAS_DIFFUSE_UV_TRANSFORM\n    uv *= u_DiffuseUVTransform;\n    #endif\n#endif\n    return uv.xy;\n}\n\n// textures.glsl needs to be included\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinReflectance = 0.04;\n\nFRAG_IN vec3 v_Position;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nFRAG_IN mat3 v_TBN;\n#else\nFRAG_IN vec3 v_Normal;\n#endif\n#endif\n\n#ifdef HAS_VERTEX_COLOR_VEC3\nFRAG_IN vec3 v_Color;\n#endif\n#ifdef HAS_VERTEX_COLOR_VEC4\nFRAG_IN vec4 v_Color;\n#endif\n\nstruct AngularInfo\n{\n    float NdotL;                  // cos angle between normal and light direction\n    float NdotV;                  // cos angle between normal and view direction\n    float NdotH;                  // cos angle between normal and half vector\n    float LdotH;                  // cos angle between light direction and half vector\n\n    float VdotH;                  // cos angle between view direction and half vector\n\n    vec3 padding;\n};\n\nvec4 getVertexColor()\n{\n   vec4 color = vec4(1.0, 1.0, 1.0, 1.0);\n\n#ifdef HAS_VERTEX_COLOR_VEC3\n    color.rgb = v_Color;\n#endif\n#ifdef HAS_VERTEX_COLOR_VEC4\n    color = v_Color;\n#endif\n\n   return color;\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n    vec2 UV = getNormalUV();\n\n    // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n    vec3 pos_dx = _dFdx(v_Position);\n    vec3 pos_dy = _dFdy(v_Position);\n    vec3 tex_dx = _dFdx(vec3(UV, 0.0));\n    vec3 tex_dy = _dFdy(vec3(UV, 0.0));\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n    vec3 ng = normalize(v_Normal);\n#else\n    vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n    t = normalize(t - ng * dot(ng, t));\n    vec3 b = normalize(cross(ng, t));\n    mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n    mat3 tbn = v_TBN;\n#endif\n\n#ifdef HAS_NORMAL_MAP\n    vec3 n = _texture(u_NormalSampler, UV).rgb;\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\n    vec3 n = normalize(tbn[2].xyz);\n#endif\n\n    return n;\n}\n\nfloat getPerceivedBrightness(vec3 vector)\n{\n    return sqrt(0.299 * vector.r * vector.r + 0.587 * vector.g * vector.g + 0.114 * vector.b * vector.b);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness/examples/convert-between-workflows/js/three.pbrUtilities.js#L34\nfloat solveMetallic(vec3 diffuse, vec3 specular, float oneMinusSpecularStrength) {\n    float specularBrightness = getPerceivedBrightness(specular);\n\n    if (specularBrightness < c_MinReflectance) {\n        return 0.0;\n    }\n\n    float diffuseBrightness = getPerceivedBrightness(diffuse);\n\n    float a = c_MinReflectance;\n    float b = diffuseBrightness * oneMinusSpecularStrength / (1.0 - c_MinReflectance) + specularBrightness - 2.0 * c_MinReflectance;\n    float c = c_MinReflectance - specularBrightness;\n    float D = b * b - 4.0 * a * c;\n\n    return clamp((-b + sqrt(D)) / (2.0 * a), 0.0, 1.0);\n}\n\nAngularInfo getAngularInfo(vec3 pointToLight, vec3 normal, vec3 view)\n{\n    // Standard one-letter names\n    vec3 n = normalize(normal);           // Outward direction of surface point\n    vec3 v = normalize(view);             // Direction from surface point to view\n    vec3 l = normalize(pointToLight);     // Direction from surface point to light\n    vec3 h = normalize(l + v);            // Direction of the vector between l and v\n\n    float NdotL = clamp(dot(n, l), 0.0, 1.0);\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    return AngularInfo(\n        NdotL,\n        NdotV,\n        NdotH,\n        LdotH,\n        VdotH,\n        vec3(0, 0, 0)\n    );\n}\n\n#ifdef USE_SHADOW_MAPPING\nFRAG_IN vec4 v_PositionLightSpace;\n#endif\n\nfloat linstep(float low, float high, float v)\n{\n    return clamp((v-low) / (high-low), 0.0, 1.0);\n}\n\n#ifdef USE_SHADOW_MAPPING\nfloat getShadowContribution()\n{\n    vec3 coords = v_PositionLightSpace.xyz / v_PositionLightSpace.w * 0.5 + 0.5;\n    if (coords.z < 0.01 || coords.z > 0.99 || coords.x < 0.01 || coords.x > 0.99 || coords.y < 0.01 || coords.y > 0.99) {\n        return 1.0;\n    }\n    vec2 moments = vec2(1.0) - _texture(u_ShadowSampler, coords.xy).xy;\n    float p = step(coords.z, moments.x);\n    float variance = max(moments.y - moments.x * moments.x, 0.00002);\n    float d = coords.z - moments.x;\n    float pMax = linstep(0.2, 1.0, variance / (variance + d*d));\n    return min(max(p, pMax), 1.0);\n}\n#endif\nuniform float u_Exposure;\n\nconst float GAMMA = 2.2;\nconst float INV_GAMMA = 1.0 / GAMMA;\n\n// linear to sRGB approximation\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\nvec3 LINEARtoSRGB(vec3 color)\n{\n    return pow(color, vec3(INV_GAMMA));\n}\n\n// sRGB to linear approximation\n// see http://chilliant.blogspot.com/2012/08/srgb-approximations-for-hlsl.html\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n    return vec4(pow(srgbIn.xyz, vec3(GAMMA)), srgbIn.w);\n}\n\n// Uncharted 2 tone map\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 toneMapUncharted2Impl(vec3 color)\n{\n    const float A = 0.15;\n    const float B = 0.50;\n    const float C = 0.10;\n    const float D = 0.20;\n    const float E = 0.02;\n    const float F = 0.30;\n    return ((color*(A*color+C*B)+D*E)/(color*(A*color+B)+D*F))-E/F;\n}\n\nvec3 toneMapUncharted(vec3 color)\n{\n    const float W = 11.2;\n    color = toneMapUncharted2Impl(color * 2.0);\n    vec3 whiteScale = 1.0 / toneMapUncharted2Impl(vec3(W));\n    return LINEARtoSRGB(color * whiteScale);\n}\n\n// Hejl Richard tone map\n// see: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 toneMapHejlRichard(vec3 color)\n{\n    color = max(vec3(0.0), color - vec3(0.004));\n    return (color*(6.2*color+.5))/(color*(6.2*color+1.7)+0.06);\n}\n\n// ACES tone map\n// see: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\nvec3 toneMapACES(vec3 color)\n{\n    const float A = 2.51;\n    const float B = 0.03;\n    const float C = 2.43;\n    const float D = 0.59;\n    const float E = 0.14;\n    return LINEARtoSRGB(clamp((color * (A * color + B)) / (color * (C * color + D) + E), 0.0, 1.0));\n}\n\nvec3 toneMap(vec3 color)\n{\n    color *= u_Exposure;\n\n#ifdef TONEMAP_UNCHARTED\n    return toneMapUncharted(color);\n#endif\n\n#ifdef TONEMAP_HEJLRICHARD\n    return toneMapHejlRichard(color);\n#endif\n\n#ifdef TONEMAP_ACES\n    return toneMapACES(color);\n#endif\n\n    return LINEARtoSRGB(color);\n}\n\n\n// KHR_lights_punctual extension.\n// see https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n\nstruct Light\n{\n    vec3 direction;\n    float range;\n\n    vec3 color;\n    float intensity;\n\n    vec3 position;\n    float innerConeCos;\n\n    float outerConeCos;\n    int type;\n\n    vec2 padding;\n};\n\nconst int LightType_Directional = 0;\nconst int LightType_Point = 1;\nconst int LightType_Spot = 2;\nconst int LightType_Ambient = 3;\n\n#ifdef USE_PUNCTUAL\nuniform Light u_Lights[LIGHT_COUNT];\n#endif\n\n#if defined(MATERIAL_SPECULARGLOSSINESS) || defined(MATERIAL_METALLICROUGHNESS)\nuniform float u_MetallicFactor;\nuniform float u_RoughnessFactor;\nuniform vec4 u_BaseColorFactor;\n#endif\n\n#ifdef USE_INSTANCING\nFRAG_IN vec4 v_BaseColorFactor;\n#endif\n\n#ifdef MATERIAL_SPECULARGLOSSINESS\nuniform vec3 u_SpecularFactor;\nuniform vec4 u_DiffuseFactor;\nuniform float u_GlossinessFactor;\n#endif\n\n#ifdef ALPHAMODE_MASK\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec3 u_Camera;\n\nuniform int u_MipCount;\n\nstruct MaterialInfo\n{\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\n\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n    vec3 diffuseColor;            // color contribution from diffuse lighting\n\n    vec3 reflectance90;           // reflectance color at grazing angle\n    vec3 specularColor;           // color contribution from specular lighting\n};\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(MaterialInfo materialInfo, vec3 n, vec3 v)\n{\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\n\n    float lod = clamp(materialInfo.perceptualRoughness * float(u_MipCount), 0.0, float(u_MipCount));\n    vec3 reflection = normalize(reflect(-v, n));\n\n    vec2 brdfSamplePoint = clamp(vec2(NdotV, materialInfo.perceptualRoughness), vec2(0.0, 0.0), vec2(1.0, 1.0));\n    // retrieve a scale and bias to F0. See [1], Figure 3\n    vec2 brdf = _texture(u_brdfLUT, brdfSamplePoint).rg;\n\n    vec4 diffuseSample = _texture(u_DiffuseEnvSampler, n);\n\n#ifdef USE_TEX_LOD\n    vec4 specularSample = _textureLod(u_SpecularEnvSampler, reflection, lod);\n#else\n    vec4 specularSample = _texture(u_SpecularEnvSampler, reflection);\n#endif\n\n#ifdef USE_HDR\n    // Already linear.\n    vec3 diffuseLight = diffuseSample.rgb;\n    vec3 specularLight = specularSample.rgb;\n#else\n    vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\n    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\n#endif\n\n    vec3 diffuse = diffuseLight * materialInfo.diffuseColor;\n    vec3 specular = specularLight * (materialInfo.specularColor * brdf.x + brdf.y);\n\n    return diffuse + specular;\n}\n#endif\n\n// Lambert lighting\n// see https://seblagarde.wordpress.com/2012/01/08/pi-or-not-to-pi-in-game-lighting-equation/\nvec3 diffuse(MaterialInfo materialInfo)\n{\n    return materialInfo.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    return materialInfo.reflectance0 + (materialInfo.reflectance90 - materialInfo.reflectance0) * pow(clamp(1.0 - angularInfo.VdotH, 0.0, 1.0), 5.0);\n}\n\n// Smith Joint GGX\n// Note: Vis = G / (4 * NdotL * NdotV)\n// see Eric Heitz. 2014. Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs. Journal of Computer Graphics Techniques, 3\n// see Real-Time Rendering. Page 331 to 336.\n// see https://google.github.io/filament/Filament.md.html#materialsystem/specularbrdf/geometricshadowing(specularg)\nfloat visibilityOcclusion(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    float NdotL = angularInfo.NdotL;\n    float NdotV = angularInfo.NdotV;\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\n\n    float GGXV = NdotL * sqrt(NdotV * NdotV * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n    float GGXL = NdotV * sqrt(NdotL * NdotL * (1.0 - alphaRoughnessSq) + alphaRoughnessSq);\n\n    float GGX = GGXV + GGXL;\n    if (GGX > 0.0)\n    {\n        return 0.5 / GGX;\n    }\n    return 0.0;\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(MaterialInfo materialInfo, AngularInfo angularInfo)\n{\n    float alphaRoughnessSq = materialInfo.alphaRoughness * materialInfo.alphaRoughness;\n    float f = (angularInfo.NdotH * alphaRoughnessSq - angularInfo.NdotH) * angularInfo.NdotH + 1.0;\n    return alphaRoughnessSq / (M_PI * f * f);\n}\n\nvec3 getPointShade(vec3 pointToLight, MaterialInfo materialInfo, vec3 normal, vec3 view)\n{\n    AngularInfo angularInfo = getAngularInfo(pointToLight, normal, view);\n\n    if (angularInfo.NdotL > 0.0 || angularInfo.NdotV > 0.0)\n    {\n        // Calculate the shading terms for the microfacet specular shading model\n        vec3 F = specularReflection(materialInfo, angularInfo);\n        float Vis = visibilityOcclusion(materialInfo, angularInfo);\n        float D = microfacetDistribution(materialInfo, angularInfo);\n\n        // Calculation of analytical lighting contribution\n        vec3 diffuseContrib = (1.0 - F) * diffuse(materialInfo);\n        vec3 specContrib = F * Vis * D;\n\n        // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n        return angularInfo.NdotL * (diffuseContrib + specContrib);\n    }\n\n    return vec3(0.0, 0.0, 0.0);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#range-property\nfloat getRangeAttenuation(float range, float distance)\n{\n    if (range <= 0.0)\n    {\n        // negative range means unlimited\n        return 1.0;\n    }\n    return max(min(1.0 - pow(distance / range, 4.0), 1.0), 0.0) / pow(distance, 2.0);\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Khronos/KHR_lights_punctual/README.md#inner-and-outer-cone-angles\nfloat getSpotAttenuation(vec3 pointToLight, vec3 spotDirection, float outerConeCos, float innerConeCos)\n{\n    float actualCos = dot(normalize(spotDirection), normalize(-pointToLight));\n    if (actualCos > outerConeCos)\n    {\n        if (actualCos < innerConeCos)\n        {\n            return smoothstep(outerConeCos, innerConeCos, actualCos);\n        }\n        return 1.0;\n    }\n    return 0.0;\n}\n\nvec3 applyDirectionalLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\n{\n    vec3 pointToLight = -light.direction;\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\n    return light.intensity * light.color * shade;\n}\n\nvec3 applyPointLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view)\n{\n    vec3 pointToLight = light.position - v_Position;\n    float distance = length(pointToLight);\n    float attenuation = getRangeAttenuation(light.range, distance);\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view);\n    return attenuation * light.intensity * light.color * shade;\n}\n\nvec3 applySpotLight(Light light, MaterialInfo materialInfo, vec3 normal, vec3 view, float shadow)\n{\n    vec3 pointToLight = light.position - v_Position;\n    float distance = length(pointToLight);\n    float rangeAttenuation = getRangeAttenuation(light.range, distance);\n    float spotAttenuation = getSpotAttenuation(pointToLight, light.direction, light.outerConeCos, light.innerConeCos);\n    vec3 shade = getPointShade(pointToLight, materialInfo, normal, view) * shadow;\n    return rangeAttenuation * spotAttenuation * light.intensity * light.color * shade;\n}\n\nvec3 applyAmbientLight(Light light, MaterialInfo materialInfo)\n{\n    return light.intensity * light.color * diffuse(materialInfo);\n}\n\n#ifdef WEBGL2\n    out vec4 FRAG_COLOR;\n#endif\n\nvoid main()\n{\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    float perceptualRoughness = 0.0;\n    float metallic = 0.0;\n    vec4 baseColor = vec4(0.0, 0.0, 0.0, 1.0);\n    vec3 diffuseColor = vec3(0.0);\n    vec3 specularColor= vec3(0.0);\n    vec3 f0 = vec3(0.04);\n\n#ifdef MATERIAL_SPECULARGLOSSINESS\n\n#ifdef HAS_SPECULAR_GLOSSINESS_MAP\n    vec4 sgSample = SRGBtoLINEAR(_texture(u_SpecularGlossinessSampler, getSpecularGlossinessUV()));\n    perceptualRoughness = (1.0 - sgSample.a * u_GlossinessFactor); // glossiness to roughness\n    f0 = sgSample.rgb * u_SpecularFactor; // specular\n#else\n    f0 = u_SpecularFactor;\n    perceptualRoughness = 1.0 - u_GlossinessFactor;\n#endif // ! HAS_SPECULAR_GLOSSINESS_MAP\n\n#ifdef HAS_DIFFUSE_MAP\n    baseColor = SRGBtoLINEAR(_texture(u_DiffuseSampler, getDiffuseUV())) * u_DiffuseFactor;\n#else\n    baseColor = u_DiffuseFactor;\n#endif // !HAS_DIFFUSE_MAP\n\n    baseColor *= getVertexColor();\n\n    // f0 = specular\n    specularColor = f0;\n    float oneMinusSpecularStrength = 1.0 - max(max(f0.r, f0.g), f0.b);\n    diffuseColor = baseColor.rgb * oneMinusSpecularStrength;\n\n#ifdef DEBUG_METALLIC\n    // do conversion between metallic M-R and S-G metallic\n    metallic = solveMetallic(baseColor.rgb, specularColor, oneMinusSpecularStrength);\n#endif // ! DEBUG_METALLIC\n\n#endif // ! MATERIAL_SPECULARGLOSSINESS\n\n#ifdef MATERIAL_METALLICROUGHNESS\n\n#ifdef HAS_METALLIC_ROUGHNESS_MAP\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    vec4 mrSample = _texture(u_MetallicRoughnessSampler, getMetallicRoughnessUV());\n    perceptualRoughness = mrSample.g * u_RoughnessFactor;\n    metallic = mrSample.b * u_MetallicFactor;\n#else\n    metallic = u_MetallicFactor;\n    perceptualRoughness = u_RoughnessFactor;\n#endif\n\n    vec4 baseColorFactor = u_BaseColorFactor;\n#ifdef USE_INSTANCING\n    baseColorFactor = v_BaseColorFactor;\n#endif\n\n    // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASE_COLOR_MAP\n    baseColor = SRGBtoLINEAR(_texture(u_BaseColorSampler, getBaseColorUV())) * baseColorFactor;\n#else\n    baseColor = baseColorFactor;\n#endif\n\n    baseColor *= getVertexColor();\n\n    diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallic);\n\n    specularColor = mix(f0, baseColor.rgb, metallic);\n\n#endif // ! MATERIAL_METALLICROUGHNESS\n\n#ifdef ALPHAMODE_MASK\n    if(baseColor.a < u_AlphaCutoff)\n    {\n        discard;\n    }\n    baseColor.a = 1.0;\n#endif\n\n#ifdef ALPHAMODE_OPAQUE\n    baseColor.a = 1.0;\n#endif\n\n#ifdef MATERIAL_UNLIT\n    FRAG_COLOR = vec4(LINEARtoSRGB(baseColor.rgb) * baseColor.a, baseColor.a);\n    return;\n#endif\n\n    perceptualRoughness = clamp(perceptualRoughness, 0.0, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    // Anything less than 2% is physically impossible and is instead considered to be shadowing. Compare to \"Real-Time-Rendering\" 4th editon on page 325.\n    vec3 specularEnvironmentR90 = vec3(clamp(reflectance * 50.0, 0.0, 1.0));\n\n    MaterialInfo materialInfo = MaterialInfo(\n        perceptualRoughness,\n        specularEnvironmentR0,\n        alphaRoughness,\n        diffuseColor,\n        specularEnvironmentR90,\n        specularColor\n    );\n\n    // LIGHTING\n\n    vec3 color = vec3(0.0, 0.0, 0.0);\n    vec3 normal = getNormal();\n    vec3 view = normalize(u_Camera - v_Position);\n\n    float shadow = 1.0;\n    #ifdef USE_SHADOW_MAPPING\n        shadow = getShadowContribution();\n    #endif\n\n#ifdef USE_PUNCTUAL\n    for (int i = 0; i < LIGHT_COUNT; ++i)\n    {\n        Light light = u_Lights[i];\n        if (light.type == LightType_Directional)\n        {\n            color += applyDirectionalLight(light, materialInfo, normal, view, shadow);\n        }\n        else if (light.type == LightType_Point)\n        {\n            color += applyPointLight(light, materialInfo, normal, view);\n        }\n        else if (light.type == LightType_Spot)\n        {\n            color += applySpotLight(light, materialInfo, normal, view, shadow);\n        }\n        else if (light.type == LightType_Ambient) \n        {\n \t\t\tcolor += applyAmbientLight(light, materialInfo);\n \t\t}\n    }\n#endif\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n    color += getIBLContribution(materialInfo, normal, view);\n#endif\n\n    float ao = 1.0;\n    // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSION_MAP\n    ao = _texture(u_OcclusionSampler,  getOcclusionUV()).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n    vec3 emissive = vec3(0);\n#ifdef HAS_EMISSIVE_MAP\n    emissive = SRGBtoLINEAR(_texture(u_EmissiveSampler, getEmissiveUV())).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifndef DEBUG_OUTPUT // no debug\n\n   // regular shading\n    FRAG_COLOR = vec4(toneMap(color) * baseColor.a, baseColor.a);\n\n#else // debug output\n\n    #ifdef DEBUG_METALLIC\n        FRAG_COLOR.rgb = vec3(metallic);\n    #endif\n\n    #ifdef DEBUG_ROUGHNESS\n        FRAG_COLOR.rgb = vec3(perceptualRoughness);\n    #endif\n\n    #ifdef DEBUG_NORMAL\n        #ifdef HAS_NORMAL_MAP\n            FRAG_COLOR.rgb = _texture(u_NormalSampler, getNormalUV()).rgb;\n        #else\n            FRAG_COLOR.rgb = vec3(0.5, 0.5, 1.0);\n        #endif\n    #endif\n\n    #ifdef DEBUG_BASECOLOR\n        FRAG_COLOR.rgb = LINEARtoSRGB(baseColor.rgb);\n    #endif\n\n    #ifdef DEBUG_OCCLUSION\n        FRAG_COLOR.rgb = vec3(ao);\n    #endif\n\n    #ifdef DEBUG_EMISSIVE\n        FRAG_COLOR.rgb = LINEARtoSRGB(emissive);\n    #endif\n\n    #ifdef DEBUG_F0\n        FRAG_COLOR.rgb = vec3(f0);\n    #endif\n\n    #ifdef DEBUG_ALPHA\n        FRAG_COLOR.rgb = vec3(baseColor.a);\n    #endif\n\n    FRAG_COLOR.a = 1.0;\n\n#endif // !DEBUG_OUTPUT\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StandardMaterialSkinUniforms=void 0;var r=n(21),o=function(){function t(){}return t.prototype.enableJointMatrixTextures=function(t){this._jointMatrixTexture||(this._jointMatrixTexture=new r.StandardMaterialMatrixTexture(t)),this._jointNormalTexture||(this._jointNormalTexture=new r.StandardMaterialMatrixTexture(t))},t.prototype.destroy=function(){var t,e;null===(t=this._jointNormalTexture)||void 0===t||t.destroy(!0),null===(e=this._jointMatrixTexture)||void 0===e||e.destroy(!0)},t.prototype.update=function(t,e){if(t.skin){var n=t.skin.calculateJointMatrices(),r=n.jointVertexMatrices,o=n.jointNormalMatrices;this._jointMatrixTexture?(this._jointMatrixTexture.updateBuffer(r),e.uniforms.u_jointMatrixSampler=this._jointMatrixTexture):e.uniforms.u_jointMatrix=r,this._jointNormalTexture?(this._jointNormalTexture.updateBuffer(o),e.uniforms.u_jointNormalMatrixSampler=this._jointNormalTexture):e.uniforms.u_jointNormalMatrix=o}},t}();e.StandardMaterialSkinUniforms=o},function(t,e,n){"use strict";var r=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedStandardMaterial=void 0;var i=n(11),a=function(t){this.baseColor=new(i.Color.bind.apply(i.Color,o([void 0],r(t.baseColor.rgba))))};e.InstancedStandardMaterial=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadGeometry=void 0;var r=n(9);!function(t){t.create=function(){return Object.assign(new r.MeshGeometry3D,{positions:{buffer:new Float32Array([-1,1,0,1,-1,0,-1,-1,0,1,1,0])},indices:{buffer:new Uint8Array([0,2,1,0,1,3])},normals:{buffer:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1])},uvs:[{buffer:new Float32Array([0,0,1,1,0,1,1,0])}]})}}(e.QuadGeometry||(e.QuadGeometry={}))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedMesh3D=void 0;var i=function(t){function e(e,n){var r=t.call(this)||this;return r.mesh=e,r.material=n,r}return o(e,t),e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.mesh.removeInstance(this)},e}(n(1).Container3D);e.InstancedMesh3D=i},function(t,e,n){"use strict";var r,o=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.glTFParser=void 0;var i=n(12),a=n(68),u=n(69),s=n(35),c=n(6),f=n(1),l=n(15),d=n(9),h=n(24),p=n(19),_=n(38),m=n(39),v=n(70),y=function(){function t(t,e){this._asset=t,this._materialFactory=e||l.StandardMaterial,this._descriptor=this._asset.descriptor}return t.createModel=function(e,n){return new t(e,n).parseModel()},t.createMesh=function(e,n,r){return void 0===r&&(r=0),new t(e,n).parseMesh(r)},t.prototype.parseBuffer=function(t){if(void 0!==t){"number"==typeof t&&(t=this._asset.descriptor.accessors[t]);var e=this._descriptor.bufferViews[t.bufferView||0],n=t.byteOffset||0;void 0!==e.byteOffset&&(n+=e.byteOffset);var r=t.count*g[t.type];void 0!==e.byteStride&&(r*=e.byteStride/b[t.componentType]/g[t.type]);var o=this._asset.buffers[e.buffer];return u.glTFBufferView.from(t.componentType,o,n,r,e.byteStride)}},t.prototype.parseAnimation=function(t,e){var n,r;"number"==typeof t&&(t=this._asset.descriptor.animations[t]);var u=[];try{for(var s=o(t.channels),c=s.next();!c.done;c=s.next()){var f=c.value,l=t.samplers[f.sampler],d=this.parseBuffer(l.input);if(void 0!==d){var h=this.parseBuffer(l.output);if(void 0!==h){var p=i.glTFChannel.from(d.buffer,h.buffer,l.interpolation||"LINEAR",f.target.path,e[f.target.node]);p&&u.push(p)}}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return new a.glTFAnimation(u,t.name)},t.prototype.parseMaterial=function(t){"number"==typeof t&&(t=this._asset.descriptor.materials[t]);var e=new s.glTFMaterial;if(!t)return this._materialFactory.create(e);e.occlusionTexture=this.parseTexture(t.occlusionTexture),e.normalTexture=this.parseTexture(t.normalTexture),e.emissiveTexture=this.parseTexture(t.emissiveTexture),void 0!==t.doubleSided&&(e.doubleSided=t.doubleSided),t.emissive&&(e.emissive=t.emissive),t.alphaMode&&(e.alphaMode=t.alphaMode),void 0!==t.alphaCutoff&&(e.alphaCutoff=t.alphaCutoff);var n=t.pbrMetallicRoughness;return e.metallicRoughnessTexture=this.parseTexture(null==n?void 0:n.metallicRoughnessTexture),(null==n?void 0:n.baseColorFactor)&&(e.baseColor=n.baseColorFactor),e.baseColorTexture=this.parseTexture(null==n?void 0:n.baseColorTexture),void 0!==(null==n?void 0:n.metallicFactor)&&(e.metallic=n.metallicFactor),void 0!==(null==n?void 0:n.roughnessFactor)&&(e.roughness=n.roughnessFactor),t.extensions&&(e.unlit=null!=t.extensions.KHR_materials_unlit),this._materialFactory.create(e)},t.prototype.parseTexture=function(t){if(void 0!==t){"number"==typeof t&&(t={index:t});var e=this._asset.images[this._descriptor.textures[t.index].source];return t.extensions&&t.extensions.KHR_texture_transform&&v.TextureTransform.calculateUVTransform(t.extensions.KHR_texture_transform,e),e}},t.prototype.parseMesh=function(t){var e=this;"number"==typeof t&&(t=this._asset.descriptor.meshes[t]);var n=t.weights||[];return t.primitives.map((function(r){return Object.assign(e.parsePrimitive(r),{name:t.name,morphWeights:n})}))},t.prototype.parseSkin=function(t,e,n){"number"==typeof t&&(t=this._asset.descriptor.skins[t]);var r=this.parseBuffer(t.inverseBindMatrices),o=[];if(r)for(var i=0;i<t.joints.length;i++)o.push(new m.Joint(n[t.joints[i]],r.buffer.slice(16*i,16*i+16)));return new _.Skin(e,o)},t.prototype.parsePrimitive=function(t){for(var e,n=t.attributes,r=t.targets,o=Object.assign(new d.MeshGeometry3D,{indices:this.parseBuffer(t.indices),positions:this.parseBuffer(n.POSITION),normals:this.parseBuffer(n.NORMAL),tangents:this.parseBuffer(n.TANGENT),joints:this.parseBuffer(n.JOINTS_0),weights:this.parseBuffer(n.WEIGHTS_0)}),i=0;;i++){var a=this.parseBuffer(n["TEXCOORD_"+i]);if(void 0===a)break;o.uvs=o.uvs||[],o.uvs.push(a)}if(r)for(i=0;i<r.length;i++)o.targets=o.targets||[],o.targets.push({positions:this.parseBuffer(r[i].POSITION),normals:this.parseBuffer(r[i].NORMAL),tangents:this.parseBuffer(r[i].TANGENT)});return e=void 0!==t.material?this.parseMaterial(this._asset.descriptor.materials[t.material]):this.parseMaterial(),new c.Mesh3D(o,e)},t.prototype.parseNode=function(t){"number"==typeof t&&(t=this._asset.descriptor.nodes[t]);var e=Object.assign(new f.Container3D,{name:t.name});return t.translation&&e.position.set(t.translation[0],t.translation[1],t.translation[2]),t.rotation&&e.rotationQuaternion.set(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]),t.scale&&e.scale.set(t.scale[0],t.scale[1],t.scale[2]),t.matrix&&e.transform.setFromMatrix(new p.TransformMatrix(t.matrix)),e},t.prototype.parseModel=function(){var t,e,n,r,i=this,a=this._descriptor.nodes.map((function(t){return i.parseNode(t)})),u=this._descriptor.scenes[this._asset.descriptor.scene||0],s=new h.Model,c=function(t,e){var n,r,u,f,l,d=i._asset.descriptor.nodes[e].mesh;if(void 0!==i._asset.descriptor.nodes[e].skin&&(l=i.parseSkin(i._asset.descriptor.nodes[e].skin,a[e],a)),void 0!==d)try{for(var h=o(i.parseMesh(d)),p=h.next();!p.done;p=h.next()){var _=p.value;s.meshes.push(a[e].addChild(_)),s.meshes[s.meshes.length-1].skin=l}}catch(t){n={error:t}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}if(t.addChild(a[e]),i._asset.descriptor.nodes[e].children)try{for(var m=o(i._asset.descriptor.nodes[e].children),v=m.next();!v.done;v=m.next()){var y=v.value;c(a[e],y)}}catch(t){u={error:t}}finally{try{v&&!v.done&&(f=m.return)&&f.call(m)}finally{if(u)throw u.error}}};try{for(var f=o(u.nodes),l=f.next();!l.done;l=f.next()){var d=l.value;c(s,d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=f.return)&&e.call(f)}finally{if(t)throw t.error}}if(this._asset.descriptor.animations)try{for(var p=o(this._asset.descriptor.animations),_=p.next();!_.done;_=p.next()){var m=_.value;s.animations.push(this.parseAnimation(m,a))}}catch(t){n={error:t}}finally{try{_&&!_.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}return s},t}();e.glTFParser=y;var g={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b=((r={})[5120]=1,r[5121]=1,r[5122]=2,r[5123]=2,r[5125]=4,r[5126]=4,r)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFLinear=void 0;var i=function(t){function e(e,n){var r=t.call(this)||this;return r._output=e,r._stride=n,r._data=new Float32Array(n),r}return o(e,t),e.prototype.interpolate=function(t,e){for(var n=(t+0)*this._stride,r=(t+1)*this._stride,o=0;o<this._stride;o++)this._output.length>r?this._data[o]=(1-e)*this._output[n+o]+e*this._output[r+o]:this._data[o]=this._output[n+o];return this._data},e}(n(13).glTFInterpolation);e.glTFLinear=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFCubicSpline=void 0;var i=function(t){function e(e,n,r){var o=t.call(this)||this;return o._input=e,o._output=n,o._stride=r,o._data=new Float32Array(r),o}return o(e,t),e.prototype.interpolate=function(t,n){for(var r=this._input[t+1]-this._input[t],o=(t+0)*this._stride*3,i=(t+1)*this._stride*3,a=0;a<this._stride;a++)this._data[a]=e.calculate(n,this._output[o+a+1*this._stride],this._output[i+a+1*this._stride],r*this._output[i+a],r*this._output[o+a+2*this._stride]);return this._data},e.calculate=function(t,e,n,r,o){return(2*Math.pow(t,3)-3*Math.pow(t,2)+1)*e+(Math.pow(t,3)-2*Math.pow(t,2)+t)*r+(-2*Math.pow(t,3)+3*Math.pow(t,2))*n+(Math.pow(t,3)-Math.pow(t,2))*o},e}(n(13).glTFInterpolation);e.glTFCubicSpline=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFStep=void 0;var i=function(t){function e(e,n){var r=t.call(this)||this;return r._output=e,r._stride=n,r._data=new Float32Array(n),r}return o(e,t),e.prototype.interpolate=function(t){for(var e=0;e<this._stride;e++)this._data[e]=this._output[t*this._stride+e];return this._data},e}(n(13).glTFInterpolation);e.glTFStep=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFSphericalLinear=void 0;var i=n(3),a=function(t){function e(e){var n=t.call(this)||this;return n._output=e,n._data=new Float32Array(4),n}return o(e,t),e.prototype.interpolate=function(t,e){var n=4*(t+0),r=4*(t+1),o=i.Quat.set(this._output[n],this._output[n+1],this._output[n+2],this._output[n+3],new Float32Array(4));if(this._output.length<=r)return i.Quat.normalize(o,this._data);var a=i.Quat.set(this._output[r],this._output[r+1],this._output[r+2],this._output[r+3],new Float32Array(4));return i.Quat.normalize(i.Quat.slerp(o,a,e,this._data),this._data)},e}(n(13).glTFInterpolation);e.glTFSphericalLinear=a},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFScale=void 0;var i=function(t){function e(e,n,r){var o=t.call(this,n,r)||this;return o._transform=e,o}return o(e,t),e.prototype.updateTarget=function(t){this._transform.scale.set(t[0],t[1],t[2])},e}(n(12).glTFChannel);e.glTFScale=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFWeights=void 0;var i=function(t){function e(e,n,r){var o=t.call(this,n,r)||this;return o._weights=e,o}return o(e,t),e.prototype.updateTarget=function(t){for(var e=0;e<t.length;e++)this._weights[e]=t[e]},e}(n(12).glTFChannel);e.glTFWeights=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFRotation=void 0;var i=function(t){function e(e,n,r){var o=t.call(this,n,r)||this;return o._transform=e,o}return o(e,t),e.prototype.updateTarget=function(t){this._transform.rotationQuaternion.set(t[0],t[1],t[2],t[3])},e}(n(12).glTFChannel);e.glTFRotation=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.glTFTranslation=void 0;var i=function(t){function e(e,n,r){var o=t.call(this,n,r)||this;return o._transform=e,o}return o(e,t),e.prototype.updateTarget=function(t){this._transform.position.set(t[0],t[1],t[2])},e}(n(12).glTFChannel);e.glTFTranslation=i},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.glTFAnimation=void 0;var a=function(t){function e(e,n){var r,o,a=t.call(this,n)||this;a._duration=0,a._position=0,a._channels=[];try{for(var u=i(e),s=u.next();!s.done;s=u.next()){var c=s.value;a._duration=Math.max(a._duration,c.duration)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return a._channels=e,a}return o(e,t),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){var e,n;this._position=t;try{for(var r=i(this._channels),o=r.next();!o.done;o=r.next()){o.value.position=this._position}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},enumerable:!1,configurable:!0}),e}(n(37).Animation);e.glTFAnimation=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.glTFBufferView=void 0;var r=function(){function t(t,e,n){void 0===n&&(n=0),this.buffer=t,this.componentType=e,this.stride=n}return t.from=function(e,n,r,o,i){switch(e){case 5125:return new t(new Uint32Array(n,r,o),e,i);case 5126:return new t(new Float32Array(n,r,o),e,i);case 5120:return new t(new Int8Array(n,r,o),e,i);case 5121:return new t(new Uint8Array(n,r,o),e,i);case 5122:return new t(new Int16Array(n,r,o),e,i);case 5123:return new t(new Uint16Array(n,r,o),e,i);default:throw new Error('PIXI3D: Unknown component type "'+e+'".')}},t}();e.glTFBufferView=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextureTransform=void 0;var r=n(71),o=function(){function t(){}return t.calculateUVTransform=function(e,n){if(t._uvTransMat.set([1,0,0,0,1,0,0,0,1],0),t._uvRotMat.set([1,0,0,0,1,0,0,0,1],0),t._uvScaleMat.set([1,0,0,0,1,0,0,0,1],0),void 0!==e.rotation){var o=Math.sin(e.rotation),i=Math.cos(e.rotation);t._uvRotMat.set([i,o,0,-o,i,0,0,0,1],0)}void 0!==e.scale&&t._uvScaleMat.set([e.scale[0],0,0,0,e.scale[1],0,0,0,1],0),void 0!==e.offset&&t._uvTransMat.set([1,0,e.offset[0],0,1,e.offset[1],0,0,1],0);var a=new Float32Array([1,0,0,0,1,0,0,0,1]);r.Mat3.multiply(t._uvRotMat,t._uvScaleMat,a),r.Mat3.multiply(a,t._uvTransMat,a),n.uvTransform=a},t._uvTransMat=new Float32Array(9),t._uvRotMat=new Float32Array(9),t._uvScaleMat=new Float32Array(9),t}();e.TextureTransform=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mat3=void 0;var r=n(14),o=function(){function t(){}return t.multiply=function(t,e,n){return r.mat3.multiply(n,t,e)},t}();e.Mat3=o},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedModel=void 0;var a=n(1),u=n(6),s=function(t){function e(e){var n,r,o=t.call(this)||this;o.meshes=e;try{for(var a=i(e),u=a.next();!u.done;u=a.next()){var s=u.value;o.addChild(s)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o}return o(e,t),e.prototype.destroy=function(e){var n,r;t.prototype.destroy.call(this,e);try{for(var o=i(this.meshes),a=o.next();!a.done;a=o.next()){a.value.destroy(e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.from=function(t){var n=[],r=function(t,e){var o,s;try{for(var c=i(t.children),f=c.next();!f.done;f=c.next()){var l=f.value;if(l instanceof u.Mesh3D){var d=l.createInstance();d.name=l.name,n.push(e.addChild(d))}else if(l instanceof a.Container3D){var h=new a.Container3D;h.name=t.name,h.position=l.position,h.scale=l.scale,h.rotationQuaternion=l.rotationQuaternion,e.addChild(h),r(l,h)}}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}return e};return r(t,new e(n))},e}(a.Container3D);e.InstancedModel=s},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Light=void 0;var i=n(11),a=n(1),u=n(10),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=u.LightType.point,e.color=new i.Color(1,1,1),e.range=10,e.intensity=10,e.innerConeAngle=0,e.outerConeAngle=45,e}return o(e,t),e}(a.Container3D);e.Light=s},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageBasedLighting=void 0;var a=i(n(0)),u=function(){function t(t,e,r){this._diffuse=t,this._brdf=r||a.Texture.from(n(75).default),this._specular=e}return Object.defineProperty(t.prototype,"diffuse",{get:function(){return this._diffuse},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"brdf",{get:function(){return this._brdf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"specular",{get:function(){return this._specular},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._diffuse.valid&&this._specular.valid&&this._brdf.valid},enumerable:!1,configurable:!0}),t}();e.ImageBasedLighting=u},function(t,e,n){"use strict";n.r(e),e.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAIAAABMXPacAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wsXDggToON7ZwAAFfZJREFUeNrNXWuv2zqSrKaU3ExwL7DA/Pv9pQvEIveD+OgnRck+Z8Y4MCiKkq2q6uomJSf0v3//lV+vQlSAUlAQ/BUUALIT8QB4w0SjBP2toTrte7irjMPd93nn4t71Abyh2q+cd7xe5XVYrO0fvH7FwTXuvBFzcBv0hfeVXY/7nzFBwE5ERABAHTsKOKBxApJA1x6qmPa9xMaQbPTxdjBN3xUfasDYW8TIiIBvQ9wNggzsBFABkRgRvhoG/WplN2+5x13vUFivfB33EGLsOtwzttxNeP2PG4oJDt1OBOIdF4DVXTOApuBpmFpg+SAuBMQkUC47J5ufwhrTTtQIuItjE1d43KKAg89aOXqJAwKVVcl/UOmLnZIA96Kv4mAdU9XnxgGVG/JfHcY4mMN9C+KogQXVxxHwaQ6IRkU4OYHKHxHWt6xGwEoglrfmKK9gvWg10QC1KS3oEQeP88Hi+LvnmB9uozBKAGoXvL2TTsTRI5OwcqUv8CLXW9zTrOSPlUoGKkRY0nrHZ2itE1PJGwuyVdBNDnqMX2C2/LpV3sw3B7IElBugT/Yuthd3BVXQAgcioT/KyQ8Gz/3EBoSwApkMLL7vgz4hIOqpBDgqvhMHXWLrsNrhQrlmGjXXO64iANND4EUGPHpUewJ6AdICJSMCuvmu52Rd1d6PA7eytIMnBeicA4WpMiKFF7wgmKBvM2qZbl4Q0L+4uMjlOChmPuHPPm560WRyEEEPM0Z8GWZE8JjAVLYrrnKrxyRhY/RqLjOGQasJ8gonsK7XOWBxeWlB8CIAUTRIOFZcZRHc9WEE7DAIWoDUNPVazu/l5EVnm3+IncSBkcqDAJK8+ablyTUZW9dEXzVYiiBzEOsRn+GV2G9y4C5UTGZ8l/MgWOGb5awH9j25vnIFwDmATgLgcnDVc30xVxe56EWcA6ffO9ndSuYWvoues7ILKgkXD3GacgCJtTbZOF1PBkwI6U5IV5KPNu13i5zEmR4tALrOBFUCaNyNITjmo1ixqNnrsTKfXA+m0nbtO8q6l7jrAc3ZFOi3UvRdhtQrzgHBZmk9ZDgobuf9OdrFKFMRrMgfU0zhHRsBGiopPiS6HIgqSKGshO+VRjC3ZYpXs77JQVTPIG4jNhYNYhS4mHV+8DWSsCq61aXbgD0HOCVQMFUOuVngQPNhJgeInQextPneFV3bo9556Rxg4XM3+z0Wkj0kPce/Zynl5syPLidxJuXMvy//qlFpqKJzEdlbhE0GNwvisrVa8sJC5G1565VzYPsnl6jKzXCM98Xm2u/9FJ/0WSg8OwRqHjABWn2/c5O4NUEscl3GgZurRdtwEE4TZQUFw906NAVIj3C8RBlTD5RrQWc9Gs1teMVGAAQN50nUbMAPDjhzNOeLX3lBdy1dJUtYVz7k9ozkCm5aGAaxFsSsfDK/POmxEzdioaDSspt7xZdd4yAaPq9SLiOAFnrWob+1tyXhvs19JuIA+lkH51afSct93zzr+iSVeYf3DWMgLlz+Kj/d3UULnTuaBfFlwgkHapidnRbolAA5Tbs9VY4voMiT3Dr2Maz8A1cgdjt7RdAioINIsxwAply7yY0e3hNRyvrD2tde6ApGT008OsktXSNgV5Fk2zskZFBpbepFonSzD8O6a2em4OP9kJ92G9mncTDftRI38x63PSZiIC3kyUzflkk2AxdLqqwdfd+flEaP1H03A0czFYqPWsc9+rgWAR3KBfkLFauUe06qi+AA3nJFKfo7XUzTFtUdDIukrSwiTY9aZ2JlU0fAgF7J39W7bBObAZwjRQLwpqx2AeCdfOD6+IpRrCO+uOvusF186QaluNqFtFziTfQMAYOLXVm6w8HMr68KUzKnFNbsUbiC8sp4nQN6cxT4FvomXZJy1rcJ1fP4fGIhL2x0RlhPOaCVOLhpII8xpbW9ve0kYW4dOhO48uflTbB6YQshyI+4xnri5it5MjCiVZGaw99Bf9IYEYAr+Yedqv6RaRneXeVieuaAOv0r+AZ+tSjVB2jeIqZZEOuuCeBK/itlUgnygYUm4qB3hhDP974hzzfhXhygcwDaTLg4SzbXHPAcwM85OICE2Moz4IDi4Lhut8OfgCsJdsF9k4yiImDmQiu+pPiQ1+DY0UpkmE7XZG7h+/EBz8Y7ESAaHvThYpHyH+gZw/gSCk3PixzJT4D2dCoa94W8iO9HTrLrDnHfJCRjVD5BWh4FlQFde7dXF61wcEN3yxzozscHLo8ZEVDYSlxpeq//bEFHPIJ+OlvmY4pEMwJXcTAR+9ys13FZP/zuSeZjdt3dJG+nAqpHSHuhNLLCJ8+L3AEUD7uUKsmz3YL+/QGXR+2g9hhEq39K7ELFQB+tIFF0cw0MQYWaCosIbnbUZyH2373TXn7KIiWlW1CBQL/bTm2U8ayK5WAEhOwku6xk/cekaFrh4D0o58M+8EFrPJ3rgCIJ6wjoYEnQBRmyoeF2Papt+qBbxQWsuMmAyrvA2dO+ifXkvQB76Z9wGQGB+TgLR24a8PzHhzjmYO4Mqt+5Zs++Lsn47Lsm4ESwoP6BQdfR58IfUQLRWJypUdDWgFqkJEkzDmLsJmL/Bujdj5BVUBllKE/FxaLPClOARU87FXnEdM9x/cdyoPBdlWo7vz9mvnd6yPxzH/BXLahGgPEclYG7EYURwFQ/HvjpVhPl3oAD6+mTsLiU/DwIbsXNA6BnBJyn6dCjG1GR1lTEHE1EwMLCUSeDoDvJa1vQOeLXHKiTvEfD1xJQ+jygyVdAL3Ef72ChwDa56guCKojz4XHAQXcpsYjfa6y50GNW7IBpBEDDzecEKiV0uKPJWukal/0C9/bhM+0bCc/a7uArnu4CfTcOIuh5/yhDu9V0DjIME13EZrmCiHVa4XMy0HCRHFg/6SRZ1asQ4SeZQ2yxWHenZ+lhEhNpWBBYEjZMwKQBmPex9NbiwzEfq/qOI/cELw4UxD4HMJuKNg7EdyWJaMDZSKIKKqbBcC9K9VzaaLruj7ZR5aBvgjUgOdCNqzYhwH3NtVa0/3F3ciOg5QAy2g+C4HwViTua2EuLgNLIuMgEHa8OqxcHrrrJ8GEHOPxdYf0R3C+jgb8XYM+MgFyQqTbCGrTh3j2n9PqnP5dIjAM4ZJA0JRUH2n9MMnA5cGzKEHML/U/5zyQ4RARkV/4sCIb8PfRF/dPtSEbAcCEJLg8Iq9kVIwp9aRIfb5ez78gfQDr/7ehCKEn8a90Zgg/wIJi/JDEKfa33Bj1J6IXkOdaR4cxjwu15lAbuIs69PnqvSTjTAP00nyxD4TxC1aBa/sx5eBUk7Ejp3ap+wkoUEG1h/VZMvGk+t4JgMjIDe0nSggi5tM2+5NCCYJzSe1GLEjHKlq22s1GioE+tJ6ldkzYukvMkBzwz/Wc5AEDSZWgQAfAqH27lXf717N5EwXUh8uKgN5KL3QK40VGLQfCluNuT7Pm0IELONeuOCODVp4wmV/4gnaUh/YfsBK25mW84C0ak2ousID7qe9DHyAHNgkpCLsi2HJJ+UvrvmSDNfUKPGw0sDiwHyQuL04jSCtbzKVvc+W3aR88BmZAZ9JYAHgHcwIf2TX5Wwh/csDg4N30OPBAvHWkd9Fv+E1nHY9Wr89QcoNDXNaiUsiWBTH7W8WETeLcjy8FCNIRJIgKdgOLUS4s0fBb33pmAPacWAfmagAme/DVmxR7WIeLtPTEOEiTiVubRvOxqMeNZBHwEd2FB5zygADmhZEEAzC8pHNzdJTmbHiT6kJ4TadZhQu29sv457ovQv2/3LivVgnJCJhxABo6EXFohVNo6c1c+g9SVvwGcMSEJ63oHgeAEgUoGggmDsutFn4X+I7bDYWAEEHJC8SwI1n+CH8gRRoGkFyFkcBBEHIi1h8CIkge0sKOr1SEs0HAL+ruIR5syApLgQGi/GDxJkGMqe8m2e1OsZwKwTGsioOcAy8dE/hWjqSMh7tRYl3DvCu4LBPQkfDYKSkY5cwTHsd1g6VeOdpE9YWj0FeIQoOs7Ym4Z6gbB2lT50n8mfEzkf5eAyeawoJxxnO+ok7JS5H9AwBLmCXNuHBQmc651/mEqDsQ8AHHpKct8Jwgm1VH7tFF6Brch16F/4PvzgKgRcFBDPyFnPQur8uwu1GakwHhgtBuVY/58Lsagh2viEvcTaJV1dSa4+YegcRfudclPhgkLOjBcqJZAjQcut6H9VqSWnpyL/mDn1b1I8tFDIc3JUCGyzAQWOIiE/KbkhQ1IMAYBR0YmHQF9UIEAAkAmpK59+b+vwnxGB3rgDmY+CFd+VBAkSQZ58fEmB2+KPULc5eBs7EfCkZCBAzhyXZIrzIaovZ9XmwtSmyLU/49WTdbI44EL37Ii0U9ePrDFqC6HvKoUCzSscLC4edmvxrQckHCgzsVqCaQk3Dw+l5aYT9UXnTDQskJSZwC7Ee+GAsIgEPmWB0E0SY4Rf5YGngG9eOx+nBYE5NIsKDH3739NdJmAUv2nNDLAc4b8JNUeMy/Zk04JG1Pi8ldpIII+ukOJmIMZE0V3RnKOdk32jgg40T9ynRX3GUC91AI6QS91xlvl33D3Zsf6k8T188TOmEgsN4x8q9C3/uOtC/XYdZfk1oNgUe+POdiPhIPwai5UTgtKwvrrV+zaZ4jXCMhs0/vSloPEA8KFkrVnSfiO/8xxd1Auq0zcIoN/3H5sODaWAzJKEuk3Mflz7fMIQBJ5GwWUfQ7En6qOlB0pr/cW41bmAVgm4M0g4PiucMMiIOEojQBUTEmWQANZ4z/n6p1OXGlwYCHmedX6ybAgmHpUxcpaDTrh4DEBdzmINlsVJAnomBK3nbZSfR4pbljyCMjtChNIEuNIHtriE68442SrXAhrBOiGSbAu3CuqjzR+ubkfWyOg4FwX6kqv8Mk5QS092Y1jDv2pfXTtNw6EulkCiNw8UTBA5tvFu5I2Auz7x6FXQEc9+5HwSjgKXmX4z6nitA3zoS7/k4MkjKgi3uFm2odZeBheb6JhjFEzL6/OWU+/Su8PnOcd6CMmaETAhtcZAY2A01tLm/RSd55SyyQxAcugs2rKbQE1g1Lzos5Kl/95vwVjM7XHxJIr8N7J66Ivy71j0yxtzRPAAyYA7K8zAs65GI3bMYnl3lM+Q++EkpnzoAUBi4DKCof+BF3GAS/8Oe4Dejg1z8r6zwMCbsn/Et+5HfVvUnPAK7UMjGE49YnM5jzEsjEwzKrfNqgxLkFX76ftdEUP6N3k7C1KLy5BTwhYkv8Vjo+zrk7Cr21EQH++6tTmMB9T+4OA3O6xZOY5qXFwyr9Dz2/2NmlzYxkuFC+3XaM//aleRMM7wr+FtduzH6nmgP4oCpr1K/PhKbcwDupVnY0T9DQaKYOo5VvvGYjIhXgjBSiPxOA9frsu/P8I9Gcni4BmLMRMpkY9qzX77eJ6N6ZnqgwiIIEAnOh366cmeXPnPSkXmjwINFl/NpIfm7LSvyH/4nV+FP0WARvOPHw+mE55+A9answFKbcIOD2H2kRXJcMOfQKhyl+TUczaTnehsyEr0WTiw6VnXf6RzD9u9xPh9/f9da4Fnc/EZXbLl2m/33s5I6CaD0A05lz91BUdDj3JVX552z1x+SurwYB+/jzEHH1f+IHGn0F/F/3+qhb02moJRBj+c2o/A1tu97lYBBRiqw7d2YO/1Iyogug9BuoK/EHN86zsWaThMdBRZyMgsV+bMiYK6rwX3IIY9EOkiYFVhvXrhveYyeyx3PsEuOivFzxR55vQR/37K+FPQk4oaA9wl6ry3DbrM0K5PefcAO3npTZPHgmgMNB5xdL/WBU05sA9B8SOf/kkqEvACvSL5nOLjMtdIwewn66Me7/13kuW6ddGfalBoOSfuOd4D75Nnqly/haeeltBfx36y813oD/37q8NfxLyVpE9e+sPV3v5n9pKw4GeKzT0pYk66XyQeA5gZOibLVc/d3Ghn6D/HPriAHcX+su952s/JwE5ATQqjUxiyaGuN5zyP8a8CZ0AxoGy/oE7m+UmiJhIrrF4T0VYPX4E/Qeq/wj66Em4bPVuOwDi/35KX23O0vR7gy0Tdflz0HWjEyPv9yr3f/+Zwzn6i3b/ddD3MY2AU1yEdKLf/92sfnvgaLn3aKcowZ+VP5oFWU93y/+bRvRM/lHnBMRnfMyH7a+EY0NBBav+XgO1KKo3hI9qPj7uWfi7rj7ZjRcdGUVMr6K8+hn046WFS9U/zrErI/c/Ca8EnA/YnvVoI6A08wEBh7gejn7Num3qi4n/gDFx52Y63kT/qvGl0M8HVwsiAraGPrF5bwEO0CEvuzDQ3YVPmXgH9DRF3Hu4U+VeVf/cRX/R+j8I/eX4+lgKEWhD3lASSv/dRZN/RxO94EkM/TTkrysfHgERB5fP0soBLhPUfGYF/Wc1zwPoVw7ZX4QjIW3IO8qOktpBp8CPkXX7fcpKwIZUkJK37tathoOuAsIs0kVpAPCzMeQYLEQAngr/K6BvBCQcG7Aj/2QENPM5r687T73Tm4bh+NC3IICKAGrfjBnLiuO7l+TSsIq+N6V4E8pnh+wvwrEBP7F1AsCebOhr8aWqnjoHdPWnIiCwoPp91S8Rp3e4esTAYyhCdrXyKeGwz0JfCTgIx4b0E+Unyo92h72ADuBlCh4a0EPRACcOQJ77x6kYpg3ZuQKuS8Z6+v026BsBCfkH8k+UX8De/OcYzlMXQZn5uPJP0mqcTOvhq+ocq2sX9Mi13Pe76H8b9JWAFyH/QPmF8gvYmvxT8+sT+mygNxwIsWNscggFDa1/AuVE4Krfxf2r0X8H90FAJuSfwC/gL6BV9936kWstBCZ/JGM7LMFSy9sdcatZ8B5vjupm15XMPEHnWf3zddBXAo6E8gvlN/ADICBX6x9laGw7o0YiR9SuC4304KVQnn4vr/Mbqs8vhb4SkBPwG/hd/WesNp/ob40DYsI3kyxAB0QPAn3xkiE0xDWa3ux3koRXGHoT/Y9DXwkoO/A38C+AQF3+GbQBG+glPKdLHhhwgxis7DnDkcaD2gZyfktM+xx6C8S85vm4mXwR9JWA/BfSP8AvEBj6zO4RZ92BCM+3PLX25MwG86PcKxwBFP/4725+fgzll6IPYC+/gX9AP4BjaJ+2pvoki5ymMeHmYL/DJilqFwgSbZWEXQhWKpZL+d81n6+G/nzt+Af0N1BAL1CpBQ+Sdp6hVhLSBvf982Wy6wQjy9Akiy4ysfj6b0AfwI7/AX4DfwAAx5jfwpq+iQCLZn1uxUBMcowF173sSxRu+c/669vQB5Dwb9BfoB20Nd9n6CtnBwYHrmJ7TPRM4FyZipj+VPba9Ys4uMvYf99rL/8uBcCfeitGwc3/x4b+6wHxr0Owdn+OqP+bBbUXrF3iM9jO4MAC9q/j8IZ6Zw1bX0UZ/ptJ3Pff+4//w55oJ+wJW8JG2HqD2uaGLSElpA3bhpTZX2l/uT3kXNj9XrAbaqf22zMWvFFn4O29/vqD//6SwU39n2gpU9wVhYg3F3d9+lVy/n9jYs5HdicqpQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMS0yM1QxMzowODoyOSswMTowMMdwaqMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTEtMjNUMTM6MDg6MTkrMDE6MDA4otX8AAAAAElFTkSuQmCC"},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.StandardPipeline=void 0;var c=u(n(0)),f=n(40),l=n(41),d=n(42),h=n(24),p=n(15),_=n(16),m=function(t){function e(e){var n=t.call(this,e)||this;return n.renderer=e,n._renderPasses=[],n._meshes=[],n._shadowPass=n.addRenderPass(new l.ShadowRenderPass(e,"shadow")),n._materialPass=n.addRenderPass(new f.MaterialRenderPass(e,"material")),e.on("prerender",(function(){var t,e;try{for(var r=s(n._renderPasses),o=r.next();!o.done;o=r.next()){var i=o.value;i.clear&&i.clear()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}})),n}return o(e,t),e.from=function(t){return t.plugins.pipeline},e.prototype.addRenderPass=function(t){return this._renderPasses.indexOf(t)<0&&this._renderPasses.push(t),t},e.prototype.removeRenderPass=function(t){var e=this._renderPasses.indexOf(t);e>=0&&this._renderPasses.splice(e,1)},e.prototype.createPostProcessingSprite=function(t){var e=new d.PostProcessingSprite(this.renderer,t);return this._materialPass.renderTexture=e.renderTexture,e},e.prototype.render=function(t){this._meshes.push(t)},e.prototype.flush=function(){var t,e;this.sort();var n=function(t){t.render(r._meshes.filter((function(e){return e.isRenderPassEnabled(t.name)})))},r=this;try{for(var o=s(this._renderPasses),i=o.next();!i.done;i=o.next()){n(i.value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this._meshes=[]},e.prototype.sort=function(){this._meshes.sort((function(t,e){return t.material&&e.material&&t.material.renderSortType!==e.material.renderSortType?t.material.renderSortType===_.MaterialRenderSortType.transparent?1:-1:0}))},Object.defineProperty(e.prototype,"shadowPass",{get:function(){return this._shadowPass},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"materialPass",{get:function(){return this._materialPass},enumerable:!1,configurable:!0}),e.prototype.enableShadows=function(t,e){var n,r,o=t instanceof h.Model?t.meshes:[t];try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var u=a.value;e&&u.material instanceof p.StandardMaterial&&(u.material.shadowCastingLight=e),u.enableRenderPass(this._shadowPass.name)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e&&this._shadowPass.addShadowCastingLight(e)},e.prototype.disableShadows=function(t){var e,n,r=t instanceof h.Model?t.meshes:[t];try{for(var o=s(r),i=o.next();!i.done;i=o.next()){var a=i.value;a.material instanceof p.StandardMaterial&&(a.material.shadowCastingLight=void 0),a.disableRenderPass(this._shadowPass.name)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e}(c.ObjectRenderer);e.StandardPipeline=m,c.Renderer.registerPlugin("pipeline",m)},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowFilter=void 0;var a=i(n(0)),u=n(8),s=n(6),c=function(){function t(t){this.renderer=t,this._mesh=s.Mesh3D.createQuad(),this._gaussianBlurShader=new u.MeshShader(a.Program.from(n(78).default,n(79).default))}return t.prototype.applyGaussianBlur=function(t){this.applyBlurScale(t.shadowTexture,t.filterTexture,new Float32Array([0,t.softness/t.shadowTexture.height])),this.applyBlurScale(t.filterTexture,t.shadowTexture,new Float32Array([t.softness/t.shadowTexture.width,0]))},t.prototype.applyBlurScale=function(t,e,n){this.renderer.renderTexture.bind(e),this.renderer.renderTexture.clear(),this._gaussianBlurShader.uniforms.u_FilterSampler=t,this._gaussianBlurShader.uniforms.u_BlurScale=n,this._gaussianBlurShader.render(this._mesh,this.renderer),this.renderer.renderTexture.bind(void 0)},t}();e.ShadowFilter=c},function(t,e){t.exports="#version 100\n\nattribute vec3 a_Position;\nattribute vec2 a_UV1;\n\nvarying vec2 v_UV1;\n\nvoid main() {\n  v_UV1 = a_UV1;\n  gl_Position = vec4(a_Position, 1.0);\n}"},function(t,e){t.exports="#version 100\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying vec2 v_UV1;\n\nuniform vec2 u_BlurScale;\nuniform sampler2D u_FilterSampler;\n\nvoid main() {\n  vec4 color = vec4(0.0);\n\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-3.0) * u_BlurScale.xy)) * (1.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-2.0) * u_BlurScale.xy)) * (6.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(-1.0) * u_BlurScale.xy)) * (15.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+0.0) * u_BlurScale.xy)) * (20.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+1.0) * u_BlurScale.xy)) * (15.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+2.0) * u_BlurScale.xy)) * (6.0/64.0);\n  color += texture2D(u_FilterSampler, v_UV1 + (vec2(+3.0) * u_BlurScale.xy)) * (1.0/64.0);\n\n  gl_FragColor = color;\n}"},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowRenderer=void 0;var a=i(n(0)),u=n(25),s=n(83),c=n(84),f=function(){function t(t){this.renderer=t,this._state=Object.assign(new a.State,{depthTest:!0,clockwiseFrontFace:!1,culling:!0,blendMode:a.BLEND_MODES.NONE}),this._shadowShader=new u.ShadowShader(this.renderer)}return t.prototype.render=function(t,e){var n=this._shadowShader;t.skin&&t.geometry.joints&&t.geometry.weights&&(this._skinningShader||(this._skinningShader=new s.SkinningShader(this.renderer)),n=this._skinningShader,t.skin.joints.length>this._skinningShader.maxSupportedJoints&&(this._textureShader||c.TextureShader.isSupported(this.renderer)&&(this._textureShader=new c.TextureShader(this.renderer)),n=this._textureShader)),n&&(n.updateUniforms(t,e),n.render(t,this.renderer,this._state))},t}();e.ShadowRenderer=f},function(t,e){t.exports="#version 100\n\n#define FEATURES\n\nattribute vec3 a_Position;\n\n#ifdef USE_SKINNING\nattribute vec4 a_Joint1;\nattribute vec4 a_Weight1;\n#endif\n\nuniform mat4 u_ViewProjectionMatrix;\nuniform mat4 u_ModelMatrix;\n\n#ifdef USE_SKINNING\n  #ifdef USE_SKINNING_TEXTURE\n    uniform sampler2D u_jointMatrixSampler;\n  #else\n    uniform mat4 u_jointMatrix[MAX_JOINT_COUNT];\n  #endif\n#endif\n\n// these offsets assume the texture is 4 pixels across\n#define ROW0_U ((0.5 + 0.0) / 4.0)\n#define ROW1_U ((0.5 + 1.0) / 4.0)\n#define ROW2_U ((0.5 + 2.0) / 4.0)\n#define ROW3_U ((0.5 + 3.0) / 4.0)\n\n#ifdef USE_SKINNING\nmat4 getJointMatrix(float boneNdx) {\n    #ifdef USE_SKINNING_TEXTURE\n    float v = (boneNdx + 0.5) / float(MAX_JOINT_COUNT);\n    return mat4(\n        texture2D(u_jointMatrixSampler, vec2(ROW0_U, v)) * 2.0 - 1.0,\n        texture2D(u_jointMatrixSampler, vec2(ROW1_U, v)) * 2.0 - 1.0,\n        texture2D(u_jointMatrixSampler, vec2(ROW2_U, v)) * 2.0 - 1.0,\n        texture2D(u_jointMatrixSampler, vec2(ROW3_U, v)) * 2.0 - 1.0\n    );\n    #else\n    return u_jointMatrix[int(boneNdx)];\n    #endif\n}\n\nmat4 getSkinningMatrix()\n{\n    mat4 skin = mat4(0);\n    skin +=\n        a_Weight1.x * getJointMatrix(a_Joint1.x) +\n        a_Weight1.y * getJointMatrix(a_Joint1.y) +\n        a_Weight1.z * getJointMatrix(a_Joint1.z) +\n        a_Weight1.w * getJointMatrix(a_Joint1.w);\n    return skin;\n}\n#endif\n\nvoid main() {\n  vec4 pos = vec4(a_Position, 1.0);\n  #ifdef USE_SKINNING\n    pos = getSkinningMatrix() * pos;\n  #endif\n  gl_Position = u_ViewProjectionMatrix * u_ModelMatrix * pos;\n}"},function(t,e){t.exports="#version 100\n\n#extension GL_OES_standard_derivatives : enable\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvoid main() {\n  float depth = gl_FragCoord.z;\n  float dx = 0.0;\n  float dy = 0.0;\n\n  #ifdef GL_OES_standard_derivatives\n    dx = dFdx(depth);\n    dy = dFdy(depth);\n  #endif\n\n  float moment2 = depth * depth + 0.25 * (dx * dx + dy * dy);\n  gl_FragColor = vec4(1.0 - depth, 1.0 - moment2, 0.0, 0.0);\n}"},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.SkinningShader=void 0;var s=u(n(0)),c=n(7),f=function(t){function e(e){var n=this,r=c.Platform.getMaxVertexUniformVectors(e)-8,o=Math.floor(r/4);return(n=t.call(this,e,["USE_SKINNING 1","MAX_JOINT_COUNT "+o])||this)._maxSupportedJoints=o,n}return o(e,t),Object.defineProperty(e.prototype,"maxSupportedJoints",{get:function(){return this._maxSupportedJoints},enumerable:!1,configurable:!0}),e.prototype.createShaderGeometry=function(e){var n=t.prototype.createShaderGeometry.call(this,e);return e.joints&&n.addAttribute("a_Joint1",new s.Buffer(e.joints.buffer),4,!1,e.joints.componentType,e.joints.stride),e.weights&&n.addAttribute("a_Weight1",new s.Buffer(e.weights.buffer),4,!1,e.weights.componentType,e.weights.stride),n},Object.defineProperty(e.prototype,"name",{get:function(){return"skinned-shadow-shader"},enumerable:!1,configurable:!0}),e.prototype.updateUniforms=function(e,n){if(t.prototype.updateUniforms.call(this,e,n),e.skin){var r=e.skin.calculateJointMatrices().jointVertexMatrices;this.uniforms.u_jointMatrix=r}},e}(n(25).ShadowShader);e.SkinningShader=f},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureShader=void 0;var s=u(n(0)),c=n(25),f=n(21),l=256,d=function(t){function e(e){var n=t.call(this,e,["USE_SKINNING 1","USE_SKINNING_TEXTURE 1","MAX_JOINT_COUNT "+l])||this;return n._jointMatrixTexture=new f.StandardMaterialMatrixTexture(l),n}return o(e,t),Object.defineProperty(e.prototype,"maxSupportedJoints",{get:function(){return l},enumerable:!1,configurable:!0}),e.isSupported=function(t){return f.StandardMaterialMatrixTexture.isSupported(t)},e.prototype.createShaderGeometry=function(e){var n=t.prototype.createShaderGeometry.call(this,e);return e.joints&&n.addAttribute("a_Joint1",new s.Buffer(e.joints.buffer),4,!1,e.joints.componentType,e.joints.stride),e.weights&&n.addAttribute("a_Weight1",new s.Buffer(e.weights.buffer),4,!1,e.weights.componentType,e.weights.stride),n},Object.defineProperty(e.prototype,"name",{get:function(){return"skinned-shadow-shader"},enumerable:!1,configurable:!0}),e.prototype.updateUniforms=function(e,n){if(t.prototype.updateUniforms.call(this,e,n),e.skin){var r=e.skin.calculateJointMatrices().jointVertexMatrices;this._jointMatrixTexture.updateBuffer(r),this.uniforms.u_jointMatrixSampler=this._jointMatrixTexture}},e}(c.ShadowShader);e.TextureShader=d},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CubemapLoader=void 0;var a=i(n(0)),u=n(26);e.CubemapLoader={use:function(t,e){if("cubemap"!==t.extension)return e();var n=this,r=t.data.map((function(e){return u.Cubemap.faces.map((function(n){return t.url.substring(0,t.url.lastIndexOf("/")+1)+e.replace("{{face}}",n)}))})),o=r.reduce((function(t,e){return t.concat(e)}),[]);n.add(o.filter((function(t){return!n.resources[t]})).map((function(e){return{parentResource:t,url:e}})));var i=0,s=n.onLoad.add((function(e,n){if(o.includes(n.url)&&++i===o.length){var c=r.map((function(t){return{posx:a.Texture.from(t[0]),negx:a.Texture.from(t[1]),posy:a.Texture.from(t[2]),negy:a.Texture.from(t[3]),posz:a.Texture.from(t[4]),negz:a.Texture.from(t[5])}}));t.cubemap=u.Cubemap.fromFaces(c),s.detach()}}));e()},add:function(){a.LoaderResource.setExtensionXhrType("cubemap",a.LoaderResource.XHR_RESPONSE_TYPE.JSON)}},a.Loader.registerPlugin(e.CubemapLoader)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MipmapResource=void 0;var i=n(87),a=n(88),u=n(22),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.target=n,r}return o(e,t),e.prototype.upload=function(t,e){for(var n=0;n<this.items.length;n++){var r=this.items[n].resource;r instanceof u.BufferResource&&t.gl.texImage2D(this.target,n,e.format,r.width,r.height,0,e.format,e.type,r.data),r instanceof a.BaseImageResource&&t.gl.texImage2D(this.target,n,e.format,e.format,e.type,r.source)}return!0},e}(i.ArrayResource);e.MipmapResource=s},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayResource=void 0;var a=i(n(0));e.ArrayResource=a.ArrayResource||a.resources.ArrayResource},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseImageResource=void 0;var a=i(n(0));e.BaseImageResource=a.BaseImageResource||a.resources.BaseImageResource},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.CubemapResource=void 0;var i=function(t){function e(e,n){void 0===n&&(n=1);var r=t.call(this,e)||this;return r.levels=n,r}return o(e,t),e.prototype.style=function(t){var e=t.gl;return e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),this.levels>1?e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR):e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),!0},e}(n(90).CubeResource);e.CubemapResource=i},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.CubeResource=void 0;var a=i(n(0));e.CubeResource=a.CubeResource||a.resources.CubeResource},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.ShaderSourceLoader=void 0;var u=i(n(0)),s=["glsl","vert","frag"];e.ShaderSourceLoader={use:function(t,e){if(!s.includes(t.extension))return e();e()},add:function(){var t,e;try{for(var n=a(s),r=n.next();!r.done;r=n.next()){var o=r.value;u.LoaderResource.setExtensionXhrType(o,u.LoaderResource.XHR_RESPONSE_TYPE.TEXT)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},u.Loader.registerPlugin(e.ShaderSourceLoader)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Skybox=void 0;var i=n(93),a=n(6),u=n(1),s=n(26),c=function(t){function e(e){var n=t.call(this)||this;return n._mesh=n.addChild(a.Mesh3D.createCube(new i.SkyboxMaterial(e))),n}return o(e,t),Object.defineProperty(e.prototype,"camera",{get:function(){return this._mesh.material.camera},set:function(t){this._mesh.material.camera=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cubemap",{get:function(){return this._mesh.material.cubemap},set:function(t){this._mesh.material.cubemap=t},enumerable:!1,configurable:!0}),e.from=function(t){return new e(s.Cubemap.fromFaces(t))},e}(u.Container3D);e.Skybox=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.SkyboxMaterial=void 0;var s=u(n(0)),c=n(8),f=n(5),l=function(t){function e(e){var n=t.call(this)||this;return n._cubemap=e,n.state=Object.assign(new s.State,{culling:!0,clockwiseFrontFace:!0,depthTest:!0}),n}return o(e,t),Object.defineProperty(e.prototype,"cubemap",{get:function(){return this._cubemap},set:function(t){t!==this._cubemap&&(this._cubemap.valid||(this._shader=void 0),this._cubemap=t)},enumerable:!1,configurable:!0}),e.prototype.updateUniforms=function(t,e){var n=this.camera||f.Camera.main;e.uniforms.u_ModelMatrix=t.worldTransform.toArray(),e.uniforms.u_View=n.view,e.uniforms.u_Projection=n.projection,e.uniforms.u_EnvironmentSampler=this.cubemap},e.prototype.render=function(e,n){n.gl.depthMask(!1),t.prototype.render.call(this,e,n),n.gl.depthMask(!0)},e.prototype.createShader=function(){var t=n(94),e=n(95);if(this.cubemap.valid)return new c.MeshShader(s.Program.from(t,e))},e}(n(23).Material);e.SkyboxMaterial=l},function(t,e){t.exports="attribute vec3 a_Position;\n\nvarying vec3 v_Position;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\nvoid main() {\n  v_Position = a_Position.xyz;\n\n  // Converting the view to 3x3 matrix and then back to 4x4 matrix \n  // removes the translation. We do this because we want the skybox to \n  // be centered around the camera.\n  gl_Position = u_Projection * mat4(mat3(u_View)) * u_ModelMatrix * vec4(a_Position, 1.0);\n}"},function(t,e){t.exports="varying vec3 v_Position;\n\nuniform samplerCube u_EnvironmentSampler;\n\nvoid main() {\n  gl_FragColor = vec4(textureCube(u_EnvironmentSampler, v_Position).rgb, 1.0);\n}"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PickingHitArea=void 0;var r=n(97),o=function(){function t(t,e,n){this.object=e,this.camera=n,this.id=r.PickingId.next(),this._manager=t.plugins.picking}return t.prototype.contains=function(t,e){return this._manager.containsHitArea(t,e,this)},t}();e.PickingHitArea=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PickingId=void 0,function(t){var e=0;t.next=function(){return e++,new Uint8Array([e>>16&255,e>>8&255,255&e])}}(e.PickingId||(e.PickingId={}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.PickingManager=void 0;var a=i(n(0)),u=n(99),s=function(){function t(t){var e=this;this.renderer=t,this._hitAreas=[],this._map=new u.PickingMap(this.renderer,128*Math.floor(this.renderer.width/this.renderer.height),128),t.on("postrender",(function(){if(e.renderer.plugins.interaction.hitTest(new a.Point(0,0)),0!==e._hitAreas.length){var t=Math.floor(e._map.height*(e.renderer.width/e.renderer.height));e._map.width!==t&&e._map.resize(t,e._map.height),e._map.update(e._hitAreas),e._hitAreas=[]}}))}return t.prototype.containsHitArea=function(t,e,n){return this._hitAreas.indexOf(n)<0&&this._hitAreas.push(n),this._map.containsId(t,e,n.id)},t}();e.PickingManager=s,a.Renderer.registerPlugin("picking",s)},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.PickingMap=void 0;var u=i(n(0)),s=n(5),c=n(6),f=n(8),l=function(){function t(t,e,r){this._renderer=t,this._update=0,this._pixels=new Uint8Array(e*r*4),this._output=u.RenderTexture.create({width:e,height:r}),this._shader=new f.MeshShader(u.Program.from(n(100).default,n(101).default)),this._output.framebuffer.addDepthTexture()}return t.prototype.resize=function(t,e){this._pixels=new Uint8Array(t*e*4),this._output.resize(t,e)},t.prototype.containsId=function(t,e,n){t=Math.floor(t/this._renderer.width*this._output.width),e=Math.floor((this._renderer.height-e)/this._renderer.height*this._output.height);for(var r=0;r<3;r++)if(n[r]!==this._pixels[4*(e*this._output.width+t)+r])return!1;return!0},Object.defineProperty(t.prototype,"width",{get:function(){return this._output.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._output.height},enumerable:!1,configurable:!0}),t.prototype.update=function(t){var e,n,r,o;if(this._renderer.renderTexture.bind(this._output),this._update++%2==0){this._renderer.renderTexture.clear();try{for(var i=a(t),u=i.next();!u.done;u=i.next()){var f=u.value,l=f.object instanceof c.Mesh3D?[f.object]:f.object.meshes,d=f.camera||s.Camera.main;try{for(var h=(r=void 0,a(l)),p=h.next();!p.done;p=h.next()){var _=p.value;this._shader.uniforms.u_World=_.transform.worldTransform.toArray(),this._shader.uniforms.u_Id=f.id,this._shader.uniforms.u_ViewProjection=d.viewProjection,this._shader.render(_,this._renderer)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}else{var m=this._renderer.gl;m.readPixels(0,0,this._output.width*this._renderer.resolution,this._output.height*this._renderer.resolution,m.RGBA,m.UNSIGNED_BYTE,this._pixels)}this._renderer.renderTexture.bind(void 0)},t}();e.PickingMap=l},function(t,e){t.exports="#version 100\n\nattribute vec3 a_Position;\n\nuniform mat4 u_World;\nuniform mat4 u_ViewProjection;\n\nvoid main() {\n  gl_Position = u_ViewProjection * u_World * vec4(a_Position, 1.0);\n}"},function(t,e){t.exports="#version 100\n\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nuniform vec3 u_Id;\n\nvoid main() {\n  gl_FragColor = vec4(u_Id / 255.0, 1.0);\n}"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowCastingLight=void 0;var r=n(10),o=n(7),i=n(103),a=n(27),u=n(104),s=function(){function t(t,e,n,o,u,s){if(void 0===u&&(u=0),void 0===s&&(s=a.ShadowQuality.medium),this.renderer=t,this.light=e,this.shadowArea=o,this.softness=u,this._lightViewProjection=new Float32Array(16),this.followCamera=!0,e.type===r.LightType.point)throw new Error("PIXI3D: Only directional and spot lights are supported as shadow casters.");this._shadowTexture=i.ShadowTexture.create(t,n,s),this._shadowTexture.baseTexture.framebuffer.addDepthTexture(),this._filterTexture=i.ShadowTexture.create(t,n,s)}return Object.defineProperty(t.prototype,"lightViewProjection",{get:function(){return this._lightViewProjection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shadowTexture",{get:function(){return this._shadowTexture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterTexture",{get:function(){return this._filterTexture},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){this._shadowTexture.destroy(!0),this._filterTexture.destroy(!0)},t.prototype.clear=function(){this.renderer.renderTexture.bind(this._shadowTexture),this.renderer.renderTexture.clear([0,0,0,0],this.renderer.gl.COLOR_BUFFER_BIT|this.renderer.gl.DEPTH_BUFFER_BIT),this.renderer.renderTexture.bind(void 0)},t.prototype.updateLightViewProjection=function(){this.light.type===r.LightType.directional?u.ShadowMath.calculateDirectionalLightViewProjection(this):this.light.type===r.LightType.spot&&u.ShadowMath.calculateSpotLightViewProjection(this)},t.isMediumQualitySupported=function(t){return o.Platform.isHalfFloatFramebufferSupported(t)},t.isHighQualitySupported=function(t){return o.Platform.isFloatFramebufferSupported(t)},t}();e.ShadowCastingLight=s},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowTexture=void 0;var a=i(n(0)),u=n(27),s=n(7);!function(t){function e(t){return s.Platform.supportsFloatLinear(t)?a.SCALE_MODES.LINEAR:a.SCALE_MODES.NEAREST}t.create=function(t,n,r){var o=function(t,e){if(e===u.ShadowQuality.high){if(s.Platform.isFloatFramebufferSupported(t))return a.TYPES.FLOAT;if(s.Platform.isHalfFloatFramebufferSupported(t))return a.TYPES.HALF_FLOAT}if(e===u.ShadowQuality.medium&&s.Platform.isHalfFloatFramebufferSupported(t))return a.TYPES.HALF_FLOAT;return a.TYPES.UNSIGNED_BYTE}(t,r);return a.RenderTexture.create({width:n,height:n,type:o,scaleMode:e(t)})}}(e.ShadowTexture||(e.ShadowTexture={}))},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowMath=void 0;var a=i(n(0)),u=n(4),s=n(10),c=n(2),f=n(3),l=n(5);!function(t){var e=new Float32Array(16),n=new Float32Array(16),r=(new Float32Array([0,1,0]),new Float32Array(4)),o=new Float32Array(3),i=new Float32Array(3),d=new Float32Array(3),h=new Float32Array(3);t.calculateDirectionalLightViewProjection=function(t){if(t.light.type===s.LightType.directional){var a=t.shadowArea/2,p=2*a/t.shadowArea,_=u.Mat4.ortho(-a,a,-a,a,-a,a,e),m=t.light,v=t.camera||l.Camera.main;v&&t.followCamera?(c.Vec3.scale(v.worldTransform.forward,a,h),c.Vec3.add(v.worldTransform.position,h,d),c.Vec3.transformQuat(d,f.Quat.conjugate(t.light.worldTransform.rotation,r),o),o[0]=p*Math.floor(o[0]/p),o[1]=p*Math.floor(o[1]/p),c.Vec3.transformQuat(o,m.worldTransform.rotation,o),c.Vec3.add(o,m.worldTransform.forward,i),u.Mat4.lookAt(o,i,m.worldTransform.up,n),u.Mat4.multiply(_,n,t.lightViewProjection)):(c.Vec3.add(m.worldTransform.position,t.light.worldTransform.forward,d),u.Mat4.lookAt(m.worldTransform.position,d,m.worldTransform.up,n),u.Mat4.multiply(_,n,t.lightViewProjection))}},t.calculateSpotLightViewProjection=function(t){if(t.light.type===s.LightType.spot){var r=t.light;u.Mat4.perspective(r.outerConeAngle*a.DEG_TO_RAD*2,1,2,r.range,e),c.Vec3.add(r.worldTransform.position,r.worldTransform.forward,d),u.Mat4.lookAt(r.worldTransform.position,d,r.worldTransform.up,n),u.Mat4.multiply(e,n,t.lightViewProjection)}}}(e.ShadowMath||(e.ShadowMath={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;var r=n(2);var o=1e-6,i=function(){function t(t,e){this.distance=e,this._normal=new Float32Array(3),r.Vec3.normalize(t,this._normal)}return Object.defineProperty(t.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),t.prototype.rayCast=function(t){var e,n,i=r.Vec3.dot(t.direction,this.normal);return e=i,n=0,Math.abs(e-n)<=o*Math.max(1,Math.abs(e),Math.abs(n))?0:(-r.Vec3.dot(t.origin,this.normal)-this.distance)/i},t}();e.Plane=i}])}));